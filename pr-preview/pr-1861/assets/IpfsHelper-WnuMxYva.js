var Qw=Object.defineProperty;var la=j=>{throw TypeError(j)};var Zw=(j,I,q)=>I in j?Qw(j,I,{enumerable:!0,configurable:!0,writable:!0,value:q}):j[I]=q;var k=(j,I,q)=>Zw(j,typeof I!="symbol"?I+"":I,q),ha=(j,I,q)=>I.has(j)||la("Cannot "+q);var je=(j,I,q)=>(ha(j,I,"read from private field"),q?q.call(j):I.get(j)),_t=(j,I,q)=>I.has(j)?la("Cannot add the same private member more than once"):I instanceof WeakSet?I.add(j):I.set(j,q),zt=(j,I,q,Lt)=>(ha(j,I,"write to private field"),Lt?Lt.call(j,q):I.set(j,q),q);import{kj as w,kk as Kn,ji as Xn,kl as Yw,km as em,fy as xe,kn as ee,ko as fa,kp as te,kq as et,kr as tt,ks as tm,kt as Qn,ku as Zn,kv as rm,ed as ue,kw as nm,j3 as rt,g5 as sm,kx as om,ky as im,kz as am,kA as um,kB as cm,kC as lm,kD as hm,kE as fm,kF as Yn,kG as da,kH as dm,kI as pm,kJ as gm,fT as pa,eg as ga,__tla as ym}from"./index-DnYMDEqQ.js";import{r as br}from"./browser-Cr_ZWWON.js";let ya,Da,Dm=Promise.all([(()=>{try{return ym}catch{}})()]).then(async()=>{var ua,ca,dt,Re,Ut,Ot;function j(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(n,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const I=e=>Promise.reject(new Error(`No base found for "${e}"`));class q{constructor(t){this._basesByName={},this._basesByPrefix={},this._loadBase=t.loadBase||I;for(const r of t.bases)this.addBase(r)}addBase(t){if(this._basesByName[t.name]||this._basesByPrefix[t.prefix])throw new Error(`Codec already exists for codec "${t.name}"`);this._basesByName[t.name]=t,this._basesByPrefix[t.prefix]=t}removeBase(t){delete this._basesByName[t.name],delete this._basesByPrefix[t.prefix]}async getBase(t){if(this._basesByName[t])return this._basesByName[t];if(this._basesByPrefix[t])return this._basesByPrefix[t];const r=await this._loadBase(t);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}}const Lt=e=>Promise.reject(new Error(`No codec found for "${e}"`));class wa{constructor(t){this._codecsByName={},this._codecsByCode={},this._loadCodec=t.loadCodec||Lt;for(const r of t.codecs)this.addCodec(r)}addCodec(t){if(this._codecsByName[t.name]||this._codecsByCode[t.code])throw new Error(`Resolver already exists for codec "${t.name}"`);this._codecsByName[t.name]=t,this._codecsByCode[t.code]=t}removeCodec(t){delete this._codecsByName[t.name],delete this._codecsByCode[t.code]}async getCodec(t){const r=typeof t=="string"?this._codecsByName:this._codecsByCode;if(r[t])return r[t];const n=await this._loadCodec(t);return r[t]==null&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}}const ma=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class ba{constructor(t){this._hashersByName={},this._hashersByCode={},this._loadHasher=t.loadHasher||ma;for(const r of t.hashers)this.addHasher(r)}addHasher(t){if(this._hashersByName[t.name]||this._hashersByCode[t.code])throw new Error(`Resolver already exists for codec "${t.name}"`);this._hashersByName[t.name]=t,this._hashersByCode[t.code]=t}removeHasher(t){delete this._hashersByName[t.name],delete this._hashersByCode[t.code]}async getHasher(t){const r=typeof t=="string"?this._hashersByName:this._hashersByCode;if(r[t])return r[t];const n=await this._loadHasher(t);return r[t]==null&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}}const Ea=new TextDecoder;function Er(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const s=e[t++];if(r+=n<28?(s&127)<<n:(s&127)*2**n,s<128)break}return[r,t]}function Rt(e,t){let r;[r,t]=Er(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function es(e,t){let r;return[r,t]=Er(e,t),[r&7,r>>3,t]}function va(e){const t={},r=e.length;let n=0;for(;n<r;){let s,o;if([s,o,n]=es(e,n),o===1){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(s!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Hash`);if(t.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=Rt(e,n)}else if(o===2){if(t.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(s!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Name`);if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,n]=Rt(e,n),t.Name=Ea.decode(i)}else if(o===3){if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(s!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Tsize`);[t.Tsize,n]=Er(e,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function Ca(e){const t=e.length;let r=0,n,s=!1,o;for(;r<t;){let a,u;if([a,u,r]=es(e,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(u===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,r]=Rt(e,r),n&&(s=!0)}else if(u===2){if(s)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let f;[f,r]=Rt(e,r),n.push(va(f))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${u}`)}if(r>t)throw new Error("protobuf: (PBNode) unexpected end of data");const i={};return o&&(i.Data=o),i.Links=n||[],i}const ts=new TextEncoder,rs=2**32,Aa=2**31;function Sa(e,t){let r=t.length;if(typeof e.Tsize=="number"){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=gt(t,r,e.Tsize)-1,t[r]=24}if(typeof e.Name=="string"){const n=ts.encode(e.Name);r-=n.length,t.set(n,r),r=gt(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=gt(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function xa(e){const t=ka(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=gt(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let s=e.Links.length-1;s>=0;s--){const o=Sa(e.Links[s],r.subarray(0,n));n-=o,n=gt(r,n,o)-1,r[n]=18}return r}function Pa(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+nt(r)}if(typeof e.Name=="string"){const r=ts.encode(e.Name).length;t+=1+r+nt(r)}return typeof e.Tsize=="number"&&(t+=1+nt(e.Tsize)),t}function ka(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+nt(r)}if(e.Links)for(const r of e.Links){const n=Pa(r);t+=1+n+nt(n)}return t}function gt(e,t,r){t-=nt(r);const n=t;for(;r>=Aa;)e[t++]=r&127|128,r/=128;for(;r>=128;)e[t++]=r&127|128,r>>>=7;return e[t]=r,n}function nt(e){return e%2===0&&e++,Math.floor((Ta(e)+6)/7)}function Ta(e){let t=0;return e>=rs&&(e=Math.floor(e/rs),t=32),e>=65536&&(e>>>=16,t+=16),e>=256&&(e>>>=8,t+=8),t+ja[e]}const ja=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],Ba=["Data","Links"],$a=["Hash","Name","Tsize"],vr=new TextEncoder;function ns(e,t){if(e===t)return 0;const r=e.Name?vr.encode(e.Name):[],n=t.Name?vr.encode(t.Name):[];let s=r.length,o=n.length;for(let i=0,a=Math.min(s,o);i<a;++i)if(r[i]!==n[i]){s=r[i],o=n[i];break}return s<o?-1:o<s?1:0}function ss(e,t){return!Object.keys(e).some(r=>!t.includes(r))}function os(e){if(typeof e.asCID=="object"){const r=w.asCID(e);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let r=w.asCID(e.Hash);try{r||(typeof e.Hash=="string"?r=w.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=w.decode(e.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return typeof e.Name=="string"&&(t.Name=e.Name),typeof e.Tsize=="number"&&(t.Tsize=e.Tsize),t}function is(e){if((e instanceof Uint8Array||typeof e=="string")&&(e={Data:e}),typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Data!==void 0)if(typeof e.Data=="string")t.Data=vr.encode(e.Data);else if(e.Data instanceof Uint8Array)t.Data=e.Data;else throw new TypeError("Invalid DAG-PB form");if(e.Links!==void 0)if(Array.isArray(e.Links))t.Links=e.Links.map(os),t.Links.sort(ns);else throw new TypeError("Invalid DAG-PB form");else t.Links=[];return t}function as(e){if(!e||typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");if(!ss(e,Ba))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(e.Data!==void 0&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!ss(r,$a))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0&&(typeof r.Tsize!="number"||r.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t>0&&ns(r,e.Links[t-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function Na(e,t=[]){return is({Data:e,Links:t})}function Ia(e,t,r){return os({Hash:r,Name:e,Tsize:t})}const Ua="dag-pb",Oa=112;function _a(e){as(e);const t={};return e.Links&&(t.Links=e.Links.map(r=>{const n={};return r.Hash&&(n.Hash=r.Hash.bytes),r.Name!==void 0&&(n.Name=r.Name),r.Tsize!==void 0&&(n.Tsize=r.Tsize),n})),e.Data&&(t.Data=e.Data),xa(t)}function za(e){const t=Ca(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map(n=>{const s={};try{s.Hash=w.decode(n.Hash)}catch{}if(!s.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(s.Name=n.Name),n.Tsize!==void 0&&(s.Tsize=n.Tsize),s})),r}const La=Object.freeze(Object.defineProperty({__proto__:null,code:Oa,createLink:Ia,createNode:Na,decode:za,encode:_a,name:Ua,prepare:is,validate:as},Symbol.toStringTag,{value:"Module"})),Ra=["string","number","bigint","symbol"],Ma=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Fa(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const t=typeof e;return Ra.includes(t)?t:t==="function"?"Function":Array.isArray(e)?"Array":Ha(e)?"Buffer":Va(e)||"Object"}function Ha(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Va(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(Ma.includes(t))return t}class c{constructor(t,r,n){this.major=t,this.majorEncoded=t<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}c.uint=new c(0,"uint",!0),c.negint=new c(1,"negint",!0),c.bytes=new c(2,"bytes",!0),c.string=new c(3,"string",!0),c.array=new c(4,"array",!1),c.map=new c(5,"map",!1),c.tag=new c(6,"tag",!1),c.float=new c(7,"float",!0),c.false=new c(7,"false",!0),c.true=new c(7,"true",!0),c.null=new c(7,"null",!0),c.undefined=new c(7,"undefined",!0),c.break=new c(7,"break",!0);class d{constructor(t,r,n){this.type=t,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const st=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",qa=new TextDecoder,Wa=new TextEncoder;function Mt(e){return st&&globalThis.Buffer.isBuffer(e)}function Cr(e){return e instanceof Uint8Array?Mt(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const Ga=st?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):ls(e,t,r):(e,t,r)=>r-t>64?qa.decode(e.subarray(t,r)):ls(e,t,r),us=st?e=>e.length>64?globalThis.Buffer.from(e):cs(e):e=>e.length>64?Wa.encode(e):cs(e),Pe=e=>Uint8Array.from(e),Ar=st?(e,t,r)=>Mt(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),Ja=st?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Cr(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let s of e)n+s.length>r.length&&(s=s.subarray(0,r.length-n)),r.set(s,n),n+=s.length;return r},Ka=st?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Xa(e,t){if(Mt(e)&&Mt(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function cs(e,t=1/0){let r;const n=e.length;let s=null;const o=[];for(let i=0;i<n;++i){if(r=e.charCodeAt(i),r>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}else if(i+1===n){(t-=3)>-1&&o.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),s=r;continue}r=(s-55296<<10|r-56320)+65536}else s&&(t-=3)>-1&&o.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function ls(e,t,r){const n=[];for(;t<r;){const s=e[t];let o=null,i=s>239?4:s>223?3:s>191?2:1;if(t+i<=r){let a,u,f,p;switch(i){case 1:s<128&&(o=s);break;case 2:a=e[t+1],(a&192)===128&&(p=(s&31)<<6|a&63,p>127&&(o=p));break;case 3:a=e[t+1],u=e[t+2],(a&192)===128&&(u&192)===128&&(p=(s&15)<<12|(a&63)<<6|u&63,p>2047&&(p<55296||p>57343)&&(o=p));break;case 4:a=e[t+1],u=e[t+2],f=e[t+3],(a&192)===128&&(u&192)===128&&(f&192)===128&&(p=(s&15)<<18|(a&63)<<12|(u&63)<<6|f&63,p>65535&&p<1114112&&(o=p))}}o===null?(o=65533,i=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),t+=i}return fs(n)}const hs=4096;function fs(e){const t=e.length;if(t<=hs)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=hs));return r}const Qa=256;class ds{constructor(t=Qa){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let r=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const n=r.length-(this.maxCursor-this.cursor)-1;r.set(t,n)}else{if(r){const n=r.length-(this.maxCursor-this.cursor)-1;n<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,n),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(r=Ka(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let r;if(this.chunks.length===1){const n=this.chunks[0];t&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=Ar(n,0,this.cursor)}else r=Ja(this.chunks,this.cursor);return t&&this.reset(),r}}const m="CBOR decode error:",Me="CBOR encode error:";function ot(e,t,r){if(e.length-t<r)throw new Error(`${m} not enough data for type`)}const W=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Fe(e,t,r){ot(e,t,1);const n=e[t];if(r.strict===!0&&n<W[0])throw new Error(`${m} integer encoded in more bytes than necessary (strict decode)`);return n}function He(e,t,r){ot(e,t,2);const n=e[t]<<8|e[t+1];if(r.strict===!0&&n<W[1])throw new Error(`${m} integer encoded in more bytes than necessary (strict decode)`);return n}function Ve(e,t,r){ot(e,t,4);const n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<W[2])throw new Error(`${m} integer encoded in more bytes than necessary (strict decode)`);return n}function qe(e,t,r){ot(e,t,8);const n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],s=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(n)<<BigInt(32))+BigInt(s);if(r.strict===!0&&o<W[3])throw new Error(`${m} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(r.allowBigInt===!0)return o;throw new Error(`${m} integers outside of the safe integer range are not supported`)}function Za(e,t,r,n){return new d(c.uint,Fe(e,t+1,n),2)}function Ya(e,t,r,n){return new d(c.uint,He(e,t+1,n),3)}function eu(e,t,r,n){return new d(c.uint,Ve(e,t+1,n),5)}function tu(e,t,r,n){return new d(c.uint,qe(e,t+1,n),9)}function We(e,t){return ce(e,0,t.value)}function ce(e,t,r){if(r<W[0]){const n=Number(r);e.push([t|n])}else if(r<W[1]){const n=Number(r);e.push([t|24,n])}else if(r<W[2]){const n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<W[3]){const n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{const n=BigInt(r);if(n<W[4]){const s=[t|27,0,0,0,0,0,0,0];let o=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));s[8]=o&255,o=o>>8,s[7]=o&255,o=o>>8,s[6]=o&255,o=o>>8,s[5]=o&255,s[4]=i&255,i=i>>8,s[3]=i&255,i=i>>8,s[2]=i&255,i=i>>8,s[1]=i&255,e.push(s)}else throw new Error(`${m} encountered BigInt larger than allowable range`)}}We.encodedSize=function(e){return ce.encodedSize(e.value)},ce.encodedSize=function(e){return e<W[0]?1:e<W[1]?2:e<W[2]?3:e<W[3]?5:9},We.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function ru(e,t,r,n){return new d(c.negint,-1-Fe(e,t+1,n),2)}function nu(e,t,r,n){return new d(c.negint,-1-He(e,t+1,n),3)}function su(e,t,r,n){return new d(c.negint,-1-Ve(e,t+1,n),5)}const Sr=BigInt(-1),ps=BigInt(1);function ou(e,t,r,n){const s=qe(e,t+1,n);if(typeof s!="bigint"){const o=-1-s;if(o>=Number.MIN_SAFE_INTEGER)return new d(c.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${m} integers outside of the safe integer range are not supported`);return new d(c.negint,Sr-BigInt(s),9)}function xr(e,t){const r=t.value,n=typeof r=="bigint"?r*Sr-ps:r*-1-1;ce(e,t.type.majorEncoded,n)}xr.encodedSize=function(e){const t=e.value,r=typeof t=="bigint"?t*Sr-ps:t*-1-1;return r<W[0]?1:r<W[1]?2:r<W[2]?3:r<W[3]?5:9},xr.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function yt(e,t,r,n){ot(e,t,r+n);const s=Ar(e,t+r,t+r+n);return new d(c.bytes,s,r+n)}function iu(e,t,r,n){return yt(e,t,1,r)}function au(e,t,r,n){return yt(e,t,2,Fe(e,t+1,n))}function uu(e,t,r,n){return yt(e,t,3,He(e,t+1,n))}function cu(e,t,r,n){return yt(e,t,5,Ve(e,t+1,n))}function lu(e,t,r,n){const s=qe(e,t+1,n);if(typeof s=="bigint")throw new Error(`${m} 64-bit integer bytes lengths not supported`);return yt(e,t,9,s)}function Ft(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===c.string?us(e.value):e.value),e.encodedBytes}function Ht(e,t){const r=Ft(t);ce(e,t.type.majorEncoded,r.length),e.push(r)}Ht.encodedSize=function(e){const t=Ft(e);return ce.encodedSize(t.length)+t.length},Ht.compareTokens=function(e,t){return hu(Ft(e),Ft(t))};function hu(e,t){return e.length<t.length?-1:e.length>t.length?1:Xa(e,t)}function Dt(e,t,r,n,s){const o=r+n;ot(e,t,o);const i=new d(c.string,Ga(e,t+r,t+o),o);return s.retainStringBytes===!0&&(i.byteValue=Ar(e,t+r,t+o)),i}function fu(e,t,r,n){return Dt(e,t,1,r,n)}function du(e,t,r,n){return Dt(e,t,2,Fe(e,t+1,n),n)}function pu(e,t,r,n){return Dt(e,t,3,He(e,t+1,n),n)}function gu(e,t,r,n){return Dt(e,t,5,Ve(e,t+1,n),n)}function yu(e,t,r,n){const s=qe(e,t+1,n);if(typeof s=="bigint")throw new Error(`${m} 64-bit integer string lengths not supported`);return Dt(e,t,9,s,n)}const Du=Ht;function it(e,t,r,n){return new d(c.array,n,r)}function wu(e,t,r,n){return it(e,t,1,r)}function mu(e,t,r,n){return it(e,t,2,Fe(e,t+1,n))}function bu(e,t,r,n){return it(e,t,3,He(e,t+1,n))}function Eu(e,t,r,n){return it(e,t,5,Ve(e,t+1,n))}function vu(e,t,r,n){const s=qe(e,t+1,n);if(typeof s=="bigint")throw new Error(`${m} 64-bit integer array lengths not supported`);return it(e,t,9,s)}function Cu(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${m} indefinite length items not allowed`);return it(e,t,1,1/0)}function Pr(e,t){ce(e,c.array.majorEncoded,t.value)}Pr.compareTokens=We.compareTokens,Pr.encodedSize=function(e){return ce.encodedSize(e.value)};function at(e,t,r,n){return new d(c.map,n,r)}function Au(e,t,r,n){return at(e,t,1,r)}function Su(e,t,r,n){return at(e,t,2,Fe(e,t+1,n))}function xu(e,t,r,n){return at(e,t,3,He(e,t+1,n))}function Pu(e,t,r,n){return at(e,t,5,Ve(e,t+1,n))}function ku(e,t,r,n){const s=qe(e,t+1,n);if(typeof s=="bigint")throw new Error(`${m} 64-bit integer map lengths not supported`);return at(e,t,9,s)}function Tu(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${m} indefinite length items not allowed`);return at(e,t,1,1/0)}function kr(e,t){ce(e,c.map.majorEncoded,t.value)}kr.compareTokens=We.compareTokens,kr.encodedSize=function(e){return ce.encodedSize(e.value)};function ju(e,t,r,n){return new d(c.tag,r,1)}function Bu(e,t,r,n){return new d(c.tag,Fe(e,t+1,n),2)}function $u(e,t,r,n){return new d(c.tag,He(e,t+1,n),3)}function Nu(e,t,r,n){return new d(c.tag,Ve(e,t+1,n),5)}function Iu(e,t,r,n){return new d(c.tag,qe(e,t+1,n),9)}function Tr(e,t){ce(e,c.tag.majorEncoded,t.value)}Tr.compareTokens=We.compareTokens,Tr.encodedSize=function(e){return ce.encodedSize(e.value)};const Uu=20,Ou=21,_u=22,zu=23;function Lu(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${m} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new d(c.null,null,1):new d(c.undefined,void 0,1)}function Ru(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${m} indefinite length items not allowed`);return new d(c.break,void 0,1)}function jr(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${m} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${m} Infinity values are not supported`)}return new d(c.float,e,t)}function Mu(e,t,r,n){return jr($r(e,t+1),3,n)}function Fu(e,t,r,n){return jr(Nr(e,t+1),5,n)}function Hu(e,t,r,n){return jr(ws(e,t+1),9,n)}function Br(e,t,r){const n=t.value;if(n===!1)e.push([c.float.majorEncoded|Uu]);else if(n===!0)e.push([c.float.majorEncoded|Ou]);else if(n===null)e.push([c.float.majorEncoded|_u]);else if(n===void 0)e.push([c.float.majorEncoded|zu]);else{let s,o=!1;(!r||r.float64!==!0)&&(ys(n),s=$r(de,1),n===s||Number.isNaN(n)?(de[0]=249,e.push(de.slice(0,3)),o=!0):(Ds(n),s=Nr(de,1),n===s&&(de[0]=250,e.push(de.slice(0,5)),o=!0))),o||(Vu(n),s=ws(de,1),de[0]=251,e.push(de.slice(0,9)))}}Br.encodedSize=function(e,t){const r=e.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!t||t.float64!==!0){ys(r);let n=$r(de,1);if(r===n||Number.isNaN(r))return 3;if(Ds(r),n=Nr(de,1),r===n)return 5}return 9};const gs=new ArrayBuffer(9),le=new DataView(gs,1),de=new Uint8Array(gs,0);function ys(e){if(e===1/0)le.setUint16(0,31744,!1);else if(e===-1/0)le.setUint16(0,64512,!1);else if(Number.isNaN(e))le.setUint16(0,32256,!1);else{le.setFloat32(0,e);const t=le.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)le.setUint16(0,31744,!1);else if(r===0)le.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{const s=r-127;s<-24?le.setUint16(0,0):s<-14?le.setUint16(0,(t&2147483648)>>16|1<<24+s,!1):le.setUint16(0,(t&2147483648)>>16|s+15<<10|n>>13,!1)}}}function $r(e,t){if(e.length-t<2)throw new Error(`${m} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;const n=r>>10&31,s=r&1023;let o;return n===0?o=s*2**-24:n!==31?o=(s+1024)*2**(n-25):o=s===0?1/0:NaN,r&32768?-o:o}function Ds(e){le.setFloat32(0,e,!1)}function Nr(e,t){if(e.length-t<4)throw new Error(`${m} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function Vu(e){le.setFloat64(0,e,!1)}function ws(e,t){if(e.length-t<8)throw new Error(`${m} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}Br.compareTokens=We.compareTokens;function S(e,t,r){throw new Error(`${m} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function Vt(e){return()=>{throw new Error(`${m} ${e}`)}}const g=[];for(let e=0;e<=23;e++)g[e]=S;g[24]=Za,g[25]=Ya,g[26]=eu,g[27]=tu,g[28]=S,g[29]=S,g[30]=S,g[31]=S;for(let e=32;e<=55;e++)g[e]=S;g[56]=ru,g[57]=nu,g[58]=su,g[59]=ou,g[60]=S,g[61]=S,g[62]=S,g[63]=S;for(let e=64;e<=87;e++)g[e]=iu;g[88]=au,g[89]=uu,g[90]=cu,g[91]=lu,g[92]=S,g[93]=S,g[94]=S,g[95]=Vt("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)g[e]=fu;g[120]=du,g[121]=pu,g[122]=gu,g[123]=yu,g[124]=S,g[125]=S,g[126]=S,g[127]=Vt("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)g[e]=wu;g[152]=mu,g[153]=bu,g[154]=Eu,g[155]=vu,g[156]=S,g[157]=S,g[158]=S,g[159]=Cu;for(let e=160;e<=183;e++)g[e]=Au;g[184]=Su,g[185]=xu,g[186]=Pu,g[187]=ku,g[188]=S,g[189]=S,g[190]=S,g[191]=Tu;for(let e=192;e<=215;e++)g[e]=ju;g[216]=Bu,g[217]=$u,g[218]=Nu,g[219]=Iu,g[220]=S,g[221]=S,g[222]=S,g[223]=S;for(let e=224;e<=243;e++)g[e]=Vt("simple values are not supported");g[244]=S,g[245]=S,g[246]=S,g[247]=Lu,g[248]=Vt("simple values are not supported"),g[249]=Mu,g[250]=Fu,g[251]=Hu,g[252]=S,g[253]=S,g[254]=S,g[255]=Ru;const be=[];for(let e=0;e<24;e++)be[e]=new d(c.uint,e,1);for(let e=-1;e>=-24;e--)be[31-e]=new d(c.negint,e,1);be[64]=new d(c.bytes,new Uint8Array(0),1),be[96]=new d(c.string,"",1),be[128]=new d(c.array,0,1),be[160]=new d(c.map,0,1),be[244]=new d(c.false,!1,1),be[245]=new d(c.true,!0,1),be[246]=new d(c.null,null,1);function qu(e){switch(e.type){case c.false:return Pe([244]);case c.true:return Pe([245]);case c.null:return Pe([246]);case c.bytes:return e.value.length?void 0:Pe([64]);case c.string:return e.value===""?Pe([96]):void 0;case c.array:return e.value===0?Pe([128]):void 0;case c.map:return e.value===0?Pe([160]):void 0;case c.uint:return e.value<24?Pe([Number(e.value)]):void 0;case c.negint:if(e.value>=-24)return Pe([31-Number(e.value)])}}const Wu={float64:!1,mapSorter:Ku,quickEncodeToken:qu};function Gu(){const e=[];return e[c.uint.major]=We,e[c.negint.major]=xr,e[c.bytes.major]=Ht,e[c.string.major]=Du,e[c.array.major]=Pr,e[c.map.major]=kr,e[c.tag.major]=Tr,e[c.float.major]=Br,e}const ms=Gu(),Ir=new ds;class qt{constructor(t,r){this.obj=t,this.parent=r}includes(t){let r=this;do if(r.obj===t)return!0;while(r=r.parent);return!1}static createCheck(t,r){if(t&&t.includes(r))throw new Error(`${Me} object contains circular references`);return new qt(r,t)}}const $e={null:new d(c.null,null),undefined:new d(c.undefined,void 0),true:new d(c.true,!0),false:new d(c.false,!1),emptyArray:new d(c.array,0),emptyMap:new d(c.map,0)},Ne={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new d(c.float,e):e>=0?new d(c.uint,e):new d(c.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new d(c.uint,e):new d(c.negint,e)},Uint8Array(e,t,r,n){return new d(c.bytes,e)},string(e,t,r,n){return new d(c.string,e)},boolean(e,t,r,n){return e?$e.true:$e.false},null(e,t,r,n){return $e.null},undefined(e,t,r,n){return $e.undefined},ArrayBuffer(e,t,r,n){return new d(c.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new d(c.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[$e.emptyArray,new d(c.break)]:$e.emptyArray;n=qt.createCheck(n,e);const s=[];let o=0;for(const i of e)s[o++]=Wt(i,r,n);return r.addBreakTokens?[new d(c.array,e.length),s,new d(c.break)]:[new d(c.array,e.length),s]},Object(e,t,r,n){const s=t!=="Object",o=s?e.keys():Object.keys(e),i=s?e.size:o.length;if(!i)return r.addBreakTokens===!0?[$e.emptyMap,new d(c.break)]:$e.emptyMap;n=qt.createCheck(n,e);const a=[];let u=0;for(const f of o)a[u++]=[Wt(f,r,n),Wt(s?e.get(f):e[f],r,n)];return Ju(a,r),r.addBreakTokens?[new d(c.map,i),a,new d(c.break)]:[new d(c.map,i),a]}};Ne.Map=Ne.Object,Ne.Buffer=Ne.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ne[`${e}Array`]=Ne.DataView;function Wt(e,t={},r){const n=Fa(e),s=t&&t.typeEncoders&&t.typeEncoders[n]||Ne[n];if(typeof s=="function"){const i=s(e,n,t,r);if(i!=null)return i}const o=Ne[n];if(!o)throw new Error(`${Me} unsupported type: ${n}`);return o(e,n,t,r)}function Ju(e,t){t.mapSorter&&e.sort(t.mapSorter)}function Ku(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const s=r.type.major,o=ms[s].compareTokens(r,n);return o===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function bs(e,t,r,n){if(Array.isArray(t))for(const s of t)bs(e,s,r,n);else r[t.type.major](e,t,n)}function Es(e,t,r){const n=Wt(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const s=r.quickEncodeToken(n);if(s)return s;const o=t[n.type.major];if(o.encodedSize){const i=o.encodedSize(n,r),a=new ds(i);if(o(a,n,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Cr(a.chunks[0])}}return Ir.reset(),bs(Ir,n,t,r),Ir.toBytes(!0)}function vs(e,t){return t=Object.assign({},Wu,t),Es(e,ms,t)}const Xu={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Qu{constructor(t,r={}){this.pos=0,this.data=t,this.options=r}done(){return this.pos>=this.data.length}next(){const t=this.data[this.pos];let r=be[t];if(r===void 0){const n=g[t];if(!n)throw new Error(`${m} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const s=t&31;r=n(this.data,this.pos,s,this.options)}return this.pos+=r.encodedLength,r}}const wt=Symbol.for("DONE"),Gt=Symbol.for("BREAK");function Zu(e,t,r){const n=[];for(let s=0;s<e.value;s++){const o=mt(t,r);if(o===Gt){if(e.value===1/0)break;throw new Error(`${m} got unexpected break to lengthed array`)}if(o===wt)throw new Error(`${m} found array but not enough entries (got ${s}, expected ${e.value})`);n[s]=o}return n}function Yu(e,t,r){const n=r.useMaps===!0,s=n?void 0:{},o=n?new Map:void 0;for(let i=0;i<e.value;i++){const a=mt(t,r);if(a===Gt){if(e.value===1/0)break;throw new Error(`${m} got unexpected break to lengthed map`)}if(a===wt)throw new Error(`${m} found map but not enough entries (got ${i} [no key], expected ${e.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${m} non-string keys not supported (got ${typeof a})`);if(r.rejectDuplicateMapKeys===!0&&(n&&o.has(a)||!n&&a in s))throw new Error(`${m} found repeat map key "${a}"`);const u=mt(t,r);if(u===wt)throw new Error(`${m} found map but not enough entries (got ${i} [no value], expected ${e.value})`);n?o.set(a,u):s[a]=u}return n?o:s}function mt(e,t){if(e.done())return wt;const r=e.next();if(r.type===c.break)return Gt;if(r.type.terminal)return r.value;if(r.type===c.array)return Zu(r,e,t);if(r.type===c.map)return Yu(r,e,t);if(r.type===c.tag){if(t.tags&&typeof t.tags[r.value]=="function"){const n=mt(e,t);return t.tags[r.value](n)}throw new Error(`${m} tag not supported (${r.value})`)}throw new Error("unsupported")}function Ur(e,t){if(!(e instanceof Uint8Array))throw new Error(`${m} data to decode must be a Uint8Array`);t=Object.assign({},Xu,t);const r=t.tokenizer||new Qu(e,t),n=mt(r,t);if(n===wt)throw new Error(`${m} did not find any content to decode`);if(n===Gt)throw new Error(`${m} got unexpected break`);if(!r.done())throw new Error(`${m} too many terminals, data makes no sense`);return n}const Cs=42;function ec(e){if(e.asCID!==e)return null;const t=w.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new d(c.tag,Cs),new d(c.bytes,r)]}function tc(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function rc(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const nc={float64:!0,typeEncoders:{Object:ec,undefined:tc,number:rc}};function sc(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return w.decode(e.subarray(1))}const As={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};As.tags[Cs]=sc;const oc="dag-cbor",ic=113,ac=e=>vs(e,nc),uc=e=>Ur(e,As),cc=Object.freeze(Object.defineProperty({__proto__:null,code:ic,decode:uc,encode:ac,name:oc},Symbol.toStringTag,{value:"Module"}));class lc extends Array{constructor(){super(),this.inRecursive=[]}prefix(t){const r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===c.array&&(r.elements++,r.elements!==1&&t.push([44])),r.type===c.map&&(r.elements++,r.elements!==1&&(r.elements%2===1?t.push([44]):t.push([58]))))}[c.uint.major](t,r){this.prefix(t);const n=String(r.value),s=[];for(let o=0;o<n.length;o++)s[o]=n.charCodeAt(o);t.push(s)}[c.negint.major](t,r){this[c.uint.major](t,r)}[c.bytes.major](t,r){throw new Error(`${Me} unsupported type: Uint8Array`)}[c.string.major](t,r){this.prefix(t);const n=us(JSON.stringify(r.value));t.push(n.length>32?Cr(n):n)}[c.array.major](t,r){this.prefix(t),this.inRecursive.push({type:c.array,elements:0}),t.push([91])}[c.map.major](t,r){this.prefix(t),this.inRecursive.push({type:c.map,elements:0}),t.push([123])}[c.tag.major](t,r){}[c.float.major](t,r){if(r.type.name==="break"){const i=this.inRecursive.pop();if(i){if(i.type===c.array)t.push([93]);else if(i.type===c.map)t.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(r.value===void 0)throw new Error(`${Me} unsupported type: undefined`);if(this.prefix(t),r.type.name==="true"){t.push([116,114,117,101]);return}else if(r.type.name==="false"){t.push([102,97,108,115,101]);return}else if(r.type.name==="null"){t.push([110,117,108,108]);return}const n=String(r.value),s=[];let o=!1;for(let i=0;i<n.length;i++)s[i]=n.charCodeAt(i),!o&&(s[i]===46||s[i]===101||s[i]===69)&&(o=!0);o||(s.push(46),s.push(48)),t.push(s)}}function hc(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${Me} complex map keys are not supported`);const r=e[0],n=t[0];if(r.type!==c.string||n.type!==c.string)throw new Error(`${Me} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${Me} unexpected duplicate map keys, this is not supported`)}const fc={addBreakTokens:!0,mapSorter:hc};function dc(e,t){return t=Object.assign({},fc,t),Es(e,new lc,t)}class Ss{constructor(t,r={}){this.pos=0,this.data=t,this.options=r,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let t=this.ch();for(;t===32||t===9||t===13||t===10;)t=this.data[++this.pos]}expect(t){if(this.data.length-this.pos<t.length)throw new Error(`${m} unexpected end of input at position ${this.pos}`);for(let r=0;r<t.length;r++)if(this.data[this.pos++]!==t[r])throw new Error(`${m} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...t)}'`)}parseNumber(){const t=this.pos;let r=!1,n=!1;const s=a=>{for(;!this.done();){const u=this.ch();if(a.includes(u))this.pos++;else break}};if(this.ch()===45&&(r=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,n=!0;else return new d(c.uint,0,this.pos-t);if(s([48,49,50,51,52,53,54,55,56,57]),r&&this.pos===t+1)throw new Error(`${m} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${m} unexpected token at position ${this.pos}`);n=!0,this.pos++,s([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,s([48,49,50,51,52,53,54,55,56,57]));const o=String.fromCharCode.apply(null,this.data.subarray(t,this.pos)),i=parseFloat(o);return n?new d(c.float,i,this.pos-t):this.options.allowBigInt!==!0||Number.isSafeInteger(i)?new d(i>=0?c.uint:c.negint,i,this.pos-t):new d(i>=0?c.uint:c.negint,BigInt(o),this.pos-t)}parseString(){if(this.ch()!==34)throw new Error(`${m} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let o=this.pos,i=0;o<this.data.length&&i<65536;o++,i++){const a=this.data[o];if(a===92||a<32||a>=128)break;if(a===34){const u=String.fromCharCode.apply(null,this.data.subarray(this.pos,o));return this.pos=o+1,new d(c.string,u,i)}}const t=this.pos,r=[],n=()=>{if(this.pos+4>=this.data.length)throw new Error(`${m} unexpected end of unicode escape sequence at position ${this.pos}`);let o=0;for(let i=0;i<4;i++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${m} unexpected unicode escape character at position ${this.pos}`);o=o*16+a,this.pos++}return o},s=()=>{const o=this.ch();let i=null,a=o>239?4:o>223?3:o>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${m} unexpected unicode sequence at position ${this.pos}`);let u,f,p,y;switch(a){case 1:o<128&&(i=o);break;case 2:u=this.data[this.pos+1],(u&192)===128&&(y=(o&31)<<6|u&63,y>127&&(i=y));break;case 3:u=this.data[this.pos+1],f=this.data[this.pos+2],(u&192)===128&&(f&192)===128&&(y=(o&15)<<12|(u&63)<<6|f&63,y>2047&&(y<55296||y>57343)&&(i=y));break;case 4:u=this.data[this.pos+1],f=this.data[this.pos+2],p=this.data[this.pos+3],(u&192)===128&&(f&192)===128&&(p&192)===128&&(y=(o&15)<<18|(u&63)<<12|(f&63)<<6|p&63,y>65535&&y<1114112&&(i=y))}i===null?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|i&1023),r.push(i),this.pos+=a};for(;!this.done();){const o=this.ch();let i;switch(o){case 92:if(this.pos++,this.done())throw new Error(`${m} unexpected string termination at position ${this.pos}`);switch(i=this.ch(),this.pos++,i){case 34:case 39:case 92:case 47:r.push(i);break;case 98:r.push(8);break;case 116:r.push(9);break;case 110:r.push(10);break;case 102:r.push(12);break;case 114:r.push(13);break;case 117:r.push(n());break;default:throw new Error(`${m} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new d(c.string,fs(r),this.pos-t);default:if(o<32)throw new Error(`${m} invalid control character at position ${this.pos}`);o<128?(r.push(o),this.pos++):s()}}throw new Error(`${m} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new d(c.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new d(c.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new d(c.null,null,4);case 102:return this.expect([102,97,108,115,101]),new d(c.false,!1,5);case 116:return this.expect([116,114,117,101]),new d(c.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${m} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new d(c.break,void 0,1);if(this.ch()!==44)throw new Error(`${m} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new d(c.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new d(c.break,void 0,1);if(this.ch()!==44)throw new Error(`${m} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new d(c.break,void 0,1);const t=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${m} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),t}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${m} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function pc(e,t){return t=Object.assign({tokenizer:new Ss(e,t)},t),Ur(e,t)}function gc(e){if(e.asCID!==e)return null;const t=w.asCID(e);if(!t)return null;const r=t.toString();return[new d(c.map,1/0,1),new d(c.string,"/",1),new d(c.string,r,r.length),new d(c.break,void 0,1)]}function xs(e){const t=Kn.encode(e).slice(1);return[new d(c.map,1/0,1),new d(c.string,"/",1),new d(c.map,1/0,1),new d(c.string,"bytes",5),new d(c.string,t,t.length),new d(c.break,void 0,1),new d(c.break,void 0,1)]}function yc(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Dc(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const wc={typeEncoders:{Object:gc,Uint8Array:xs,Buffer:xs,undefined:yc,number:Dc}};class mc extends Ss{constructor(t,r){super(t,r),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const t=this._next();if(t.type===c.map){const r=this._next();if(r.type===c.string&&r.value==="/"){const n=this._next();if(n.type===c.string){if(this._next().type!==c.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new d(c.tag,42,0)}if(n.type===c.map){const s=this._next();if(s.type===c.string&&s.value==="bytes"){const o=this._next();if(o.type===c.string){for(let a=0;a<2;a++)if(this._next().type!==c.break)throw new Error("Invalid encoded Bytes form");const i=Kn.decode(`m${o.value}`);return new d(c.bytes,i,o.value.length)}this.tokenBuffer.push(o)}this.tokenBuffer.push(s)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}return t}}const Or={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};Or.tags[42]=w.parse;const bc="dag-json",Ec=297,vc=e=>dc(e,wc),Cc=e=>{const t=Object.assign(Or,{tokenizer:new mc(e,Or)});return pc(e,t)},Ac=Object.freeze(Object.defineProperty({__proto__:null,code:Ec,decode:Cc,encode:vc,name:bc},Symbol.toStringTag,{value:"Module"}));var oe={},_r={},Ge={};const Sc=Xn(Yw);Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.fromBase64url=Ge.toBase64url=void 0;const Ps=Sc;function xc(e){return Ps.base64url.encode(e).slice(1)}Ge.toBase64url=xc;function Pc(e){return Ps.base64url.decode(`u${e}`)}Ge.fromBase64url=Pc;const kc=Xn(em);Object.defineProperty(_r,"__esModule",{value:!0});const Je=Ge,zr=kc;function Tc(e){const[t,r,n]=e;return{payload:r,signatures:[{protected:t,signature:n}],link:zr.CID.decode(Je.fromBase64url(r))}}function jc(e){const t={signature:Je.fromBase64url(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=Je.fromBase64url(e.protected)),t}function Bc(e){const t=Je.fromBase64url(e.payload);try{zr.CID.decode(t)}catch{throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(jc)}}function $c(e){const t={signature:Je.toBase64url(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=Je.toBase64url(e.protected)),t}function Nc(e){const t={payload:Je.toBase64url(e.payload),signatures:e.signatures.map($c)};return t.link=zr.CID.decode(new Uint8Array(e.payload)),t}_r.default={fromSplit:Tc,encode:Bc,decode:Nc};var Lr={};Object.defineProperty(Lr,"__esModule",{value:!0});const he=Ge;function Ic(e){const[t,r,n,s,o]=e,i={ciphertext:s,iv:n,protected:t,tag:o};return r&&(i.recipients=[{encrypted_key:r}]),i}function Uc(e){const t={};return e.encrypted_key&&(t.encrypted_key=he.fromBase64url(e.encrypted_key)),e.header&&(t.header=e.header),t}function Oc(e){const t={ciphertext:he.fromBase64url(e.ciphertext),protected:he.fromBase64url(e.protected),iv:he.fromBase64url(e.iv),tag:he.fromBase64url(e.tag)};return e.aad&&(t.aad=he.fromBase64url(e.aad)),e.recipients&&(t.recipients=e.recipients.map(Uc)),e.unprotected&&(t.unprotected=e.unprotected),t}function _c(e){const t={};return e.encrypted_key&&(t.encrypted_key=he.toBase64url(e.encrypted_key)),e.header&&(t.header=e.header),t}function zc(e){const t={ciphertext:he.toBase64url(e.ciphertext),protected:he.toBase64url(e.protected),iv:he.toBase64url(e.iv),tag:he.toBase64url(e.tag)};return e.aad&&(t.aad=he.toBase64url(e.aad)),e.recipients&&(t.recipients=e.recipients.map(_c)),e.unprotected&&(t.unprotected=e.unprotected),t}Lr.default={fromSplit:Ic,decode:zc,encode:Oc};const ks=42;function Lc(e){if(e.asCID!==e)return null;const t=w.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new d(c.tag,ks),new d(c.bytes,r)]}function Rc(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Mc(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const Fc={float64:!0,typeEncoders:{Object:Lc,undefined:Rc,number:Mc}};function Hc(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return w.decode(e.subarray(1))}const Ts={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};Ts.tags[ks]=Hc;const Vc="dag-cbor",qc=113,Wc=e=>vs(e,Fc),Gc=e=>Ur(e,Ts),Jc=Object.freeze(Object.defineProperty({__proto__:null,code:qc,decode:Gc,encode:Wc,name:Vc},Symbol.toStringTag,{value:"Module"})),Kc=Xn(Jc);var Xc=xe&&xe.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Qc=xe&&xe.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Zc=xe&&xe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Xc(t,e,r);return Qc(t,e),t},js=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(oe,"__esModule",{value:!0});var Bs=oe.decode=Ls=oe.encode=zs=oe.toGeneral=Is=oe.code=Ns=oe.name=void 0;const Rr=js(_r),Mr=js(Lr),$s=Zc(Kc);var Ns=oe.name="dag-jose",Is=oe.code=133;function Us(e){return"payload"in e&&typeof e.payload=="string"&&"signatures"in e&&Array.isArray(e.signatures)}function Yc(e){return"payload"in e&&e.payload instanceof Uint8Array&&"signatures"in e&&Array.isArray(e.signatures)}function el(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}function Os(e){return"ciphertext"in e&&typeof e.ciphertext=="string"&&"iv"in e&&typeof e.iv=="string"&&"protected"in e&&typeof e.protected=="string"&&"tag"in e&&typeof e.tag=="string"}function _s(e){if(typeof e=="string"){const t=e.split(".");if(t.length===3)return Rr.default.fromSplit(t);if(t.length===5)return Mr.default.fromSplit(t);throw new Error("Not a valid JOSE string")}if(Us(e)||Os(e))return e;throw new Error("Not a valid unencoded JOSE object")}var zs=oe.toGeneral=_s;function tl(e){typeof e=="string"&&(e=_s(e));let t;if(Us(e))t=Rr.default.encode(e);else if(Os(e))t=Mr.default.encode(e);else throw new Error("Not a valid JOSE object");return new Uint8Array($s.encode(t))}var Ls=oe.encode=tl;function rl(e){let t;try{t=$s.decode(e)}catch{throw new Error("Not a valid DAG-JOSE object")}if(Yc(t))return Rr.default.decode(t);if(el(t))return Mr.default.decode(t);throw new Error("Not a valid DAG-JOSE object")}Bs=oe.decode=rl;const nl=j({__proto__:null,get code(){return Is},get decode(){return Bs},default:oe,get encode(){return Ls},get name(){return Ns},get toGeneral(){return zs}},[oe]),Rs="[a-fA-F\\d:]",Ie=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${Rs})|(?<=${Rs})(?=\\s|$))`:"",pe="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",L="[a-fA-F\\d]{1,4}",Jt=`
(?:
(?:${L}:){7}(?:${L}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${L}:){6}(?:${pe}|:${L}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${L}:){5}(?::${pe}|(?::${L}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${L}:){4}(?:(?::${L}){0,1}:${pe}|(?::${L}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${L}:){3}(?:(?::${L}){0,2}:${pe}|(?::${L}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${L}:){2}(?:(?::${L}){0,3}:${pe}|(?::${L}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${L}:){1}(?:(?::${L}){0,4}:${pe}|(?::${L}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${L}){0,5}:${pe}|(?::${L}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),sl=new RegExp(`(?:^${pe}$)|(?:^${Jt}$)`),ol=new RegExp(`^${pe}$`),il=new RegExp(`^${Jt}$`),bt=e=>e&&e.exact?sl:new RegExp(`(?:${Ie(e)}${pe}${Ie(e)})|(?:${Ie(e)}${Jt}${Ie(e)})`,"g");bt.v4=e=>e&&e.exact?ol:new RegExp(`${Ie(e)}${pe}${Ie(e)}`,"g"),bt.v6=e=>e&&e.exact?il:new RegExp(`${Ie(e)}${Jt}${Ie(e)}`,"g");function al(e){const t=(...r)=>e(...r);return Object.defineProperty(t,"name",{value:`functionTimeout(${e.name||"<anonymous>"})`,configurable:!0}),t}const{toString:ul}=Object.prototype;function cl(e){return ul.call(e)==="[object RegExp]"}const Ms={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function ll(e,t={}){if(!cl(e))throw new TypeError("Expected a RegExp instance");const r=Object.keys(Ms).map(s=>(typeof t[s]=="boolean"?t[s]:e[s])?Ms[s]:"").join(""),n=new RegExp(t.source||e.source,r);return n.lastIndex=typeof t.lastIndex=="number"?t.lastIndex:e.lastIndex,n}function Fr(e,t,{timeout:r}={}){try{return al(()=>ll(e).test(t),{timeout:r})()}catch(n){throw n}}const hl=15,Fs=45,Hr={timeout:400};function Hs(e){return e.length>Fs?!1:Fr(bt({exact:!0}),e,Hr)}function fl(e){return e.length>Fs?!1:Fr(bt.v6({exact:!0}),e,Hr)}function dl(e){return e.length>hl?!1:Fr(bt.v4({exact:!0}),e,Hr)}const Vs=dl,pl=fl,qs=function(e){let t=0,r;if(e=e.trim(),Vs(e))r=new Uint8Array(t+4),e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255});else if(pl(e)){const n=e.split(":",8);let s;for(s=0;s<n.length;s++){const o=Vs(n[s]);let i;o&&(i=qs(n[s]),n[s]=ee(i.slice(0,2),"base16")),i!=null&&++s<8&&n.splice(s,0,ee(i.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);const o=[s,1];for(s=9-n.length;s>0;s--)o.push("0");n.splice.apply(n,o)}for(r=new Uint8Array(t+16),s=0;s<n.length;s++){const o=parseInt(n[s],16);r[t++]=o>>8&255,r[t++]=o&255}}if(r==null)throw new Error(`invalid ip address "${e}"`);return r},gl=function(e,t=0,r){t=~~t,r=r??e.length-t;const n=[];let s="";const o=new DataView(e.buffer);if(r===4){for(let i=0;i<r;i++)n.push(e[t+i]);s=n.join(".")}else if(r===16){for(let i=0;i<r;i+=2)n.push(o.getUint16(t+i).toString(16));s=n.join(":"),s=s.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),s=s.replace(/:{3,4}/,"::")}return s},ge=-1,Kt={},Vr={};[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,ge,"ip6zone"],[53,ge,"dns",!0],[54,ge,"dns4",!0],[55,ge,"dns6",!0],[56,ge,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,ge,"unix",!1,!0],[421,ge,"ipfs"],[421,ge,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,ge,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,ge,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,ge,"memory"]].forEach(e=>{const t=yl(...e);Vr[t.code]=t,Kt[t.name]=t});function yl(e,t,r,n,s){return{code:e,size:t,name:r,resolvable:!!n,path:!!s}}function G(e){if(typeof e=="number"){if(Vr[e]!=null)return Vr[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Kt[e]!=null)return Kt[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}function Dl(e,t){switch(G(e).code){case 4:case 41:return bl(t);case 6:case 273:case 33:case 132:return Gs(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return vl(t);case 421:return xl(t);case 444:return Js(t);case 445:return Js(t);case 466:return Sl(t);default:return ee(t,"base16")}}function wl(e,t){switch(G(e).code){case 4:return Ws(t);case 41:return Ws(t);case 6:case 273:case 33:case 132:return Wr(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return El(t);case 421:return Cl(t);case 444:return Pl(t);case 445:return kl(t);case 466:return Al(t);default:return et(t,"base16")}}const qr=Object.values(fa).map(e=>e.decoder),ml=function(){let e=qr[0].or(qr[1]);return qr.slice(2).forEach(t=>e=e.or(t)),e}();function Ws(e){if(!Hs(e))throw new Error(`invalid ip address "${e}"`);return qs(e)}function bl(e){const t=gl(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!Hs(t))throw new Error(`invalid ip address "${t}"`);return t}function Wr(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function Gs(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function El(e){const t=et(e),r=Uint8Array.from(te.encode(t.length));return tt([r,t],r.length+t.length)}function vl(e){const t=te.decode(e);if(e=e.slice(te.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return ee(e)}function Cl(e){let t;e[0]==="Q"||e[0]==="1"?t=tm(Qn.decode(`z${e}`)).bytes:t=w.parse(e).multihash.bytes;const r=Uint8Array.from(te.encode(t.length));return tt([r,t],r.length+t.length)}function Al(e){const t=ml.decode(e),r=Uint8Array.from(te.encode(t.length));return tt([r,t],r.length+t.length)}function Sl(e){const t=te.decode(e),r=e.slice(te.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+ee(r,"base64url")}function xl(e){const t=te.decode(e),r=e.slice(te.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return ee(r,"base58btc")}function Pl(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const r=Zn.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=Wr(n);return tt([r,s],r.length+s.length)}function kl(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const r=Zn.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=Wr(n);return tt([r,s],r.length+s.length)}function Js(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=ee(t,"base32"),s=Gs(r);return`${n}:${s}`}function Tl(e){const t=[],r=e.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){const s=r[n],o=G(s);if(o.size===0){t.push([s]);continue}if(n++,n>=r.length)throw Zs("invalid address: "+e);if(o.path===!0){t.push([s,Kr(r.slice(n).join("/"))]);break}t.push([s,r[n]])}return t}function jl(e){const t=[];return e.map(r=>{const n=Qt(r);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),Kr(t.join("/"))}function Bl(e){return e.map(t=>{Array.isArray(t)||(t=[t]);const r=Qt(t);return t.length>1?[r.code,wl(r.code,t[1])]:[r.code]})}function Ks(e){return e.map(t=>{const r=Qt(t);return t[1]!=null?[r.code,Dl(r.code,t[1])]:[r.code]})}function Xs(e){return Jr(tt(e.map(t=>{const r=Qt(t);let n=Uint8Array.from(te.encode(r.code));return t.length>1&&t[1]!=null&&(n=tt([n,t[1]])),n})))}function Qs(e,t){return e.size>0?e.size/8:e.size===0?0:te.decode(t)+te.decode.bytes}function Xt(e){const t=[];let r=0;for(;r<e.length;){const n=te.decode(e,r),s=te.decode.bytes,o=G(n),i=Qs(o,e.slice(r+s));if(i===0){t.push([n]),r+=s;continue}const a=e.slice(r+s,r+s+i);if(r+=i+s,r>e.length)throw Zs("Invalid address Uint8Array: "+ee(e,"base16"));t.push([n,a])}return t}function Gr(e){const t=Xt(e),r=Ks(t);return jl(r)}function $l(e){e=Kr(e);const t=Tl(e),r=Bl(t);return Xs(r)}function Nl(e){return $l(e)}function Jr(e){const t=Il(e);if(t!=null)throw t;return Uint8Array.from(e)}function Il(e){try{Xt(e)}catch(t){return t}}function Kr(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function Zs(e){return new Error("Error parsing address: "+e)}function Qt(e){return G(e[0])}var Ul=rm();const B=ue(Ul),Ol=Symbol.for("nodejs.util.inspect.custom"),Ys=[G("dns").code,G("dns4").code,G("dns6").code,G("dnsaddr").code],_l=[G("p2p").code,G("ipfs").code],eo=new Map,to=Symbol.for("@multiformats/js-multiaddr/multiaddr");let J=class Be{constructor(t){if(t==null&&(t=""),Object.defineProperty(this,to,{value:!0}),t instanceof Uint8Array)this.bytes=Jr(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=Nl(t)}else if(Be.isMultiaddr(t))this.bytes=Jr(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Gr(this.bytes)}toJSON(){return this.toString()}toOptions(){const t=this.protoCodes(),r=this.toString().split("/").slice(1);let n,s;if(r.length>2)Ys.includes(t[0])&&_l.includes(t[1])?(n=G("tcp").name,s=443):(n=G(r[2]).name,s=parseInt(r[3]));else if(Ys.includes(t[0]))n=G("tcp").name,s=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t[0]===41||t[0]===55?6:4,host:r[1],transport:n,port:s}}protos(){return this.protoCodes().map(t=>Object.assign({},G(t)))}protoCodes(){const t=[],r=this.bytes;let n=0;for(;n<r.length;){const s=te.decode(r,n),o=te.decode.bytes,i=G(s),a=Qs(i,r.slice(n+o));n+=a+o,t.push(s)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return Xt(this.bytes)}stringTuples(){const t=Xt(this.bytes);return Ks(t)}encapsulate(t){return t=new Be(t),new Be(this.toString()+t.toString())}decapsulate(t){const r=t.toString(),n=this.toString(),s=n.lastIndexOf(r);if(s<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new Be(n.slice(0,s))}decapsulateCode(t){const r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new Be(Xs(r.slice(0,n)));return this}getPeerId(){try{const t=this.stringTuples().filter(r=>r[0]===Kt.ipfs.code).pop();if((t==null?void 0:t[1])!=null){const r=t[1];return r[0]==="Q"||r[0]==="1"?ee(Qn.decode(`z${r}`),"base58btc"):ee(w.parse(r).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(r=>G(r[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return nm(this.bytes,t.bytes)}async resolve(t){const r=this.protos().find(s=>s.resolvable);if(r==null)return[this];const n=eo.get(r.name);if(n==null)throw B(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(s=>new Be(s))}nodeAddress(){const t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){const r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(t,r){if(t==null)throw new Error("requires node address object");if(r==null)throw new Error("requires transport protocol");let n;switch(t.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new Be("/"+[n,t.address,r,t.port].join("/"))}static isName(t){return Be.isMultiaddr(t)?t.protos().some(r=>r.resolvable):!1}static isMultiaddr(t){return!!(t!=null&&t[to])}[Ol](){return"<Multiaddr "+ee(this.bytes,"base16")+" - "+Gr(this.bytes)+">"}inspect(){return"<Multiaddr "+ee(this.bytes,"base16")+" - "+Gr(this.bytes)+">"}};J.resolvers=eo;function zl(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof rt<"u"&&typeof rt.versions=="object"&&rt.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var Ll=zl,Rl={};const Ml=Ll,Zt=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Et=Ml(),Fl=Zt&&!Et,Hl=Et&&!Zt,Vl=Et&&Zt,ql=typeof sm=="function"&&typeof rt<"u"&&typeof rt.release<"u"&&rt.release.name==="node"&&!Et,Wl=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Gl=typeof rt<"u"&&typeof Rl<"u"&&!1,Jl=typeof navigator<"u"&&navigator.product==="ReactNative";var Ue={isTest:Gl,isElectron:Et,isElectronMain:Hl,isElectronRenderer:Vl,isNode:ql,isBrowser:Fl,isWebWorker:Wl,isEnvWithDom:Zt,isReactNative:Jl};let Kl=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;E.nanosecond=E.ns=1/1e6,E.\u00B5s=E.\u03BCs=E.us=E.microsecond=1/1e3,E.millisecond=E.ms=E[""]=1,E.second=E.sec=E.s=E.ms*1e3,E.minute=E.min=E.m=E.s*60,E.hour=E.hr=E.h=E.m*60,E.day=E.d=E.h*24,E.week=E.wk=E.w=E.d*7,E.month=E.b=E.d*(365.25/12),E.year=E.yr=E.y=E.d*365.25;function E(e="",t="ms"){var r=null;e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2");var n=e[0]==="-";return e.replace(Kl,function(s,o,i){i=ro(i),i&&(r=(r||0)+Math.abs(parseFloat(o,10))*i)}),r&&r/(ro(t)||1)*(n?-1:1)}function ro(e){return E[e]||E[e.toLowerCase().replace(/s$/,"")]}var Xl=om();const ke=ue(Xl);ke.formatters.b=e=>e==null?"undefined":Qn.baseEncode(e),ke.formatters.t=e=>e==null?"undefined":Zn.baseEncode(e),ke.formatters.m=e=>e==null?"undefined":Kn.baseEncode(e),ke.formatters.p=e=>e==null?"undefined":e.toString(),ke.formatters.c=e=>e==null?"undefined":e.toString(),ke.formatters.k=e=>e==null?"undefined":e.toString();function no(e){return Object.assign(ke(e),{error:ke(`${e}:error`),trace:ke(`${e}:trace`)})}var vt={};let Ql=class extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}};vt.TimeoutError=Ql;let Zl=class extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}};vt.AbortError=Zl;let Yl=class extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}};vt.HTTPError=Yl;var Xr={exports:{}};globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?Xr.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:Xr.exports={default:br().default,Headers:br().Headers,Request:br().Request,Response:br().Response};var eh=Xr.exports,th=eh;const{TimeoutError:rh,AbortError:nh}=vt,{Response:so,Request:sh,Headers:Qr,default:oh}=th,ih=(e,t={})=>{const r=new XMLHttpRequest;r.open(t.method||"GET",e.toString(),!0);const{timeout:n,headers:s}=t;if(n&&n>0&&n<1/0&&(r.timeout=n),t.overrideMimeType!=null&&r.overrideMimeType(t.overrideMimeType),s)for(const[o,i]of new Qr(s))r.setRequestHeader(o,i);return t.signal&&(t.signal.onabort=()=>r.abort()),t.onUploadProgress&&(r.upload.onprogress=t.onUploadProgress),r.responseType="arraybuffer",new Promise((o,i)=>{const a=u=>{switch(u.type){case"error":{o(so.error());break}case"load":{o(new lh(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:ch(r.getAllResponseHeaders())}));break}case"timeout":{i(new rh);break}case"abort":{i(new nh);break}}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(t.body)})},ah=oh,uh=(e,t={})=>t.onUploadProgress!=null?ih(e,t):ah(e,t),ch=e=>{const t=new Qr;for(const r of e.trim().split(/[\r\n]+/)){const n=r.indexOf(": ");n>0&&t.set(r.slice(0,n),r.slice(n+1))}return t};class lh extends so{constructor(t,r,n){super(r,n),Object.defineProperty(this,"url",{value:t})}}var hh={fetch:uh,Request:sh,Headers:Qr},fh=e=>{if(Object.prototype.toString.call(e)!=="[object Object]")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype};const Yt=fh,{hasOwnProperty:oo}=Object.prototype,{propertyIsEnumerable:dh}=Object,ut=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),ph=xe,io={concatArrays:!1,ignoreUndefined:!1},er=e=>{const t=[];for(const r in e)oo.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(e);for(const n of r)dh.call(e,n)&&t.push(n)}return t};function ct(e){return Array.isArray(e)?gh(e):Yt(e)?yh(e):e}function gh(e){const t=e.slice(0,0);return er(e).forEach(r=>{ut(t,r,ct(e[r]))}),t}function yh(e){const t=Object.getPrototypeOf(e)===null?Object.create(null):{};return er(e).forEach(r=>{ut(t,r,ct(e[r]))}),t}const ao=(e,t,r,n)=>(r.forEach(s=>{typeof t[s]>"u"&&n.ignoreUndefined||(s in e&&e[s]!==Object.getPrototypeOf(e)?ut(e,s,Zr(e[s],t[s],n)):ut(e,s,ct(t[s])))}),e),Dh=(e,t,r)=>{let n=e.slice(0,0),s=0;return[e,t].forEach(o=>{const i=[];for(let a=0;a<o.length;a++)oo.call(o,a)&&(i.push(String(a)),o===e?ut(n,s++,o[a]):ut(n,s++,ct(o[a])));n=ao(n,o,er(o).filter(a=>!i.includes(a)),r)}),n};function Zr(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?Dh(e,t,r):!Yt(t)||!Yt(e)?ct(t):ao(e,t,er(t),r)}var uo=function(...e){const t=Zr(ct(io),this!==ph&&this||{},io);let r={_:{}};for(const n of e)if(n!==void 0){if(!Yt(n))throw new TypeError("`"+n+"` is not an Option Object");r=Zr(r,{_:n},t)}return r._};const wh=ue(uo),mh=typeof navigator<"u"&&navigator.product==="ReactNative";function bh(){return mh?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const Ct=self.URL,co=bh();let Eh=class{constructor(e="",t=co){this.super=new Ct(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return Ct.createObjectURL(e)}static revokeObjectURL(e){Ct.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function vh(e){if(typeof e=="string")return new Ct(e).toString();if(!(e instanceof Ct)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",s=e.protocol?e.protocol+"//":"",o=e.host||"",i=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),u=e.hash||"",f=e.pathname||"",p=e.path||f+a;return`${s}${t||r}${o||i+n}${p}${u}`}}var lo={URLWithLegacySupport:Eh,URLSearchParams:self.URLSearchParams,defaultBase:co,format:vh};const{URLWithLegacySupport:ho,format:Ch}=lo;var Ah=(e,t={},r={},n)=>{let s=t.protocol?t.protocol.replace(":",""):"http";s=(r[s]||n||s)+":";let o;try{o=new ho(e)}catch{o={}}const i=Object.assign({},t,{protocol:s||o.protocol,host:t.host||o.host});return new ho(e,Ch(i)).toString()};const{URLWithLegacySupport:Sh,format:xh,URLSearchParams:Ph,defaultBase:kh}=lo;var Th={URL:Sh,URLSearchParams:Ph,format:xh,relative:Ah,defaultBase:kh},Yr={exports:{}};function fo(e){const t=new globalThis.AbortController;function r(){t.abort();for(const n of e)!n||!n.removeEventListener||n.removeEventListener("abort",r)}for(const n of e)if(!(!n||!n.addEventListener)){if(n.aborted){r();break}n.addEventListener("abort",r)}return t.signal}Yr.exports=fo;var jh=Yr.exports.anySignal=fo,Bh=Yr.exports;async function*$h(e,t={}){const r=e.getReader();try{for(;;){const n=await r.read();if(n.done)return;yield n.value}}finally{t.preventCancel!==!0&&r.cancel(),r.releaseLock()}}var en=$h;const tr=ue(en);var po=async e=>{const t=[];for await(const r of e)t.push(r);return t};const go=ue(po),{fetch:Nh,Request:Ih,Headers:Uh}=hh,{TimeoutError:tn,HTTPError:yo}=vt,Do=uo.bind({ignoreUndefined:!0}),{URL:wo,URLSearchParams:mo}=Th,Oh=Bh,_h=en,{isBrowser:zh,isWebWorker:Lh}=Ue,Rh=po,Mh=(e,t,r)=>{if(t===void 0)return e;const n=Date.now(),s=()=>Date.now()-n>=t;return new Promise((o,i)=>{const a=setTimeout(()=>{s()&&(i(new tn),r.abort())},t),u=f=>p=>{if(clearTimeout(a),s()){i(new tn);return}f(p)};e.then(u(o),u(i))})},Fh={throwHttpErrors:!0,credentials:"same-origin"};class ne{constructor(t={}){this.opts=Do(Fh,t)}async fetch(t,r={}){const n=Do(this.opts,r),s=new Uh(n.headers);if(typeof t!="string"&&!(t instanceof wo||t instanceof Ih))throw new TypeError("`resource` must be a string, URL, or Request");const o=new wo(t.toString(),n.base),{searchParams:i,transformSearchParams:a,json:u}=n;i&&(typeof a=="function"?o.search=a(new mo(n.searchParams)):o.search=new mo(n.searchParams)),u&&(n.body=JSON.stringify(n.json),s.set("content-type","application/json"));const f=new AbortController,p=Oh([f.signal,n.signal]);globalThis.ReadableStream!=null&&n.body instanceof globalThis.ReadableStream&&(zh||Lh)&&(n.body=new Blob(await Rh(_h(n.body))));const y=await Mh(Nh(o.toString(),{...n,signal:p,timeout:void 0,headers:s,duplex:"half"}),n.timeout,f);if(!y.ok&&n.throwHttpErrors)throw n.handleError&&await n.handleError(y),new yo(y);return y.iterator=async function*(){yield*bo(y.body)},y.ndjson=async function*(){for await(const v of Hh(y.iterator()))r.transform?yield r.transform(v):yield v},y}post(t,r={}){return this.fetch(t,{...r,method:"POST"})}get(t,r={}){return this.fetch(t,{...r,method:"GET"})}put(t,r={}){return this.fetch(t,{...r,method:"PUT"})}delete(t,r={}){return this.fetch(t,{...r,method:"DELETE"})}options(t,r={}){return this.fetch(t,{...r,method:"OPTIONS"})}}const Hh=async function*(e){const t=new TextDecoder;let r="";for await(const n of e){r+=t.decode(n,{stream:!0});const s=r.split(/\r?\n/);for(let o=0;o<s.length-1;o++){const i=s[o].trim();i.length>0&&(yield JSON.parse(i))}r=s[s.length-1]}r+=t.decode(),r=r.trim(),r.length!==0&&(yield JSON.parse(r))},bo=e=>{if(Vh(e))return e;if(Wh(e)){const t=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:t.next.bind(t),return(r){return e.destroy(),typeof t.return=="function"?t.return():Promise.resolve({done:!0,value:r})}}}}}if(qh(e)){const t=e.getReader();return async function*(){try{for(;;){const{done:r,value:n}=await t.read();if(r)return;n&&(yield n)}}finally{t.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},Vh=e=>typeof e=="object"&&e!==null&&typeof e[Symbol.asyncIterator]=="function",qh=e=>e&&typeof e.getReader=="function",Wh=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");ne.HTTPError=yo,ne.TimeoutError=tn,ne.streamToAsyncIterator=bo,ne.post=(e,t)=>new ne(t).post(e,t),ne.get=(e,t)=>new ne(t).get(e,t),ne.put=(e,t)=>new ne(t).put(e,t),ne.delete=(e,t)=>new ne(t).delete(e,t),ne.options=(e,t)=>new ne(t).options(e,t);var Gh=ne;const Ke=ue(Gh);function Jh(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function rn(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function Kh(e){return new TextEncoder().encode(e)}function Xh(e){return new TextDecoder().decode(e)}function Qh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var o=e.charAt(s),i=o.charCodeAt(0);if(r[i]!==255)throw new TypeError(o+" is ambiguous");r[i]=s}var a=e.length,u=e.charAt(0),f=Math.log(a)/Math.log(256),p=Math.log(256)/Math.log(a);function y(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var C=0,V=0,$=0,O=D.length;$!==O&&D[$]===0;)$++,C++;for(var _=(O-$)*p+1>>>0,T=new Uint8Array(_);$!==O;){for(var z=D[$],Z=0,N=_-1;(z!==0||Z<V)&&N!==-1;N--,Z++)z+=256*T[N]>>>0,T[N]=z%a>>>0,z=z/a>>>0;if(z!==0)throw new Error("Non-zero carry");V=Z,$++}for(var M=_-V;M!==_&&T[M]===0;)M++;for(var Te=u.repeat(C);M<_;++M)Te+=e.charAt(T[M]);return Te}function v(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var C=0;if(D[C]!==" "){for(var V=0,$=0;D[C]===u;)V++,C++;for(var O=(D.length-C)*f+1>>>0,_=new Uint8Array(O);D[C];){var T=r[D.charCodeAt(C)];if(T===255)return;for(var z=0,Z=O-1;(T!==0||z<$)&&Z!==-1;Z--,z++)T+=a*_[Z]>>>0,_[Z]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");$=z,C++}if(D[C]!==" "){for(var N=O-$;N!==O&&_[N]===0;)N++;for(var M=new Uint8Array(V+(O-N)),Te=V;N!==O;)M[Te++]=_[N++];return M}}}function R(D){var C=v(D);if(C)return C;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:v,decode:R}}var Zh=Qh,Yh=Zh;let ef=class{constructor(e,t,r){k(this,"name");k(this,"prefix");k(this,"baseEncode");this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},tf=class{constructor(e,t,r){k(this,"name");k(this,"prefix");k(this,"baseDecode");k(this,"prefixCodePoint");this.name=e,this.prefix=t;const n=t.codePointAt(0);if(n===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Eo(this,e)}},rf=class{constructor(e){k(this,"decoders");this.decoders=e}or(e){return Eo(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r!=null)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Eo(e,t){return new rf({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}let nf=class{constructor(e,t,r,n){k(this,"name");k(this,"prefix");k(this,"baseEncode");k(this,"baseDecode");k(this,"encoder");k(this,"decoder");this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new ef(e,t,r),this.decoder=new tf(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function rr({name:e,prefix:t,encode:r,decode:n}){return new nf(e,t,r,n)}function At({name:e,prefix:t,alphabet:r}){const{encode:n,decode:s}=Yh(r,e);return rr({prefix:t,name:e,encode:n,decode:o=>rn(s(o))})}function sf(e,t,r,n){const s={};for(let p=0;p<t.length;++p)s[t[p]]=p;let o=e.length;for(;e[o-1]==="=";)--o;const i=new Uint8Array(o*r/8|0);let a=0,u=0,f=0;for(let p=0;p<o;++p){const y=s[e[p]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|y,a+=r,a>=8&&(a-=8,i[f++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return i}function of(e,t,r){const n=t[t.length-1]==="=",s=(1<<r)-1;let o="",i=0,a=0;for(let u=0;u<e.length;++u)for(a=a<<8|e[u],i+=8;i>r;)i-=r,o+=t[s&a>>i];if(i!==0&&(o+=t[s&a<<r-i]),n)for(;o.length*r&7;)o+="=";return o}function K({name:e,prefix:t,bitsPerChar:r,alphabet:n}){return rr({prefix:t,name:e,encode(s){return of(s,n,r)},decode(s){return sf(s,n,r,e)}})}const ye=At({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),af=At({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),uf=Object.freeze(Object.defineProperty({__proto__:null,base58btc:ye,base58flickr:af},Symbol.toStringTag,{value:"Module"})),Xe=K({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),cf=K({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),lf=K({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hf=K({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ff=K({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),df=K({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pf=K({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gf=K({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),yf=K({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Df=Object.freeze(Object.defineProperty({__proto__:null,base32:Xe,base32hex:ff,base32hexpad:pf,base32hexpadupper:gf,base32hexupper:df,base32pad:lf,base32padupper:hf,base32upper:cf,base32z:yf},Symbol.toStringTag,{value:"Module"})),nr=At({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),wf=At({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),mf=Object.freeze(Object.defineProperty({__proto__:null,base36:nr,base36upper:wf},Symbol.toStringTag,{value:"Module"}));var bf=Co,vo=128,Ef=127,vf=~Ef,Cf=Math.pow(2,31);function Co(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Cf;)t[r++]=e&255|vo,e/=128;for(;e&vf;)t[r++]=e&255|vo,e>>>=7;return t[r]=e|0,Co.bytes=r-n+1,t}var Af=nn,Sf=128,Ao=127;function nn(e,n){var r=0,n=n||0,s=0,o=n,i,a=e.length;do{if(o>=a)throw nn.bytes=0,new RangeError("Could not decode varint");i=e[o++],r+=s<28?(i&Ao)<<s:(i&Ao)*Math.pow(2,s),s+=7}while(i>=Sf);return nn.bytes=o-n,r}var xf=Math.pow(2,7),Pf=Math.pow(2,14),kf=Math.pow(2,21),Tf=Math.pow(2,28),jf=Math.pow(2,35),Bf=Math.pow(2,42),$f=Math.pow(2,49),Nf=Math.pow(2,56),If=Math.pow(2,63),Uf=function(e){return e<xf?1:e<Pf?2:e<kf?3:e<Tf?4:e<jf?5:e<Bf?6:e<$f?7:e<Nf?8:e<If?9:10},Of={encode:bf,decode:Af,encodingLength:Uf},sr=Of;function sn(e,t=0){return[sr.decode(e,t),sr.decode.bytes]}function or(e,t,r=0){return sr.encode(e,t,r),t}function ir(e){return sr.encodingLength(e)}function _f(e,t){const r=t.byteLength,n=ir(e),s=n+ir(r),o=new Uint8Array(s+r);return or(e,o,0),or(r,o,n),o.set(t,s),new on(e,r,t,o)}function So(e){const t=rn(e),[r,n]=sn(t),[s,o]=sn(t.subarray(n)),i=t.subarray(n+o);if(i.byteLength!==s)throw new Error("Incorrect length");return new on(r,s,i,t)}function zf(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Jh(e.bytes,r.bytes)}}let on=class{constructor(e,t,r,n){k(this,"code");k(this,"size");k(this,"digest");k(this,"bytes");this.code=e,this.size=t,this.digest=r,this.bytes=n}};function xo(e,t){const{bytes:r,version:n}=e;switch(n){case 0:return Rf(r,an(e),t??ye.encoder);default:return Mf(r,an(e),t??Xe.encoder)}}const Po=new WeakMap;function an(e){const t=Po.get(e);if(t==null){const r=new Map;return Po.set(e,r),r}return t}let ko=class re{constructor(t,r,n,s){k(this,"code");k(this,"version");k(this,"multihash");k(this,"bytes");k(this,"/");k(this,ua,"CID");this.code=r,this.version=t,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:r}=this;if(t!==St)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Ff)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return re.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:r}=this.multihash,n=_f(t,r);return re.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return re.equals(this,t)}static equals(t,r){const n=r;return n!=null&&t.code===n.code&&t.version===n.version&&zf(t.multihash,n.multihash)}toString(t){return xo(this,t)}toJSON(){return{"/":xo(this)}}link(){return this}[(ua=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;const r=t;if(r instanceof re)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:s,multihash:o,bytes:i}=r;return new re(n,s,o,i??To(n,s,o.bytes))}else if(r[Hf]===!0){const{version:n,multihash:s,code:o}=r,i=So(s);return re.create(n,o,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==St)throw new Error(`Version 0 CID must use dag-pb (code: ${St}) block encoding`);return new re(t,r,n,n.bytes)}case 1:{const s=To(t,r,n.bytes);return new re(t,r,n,s)}default:throw new Error("Invalid version")}}static createV0(t){return re.create(0,St,t)}static createV1(t,r){return re.create(1,t,r)}static decode(t){const[r,n]=re.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){const r=re.inspectBytes(t),n=r.size-r.multihashSize,s=rn(t.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");const o=s.subarray(r.multihashSize-r.digestSize),i=new on(r.multihashCode,r.digestSize,o,s);return[r.version===0?re.createV0(i):re.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0;const n=()=>{const[y,v]=sn(t.subarray(r));return r+=v,y};let s=n(),o=St;if(s===18?(s=0,r=0):o=n(),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);const i=r,a=n(),u=n(),f=r+u,p=f-i;return{version:s,codec:o,multihashCode:a,digestSize:u,multihashSize:p,size:f}}static parse(t,r){const[n,s]=Lf(t,r),o=re.decode(s);if(o.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return an(o).set(n,t),o}};function Lf(e,t){switch(e[0]){case"Q":{const r=t??ye;return[ye.prefix,r.decode(`${ye.prefix}${e}`)]}case ye.prefix:{const r=t??ye;return[ye.prefix,r.decode(e)]}case Xe.prefix:{const r=t??Xe;return[Xe.prefix,r.decode(e)]}case nr.prefix:{const r=t??nr;return[nr.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function Rf(e,t,r){const{prefix:n}=r;if(n!==ye.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(s==null){const o=r.encode(e).slice(1);return t.set(n,o),o}else return s}function Mf(e,t,r){const{prefix:n}=r,s=t.get(n);if(s==null){const o=r.encode(e);return t.set(n,o),o}else return s}const St=112,Ff=18;function To(e,t,r){const n=ir(e),s=n+ir(t),o=new Uint8Array(s+r.byteLength);return or(e,o,0),or(t,o,n),o.set(r,s),o}const Hf=Symbol.for("@ipld/js-cid/CID");function Vf(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const qf=At({prefix:"9",name:"base10",alphabet:"0123456789"}),Wf=Object.freeze(Object.defineProperty({__proto__:null,base10:qf},Symbol.toStringTag,{value:"Module"})),Gf=K({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Jf=K({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Kf=Object.freeze(Object.defineProperty({__proto__:null,base16:Gf,base16upper:Jf},Symbol.toStringTag,{value:"Module"})),Xf=K({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Qf=Object.freeze(Object.defineProperty({__proto__:null,base2:Xf},Symbol.toStringTag,{value:"Module"})),jo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Zf=jo.reduce((e,t,r)=>(e[r]=t,e),[]),Yf=jo.reduce((e,t,r)=>{const n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return e[n]=r,e},[]);function ed(e){return e.reduce((t,r)=>(t+=Zf[r],t),"")}function td(e){const t=[];for(const r of e){const n=r.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${r}`);const s=Yf[n];if(s==null)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const rd=rr({prefix:"\u{1F680}",name:"base256emoji",encode:ed,decode:td}),nd=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:rd},Symbol.toStringTag,{value:"Module"})),sd=K({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),od=K({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),id=K({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ad=K({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ud=Object.freeze(Object.defineProperty({__proto__:null,base64:sd,base64pad:od,base64url:id,base64urlpad:ad},Symbol.toStringTag,{value:"Module"})),cd=K({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ld=Object.freeze(Object.defineProperty({__proto__:null,base8:cd},Symbol.toStringTag,{value:"Module"})),hd=rr({prefix:"\0",name:"identity",encode:e=>Xh(e),decode:e=>Kh(e)}),fd=Object.freeze(Object.defineProperty({__proto__:null,identity:hd},Symbol.toStringTag,{value:"Module"}));new TextEncoder,new TextDecoder;const un={...fd,...Qf,...ld,...Wf,...Kf,...Df,...mf,...uf,...ud,...nd};function Bo(e=0){return new Uint8Array(e)}function $o(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const No=$o("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),cn=$o("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=Bo(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Io={utf8:No,"utf-8":No,hex:un.base16,latin1:cn,ascii:cn,binary:cn,...un};function Ee(e,t="utf8"){const r=Io[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}function dd(e=0){return new Uint8Array(e)}const pd=Math.pow(2,7),gd=Math.pow(2,14),yd=Math.pow(2,21),ln=Math.pow(2,28),hn=Math.pow(2,35),fn=Math.pow(2,42),dn=Math.pow(2,49),x=128,Y=127;function Oe(e){if(e<pd)return 1;if(e<gd)return 2;if(e<yd)return 3;if(e<ln)return 4;if(e<hn)return 5;if(e<fn)return 6;if(e<dn)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Dd(e,t,r=0){switch(Oe(e)){case 8:t[r++]=e&255|x,e/=128;case 7:t[r++]=e&255|x,e/=128;case 6:t[r++]=e&255|x,e/=128;case 5:t[r++]=e&255|x,e/=128;case 4:t[r++]=e&255|x,e>>>=7;case 3:t[r++]=e&255|x,e>>>=7;case 2:t[r++]=e&255|x,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function wd(e,t,r=0){switch(Oe(e)){case 8:t.set(r++,e&255|x),e/=128;case 7:t.set(r++,e&255|x),e/=128;case 6:t.set(r++,e&255|x),e/=128;case 5:t.set(r++,e&255|x),e/=128;case 4:t.set(r++,e&255|x),e>>>=7;case 3:t.set(r++,e&255|x),e>>>=7;case 2:t.set(r++,e&255|x),e>>>=7;case 1:{t.set(r++,e&255),e>>>=7;break}default:throw new Error("unreachable")}return t}function md(e,t){let r=e[t],n=0;if(n+=r&Y,r<x||(r=e[t+1],n+=(r&Y)<<7,r<x)||(r=e[t+2],n+=(r&Y)<<14,r<x)||(r=e[t+3],n+=(r&Y)<<21,r<x)||(r=e[t+4],n+=(r&Y)*ln,r<x)||(r=e[t+5],n+=(r&Y)*hn,r<x)||(r=e[t+6],n+=(r&Y)*fn,r<x)||(r=e[t+7],n+=(r&Y)*dn,r<x))return n;throw new RangeError("Could not decode varint")}function bd(e,t){let r=e.get(t),n=0;if(n+=r&Y,r<x||(r=e.get(t+1),n+=(r&Y)<<7,r<x)||(r=e.get(t+2),n+=(r&Y)<<14,r<x)||(r=e.get(t+3),n+=(r&Y)<<21,r<x)||(r=e.get(t+4),n+=(r&Y)*ln,r<x)||(r=e.get(t+5),n+=(r&Y)*hn,r<x)||(r=e.get(t+6),n+=(r&Y)*fn,r<x)||(r=e.get(t+7),n+=(r&Y)*dn,r<x))return n;throw new RangeError("Could not decode varint")}function ar(e,t,r=0){return t==null&&(t=dd(Oe(e))),t instanceof Uint8Array?Dd(e,t,r):wd(e,t,r)}function xt(e,t=0){return e instanceof Uint8Array?md(e,t):bd(e,t)}function Qe(e,t){t==null&&(t=e.reduce((s,o)=>s+o.length,0));const r=Bo(t);let n=0;for(const s of e)r.set(s,n),n+=s.length;return r}class Ed{constructor(){k(this,"index",0);k(this,"input","")}new(t){return this.index=0,this.input=t,this}readAtomically(t){const r=this.index,n=t();return n===void 0&&(this.index=r),n}parseWith(t){const r=t();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{const r=this.readChar();if(r===t)return r})}readSeparator(t,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,r,n,s){return this.readAtomically(()=>{let o=0,i=0;const a=this.peekChar();if(a===void 0)return;const u=a==="0",f=2**(8*s)-1;for(;;){const p=this.readAtomically(()=>{const y=this.readChar();if(y===void 0)return;const v=Number.parseInt(y,t);if(!Number.isNaN(v))return v});if(p===void 0)break;if(o*=t,o+=p,o>f||(i+=1,r!==void 0&&i>r))return}if(i!==0)return!n&&u&&i>1?void 0:o})}readIPv4Addr(){return this.readAtomically(()=>{const t=new Uint8Array(4);for(let r=0;r<t.length;r++){const n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[r]=n}return t})}readIPv6Addr(){const t=r=>{for(let n=0;n<r.length/2;n++){const s=n*2;if(n<r.length-3){const i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return r[s]=i[0],r[s+1]=i[1],r[s+2]=i[2],r[s+3]=i[3],[s+4,!0]}const o=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(o===void 0)return[s,!1];r[s]=o>>8,r[s+1]=o&255}return[r.length,!1]};return this.readAtomically(()=>{const r=new Uint8Array(16),[n,s]=t(r);if(n===16)return r;if(s||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;const o=new Uint8Array(14),i=16-(n+2),[a]=t(o.subarray(0,i));return r.set(o.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const Uo=45,vd=15,lt=new Ed;function Cd(e){if(!(e.length>vd))return lt.new(e).parseWith(()=>lt.readIPv4Addr())}function Ad(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Uo))return lt.new(e).parseWith(()=>lt.readIPv6Addr())}function Sd(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Uo))return lt.new(e).parseWith(()=>lt.readIPAddr())}function Oo(e,t="utf8"){const r=Io[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function xd(e){return!!Cd(e)}function Pd(e){return!!Ad(e)}function _o(e){return!!Sd(e)}const zo=xd,kd=Pd,Lo=function(e){let t=0;if(e=e.toString().trim(),zo(e)){const r=new Uint8Array(t+4);return e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255}),r}if(kd(e)){const r=e.split(":",8);let n;for(n=0;n<r.length;n++){const o=zo(r[n]);let i;o&&(i=Lo(r[n]),r[n]=Ee(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,Ee(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);const o=[n,1];for(n=9-r.length;n>0;n--)o.push("0");r.splice.apply(r,o)}const s=new Uint8Array(t+16);for(n=0;n<r.length;n++){const o=parseInt(r[n],16);s[t++]=o>>8&255,s[t++]=o&255}return s}throw new Error("invalid ip address")},Td=function(e,t=0,r){t=~~t,r=r??e.length-t;const n=new DataView(e.buffer);if(r===4){const s=[];for(let o=0;o<r;o++)s.push(e[t+o]);return s.join(".")}if(r===16){const s=[];for(let o=0;o<r;o+=2)s.push(n.getUint16(t+o).toString(16));return s.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},ie=-1,Pt={},pn={};[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,ie,"ip6zone"],[43,8,"ipcidr"],[53,ie,"dns",!0],[54,ie,"dns4",!0],[55,ie,"dns6",!0],[56,ie,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,ie,"unix",!1,!0],[421,ie,"ipfs"],[421,ie,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,ie,"garlic64"],[448,0,"tls"],[449,ie,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,ie,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,ie,"http-path"],[777,ie,"memory"]].forEach(e=>{const t=jd(...e);pn[t.code]=t,Pt[t.name]=t});function jd(e,t,r,n,s){return{code:e,size:t,name:r,resolvable:!!n,path:!!s}}function P(e){if(typeof e=="number"){if(pn[e]!=null)return pn[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Pt[e]!=null)return Pt[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}P("ip4"),P("ip6"),P("ipcidr");function Ro(e,t){switch(P(e).code){case 4:case 41:return $d(t);case 42:return wn(t);case 6:case 273:case 33:case 132:return Ho(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return wn(t);case 421:return Od(t);case 444:return Vo(t);case 445:return Vo(t);case 466:return Ud(t);case 481:return globalThis.encodeURIComponent(wn(t));default:return Ee(t,"base16")}}function Mo(e,t){switch(P(e).code){case 4:return Fo(t);case 41:return Fo(t);case 42:return Dn(t);case 6:case 273:case 33:case 132:return yn(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Dn(t);case 421:return Nd(t);case 444:return _d(t);case 445:return zd(t);case 466:return Id(t);case 481:return Dn(globalThis.decodeURIComponent(t));default:return Oo(t,"base16")}}const gn=Object.values(un).map(e=>e.decoder),Bd=function(){let e=gn[0].or(gn[1]);return gn.slice(2).forEach(t=>e=e.or(t)),e}();function Fo(e){if(!_o(e))throw new Error("invalid ip address");return Lo(e)}function $d(e){const t=Td(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!_o(t))throw new Error("invalid ip address");return t}function yn(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function Ho(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function Dn(e){const t=Oo(e),r=Uint8Array.from(ar(t.length));return Qe([r,t],r.length+t.length)}function wn(e){const t=xt(e);if(e=e.slice(Oe(t)),e.length!==t)throw new Error("inconsistent lengths");return Ee(e)}function Nd(e){let t;e[0]==="Q"||e[0]==="1"?t=So(ye.decode(`z${e}`)).bytes:t=ko.parse(e).multihash.bytes;const r=Uint8Array.from(ar(t.length));return Qe([r,t],r.length+t.length)}function Id(e){const t=Bd.decode(e),r=Uint8Array.from(ar(t.length));return Qe([r,t],r.length+t.length)}function Ud(e){const t=xt(e),r=e.slice(Oe(t));if(r.length!==t)throw new Error("inconsistent lengths");return"u"+Ee(r,"base64url")}function Od(e){const t=xt(e),r=e.slice(Oe(t));if(r.length!==t)throw new Error("inconsistent lengths");return Ee(r,"base58btc")}function _d(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const r=Xe.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=yn(n);return Qe([r,s],r.length+s.length)}function zd(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const r=Xe.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=yn(n);return Qe([r,s],r.length+s.length)}function Vo(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=Ee(t,"base32"),s=Ho(r);return`${n}:${s}`}function Ld(e){e=mn(e);const t=[],r=[];let n=null;const s=e.split("/").slice(1);if(s.length===1&&s[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let o=0;o<s.length;o++){const i=s[o],a=P(i);if(a.size===0){t.push([a.code]),r.push([a.code]);continue}if(o++,o>=s.length)throw Jo("invalid address: "+e);if(a.path===!0){n=mn(s.slice(o).join("/")),t.push([a.code,Mo(a.code,n)]),r.push([a.code,n]);break}const u=Mo(a.code,s[o]);t.push([a.code,u]),r.push([a.code,Ro(a.code,u)])}return{string:Wo(r),bytes:Go(t),tuples:t,stringTuples:r,path:n}}function qo(e){const t=[],r=[];let n=null,s=0;for(;s<e.length;){const o=xt(e,s),i=Oe(o),a=P(o),u=Rd(a,e.slice(s+i));if(u===0){t.push([o]),r.push([o]),s+=i;continue}const f=e.slice(s+i,s+i+u);if(s+=u+i,s>e.length)throw Jo("Invalid address Uint8Array: "+Ee(e,"base16"));t.push([o,f]);const p=Ro(o,f);if(r.push([o,p]),a.path===!0){n=p;break}}return{bytes:Uint8Array.from(e),string:Wo(r),tuples:t,stringTuples:r,path:n}}function Wo(e){const t=[];return e.map(r=>{const n=P(r[0]);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),mn(t.join("/"))}function Go(e){return Qe(e.map(t=>{const r=P(t[0]);let n=Uint8Array.from(ar(r.code));return t.length>1&&t[1]!=null&&(n=Qe([n,t[1]])),n}))}function Rd(e,t){if(e.size>0)return e.size/8;if(e.size===0)return 0;{const r=xt(t instanceof Uint8Array?t:Uint8Array.from(t));return r+Oe(r)}}function mn(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function Jo(e){return new Error("Error parsing address: "+e)}const Md=Symbol.for("nodejs.util.inspect.custom"),Ko=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Fd=[P("dns").code,P("dns4").code,P("dns6").code,P("dnsaddr").code];class Hd extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}}const pt=class pt{constructor(t){k(this,"bytes");_t(this,dt);_t(this,Re);_t(this,Ut);_t(this,Ot);k(this,ca,!0);t==null&&(t="");let r;if(t instanceof Uint8Array)r=qo(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);r=Ld(t)}else if(qd(t))r=qo(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,zt(this,dt,r.string),zt(this,Re,r.tuples),zt(this,Ut,r.stringTuples),zt(this,Ot,r.path)}toString(){return je(this,dt)}toJSON(){return this.toString()}toOptions(){let t,r,n,s,o="";const i=P("tcp"),a=P("udp"),u=P("ip4"),f=P("ip6"),p=P("dns6"),y=P("ip6zone");for(const[v,R]of this.stringTuples())v===y.code&&(o=`%${R??""}`),Fd.includes(v)&&(r=i.name,s=443,n=`${R??""}${o}`,t=v===p.code?6:4),(v===i.code||v===a.code)&&(r=P(v).name,s=parseInt(R??"")),(v===u.code||v===f.code)&&(r=P(v).name,n=`${R??""}${o}`,t=v===f.code?6:4);if(t==null||r==null||n==null||s==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:s}}protos(){return je(this,Re).map(([t])=>Object.assign({},P(t)))}protoCodes(){return je(this,Re).map(([t])=>t)}protoNames(){return je(this,Re).map(([t])=>P(t).name)}tuples(){return je(this,Re)}stringTuples(){return je(this,Ut)}encapsulate(t){return t=new pt(t),new pt(this.toString()+t.toString())}decapsulate(t){const r=t.toString(),n=this.toString(),s=n.lastIndexOf(r);if(s<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new pt(n.slice(0,s))}decapsulateCode(t){const r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new pt(Go(r.slice(0,n)));return this}getPeerId(){try{let t=[];this.stringTuples().forEach(([n,s])=>{n===Pt.p2p.code&&t.push([n,s]),n===Pt["p2p-circuit"].code&&(t=[])});const r=t.pop();if((r==null?void 0:r[1])!=null){const n=r[1];return n[0]==="Q"||n[0]==="1"?Ee(ye.decode(`z${n}`),"base58btc"):Ee(ko.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return je(this,Ot)}equals(t){return Vf(this.bytes,t.bytes)}async resolve(t){const r=this.protos().find(s=>s.resolvable);if(r==null)return[this];const n=Vd.get(r.name);if(n==null)throw new Hd(`no available resolver for ${r.name}`);return(await n(this,t)).map(s=>Xo(s))}nodeAddress(){const t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){const r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(ca=Ko,Md)](){return`Multiaddr(${je(this,dt)})`}};dt=new WeakMap,Re=new WeakMap,Ut=new WeakMap,Ot=new WeakMap;let bn=pt;const Vd=new Map;function qd(e){return!!(e!=null&&e[Ko])}function Xo(e){return new bn(e)}function Qo(e){let t;try{t=P("sni").code}catch{return null}for(const[r,n]of e)if(r===t&&n!==void 0)return n;return null}function Zo(e){return e.some(([t,r])=>t===P("tls").code)}function ae(e,t,r){const n=Yo[P(e).name];if(n===void 0)throw new Error(`Can't interpret protocol ${P(e).name}`);const s=n(t,r);return e===P("ip6").code?`[${s}]`:s}const Yo={ip4:(e,t)=>e,ip6:(e,t)=>t.length===0?e:`[${e}]`,tcp:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`tcp://${ae(r[0],r[1]??"",t)}:${e}`},udp:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`udp://${ae(r[0],r[1]??"",t)}:${e}`},dnsaddr:(e,t)=>e,dns4:(e,t)=>e,dns6:(e,t)=>e,dns:(e,t)=>e,ipfs:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${ae(r[0],r[1]??"",t)}/ipfs/${e}`},p2p:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${ae(r[0],r[1]??"",t)}/p2p/${e}`},http:(e,t)=>{const r=Zo(t),n=Qo(t);if(r&&n!==null)return`https://${n}`;const s=r?"https://":"http://",o=t.pop();if(o===void 0)throw new Error("Unexpected end of multiaddr");let i=ae(o[0],o[1]??"",t);return i=i.replace("tcp://",""),`${s}${i}`},tls:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return ae(r[0],r[1]??"",t)},sni:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return ae(r[0],r[1]??"",t)},https:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");let n=ae(r[0],r[1]??"",t);return n=n.replace("tcp://",""),`https://${n}`},ws:(e,t)=>{const r=Zo(t),n=Qo(t);if(r&&n!==null)return`wss://${n}`;const s=r?"wss://":"ws://",o=t.pop();if(o===void 0)throw new Error("Unexpected end of multiaddr");let i=ae(o[0],o[1]??"",t);return i=i.replace("tcp://",""),`${s}${i}`},wss:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");let n=ae(r[0],r[1]??"",t);return n=n.replace("tcp://",""),`wss://${n}`},"p2p-websocket-star":(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${ae(r[0],r[1]??"",t)}/p2p-websocket-star`},"p2p-webrtc-star":(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${ae(r[0],r[1]??"",t)}/p2p-webrtc-star`},"p2p-webrtc-direct":(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${ae(r[0],r[1]??"",t)}/p2p-webrtc-direct`}};function Wd(e,t){const r=Xo(e).stringTuples(),n=r.pop();if(n===void 0)throw new Error("Unexpected end of multiaddr");const s=P(n[0]),o=Yo[s.name];if(o==null)throw new Error(`No interpreter found for ${s.name}`);let i=o(n[1]??"",r);return n[0]===P("tcp").code&&(i=i.replace("tcp://","http://"),(n[1]==="443"||n[1]==="80")&&(n[1]==="443"&&(i=i.replace("http://","https://")),i=i.substring(0,i.lastIndexOf(":")))),i}function ei(e){try{e=Wd(new J(e))}catch{}return e=e.toString(),e}const Gd=()=>{},ti=no("ipfs-http-client:lib:error-handler"),Jd=wh.bind({ignoreUndefined:!0}),Kd=Ue.isBrowser||Ue.isWebWorker?location.protocol:"http",Xd=Ue.isBrowser||Ue.isWebWorker?location.hostname:"localhost",Qd=Ue.isBrowser||Ue.isWebWorker?location.port:"5001",Zd=(e={})=>{let t,r={},n;if(typeof e=="string"||J.isMultiaddr(e))t=new URL(ei(e));else if(e instanceof URL)t=e;else if(typeof e.url=="string"||J.isMultiaddr(e.url))t=new URL(ei(e.url)),r=e;else if(e.url instanceof URL)t=e.url,r=e;else{r=e||{};const s=(r.protocol||Kd).replace(":",""),o=(r.host||Xd).split(":")[0],i=r.port||Qd;t=new URL(`${s}://${o}:${i}`)}if(r.apiPath?t.pathname=r.apiPath:(t.pathname==="/"||t.pathname===void 0)&&(t.pathname="api/v0"),Ue.isNode){const s=Gd();n=r.agent||new s({keepAlive:!0,maxSockets:6})}return{...r,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:n}},Yd=async e=>{let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const n=await e.json();ti(n),t=n.Message||n.message}else t=await e.text()}catch(n){ti("Failed to parse error response",n),t=n.message}let r=new Ke.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(r=new Ke.TimeoutError),t&&t.includes("context deadline exceeded")&&(r=new Ke.TimeoutError)),t&&t.includes("request timed out")&&(r=new Ke.TimeoutError),t&&(r.message=t),r},ep=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,ri=e=>e.replace(ep,function(t){return"-"+t.toLowerCase()}),tp=e=>typeof e=="string"?E(e):e;class En extends Ke{constructor(t={}){const r=Zd(t);super({timeout:tp(r.timeout||0)||void 0,headers:r.headers,base:`${r.url}`,handleError:Yd,transformSearchParams:s=>{const o=new URLSearchParams;for(const[i,a]of s)a!=="undefined"&&a!=="null"&&i!=="signal"&&o.append(ri(i),a),i==="timeout"&&!isNaN(a)&&o.append(ri(i),a);return o},agent:r.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const n=this.fetch;this.fetch=(s,o={})=>(typeof s=="string"&&!s.startsWith("/")&&(s=`${r.url}/${s}`),n.call(this,s,Jd(o,{method:"POST"})))}}Ke.HTTPError;const l=e=>t=>e(new En(t),t);function ni(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}function si(e){if(e==null)return;let t;if(e.secs!=null&&(t={secs:e.secs,nsecs:e.nsecs}),e.Seconds!=null&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:(r-n*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(t!=null&&t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw B(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}function h({arg:e,searchParams:t,hashAlg:r,mtime:n,mode:s,...o}={}){t&&(o={...o,...t}),r&&(o.hash=r),n!=null&&(n=si(n),o.mtime=n.secs,o.mtimeNsecs=n.nsecs),s!=null&&(o.mode=ni(s)),o.timeout&&!isNaN(o.timeout)&&(o.timeout=`${o.timeout}ms`),e==null?e=[]:Array.isArray(e)||(e=[e]);const i=new URLSearchParams(o);return e.forEach(a=>i.append("arg",a)),i}const rp=l(e=>{async function t(r={}){return((await(await e.post("bitswap/wantlist",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()).Keys||[]).map(n=>w.parse(n["/"]))}return t}),np=l(e=>{async function t(r,n={}){return((await(await e.post("bitswap/wantlist",{signal:n.signal,searchParams:h({...n,peer:r.toString()}),headers:n.headers})).json()).Keys||[]).map(s=>w.parse(s["/"]))}return t});var sp=ii,oi=128,op=127,ip=~op,ap=Math.pow(2,31);function ii(e,t,r){t=t||[],r=r||0;for(var n=r;e>=ap;)t[r++]=e&255|oi,e/=128;for(;e&ip;)t[r++]=e&255|oi,e>>>=7;return t[r]=e|0,ii.bytes=r-n+1,t}var up=vn,cp=128,ai=127;function vn(e,n){var r=0,n=n||0,s=0,o=n,i,a=e.length;do{if(o>=a)throw vn.bytes=0,new RangeError("Could not decode varint");i=e[o++],r+=s<28?(i&ai)<<s:(i&ai)*Math.pow(2,s),s+=7}while(i>=cp);return vn.bytes=o-n,r}var lp=Math.pow(2,7),hp=Math.pow(2,14),fp=Math.pow(2,21),dp=Math.pow(2,28),pp=Math.pow(2,35),gp=Math.pow(2,42),yp=Math.pow(2,49),Dp=Math.pow(2,56),wp=Math.pow(2,63),mp=function(e){return e<lp?1:e<hp?2:e<fp?3:e<dp?4:e<pp?5:e<gp?6:e<yp?7:e<Dp?8:e<wp?9:10},bp={encode:sp,decode:up,encodingLength:mp},ur=bp;const Cn=(e,t=0)=>[ur.decode(e,t),ur.decode.bytes],cr=(e,t,r=0)=>(ur.encode(e,t,r),t),lr=e=>ur.encodingLength(e),Ep=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},hr=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},vp=e=>new TextEncoder().encode(e),Cp=e=>new TextDecoder().decode(e),fr=(e,t)=>{const r=t.byteLength,n=lr(e),s=n+lr(r),o=new Uint8Array(s+r);return cr(e,o,0),cr(r,o,n),o.set(t,s),new Sn(e,r,t,o)},An=e=>{const t=hr(e),[r,n]=Cn(t),[s,o]=Cn(t.subarray(n)),i=t.subarray(n+o);if(i.byteLength!==s)throw new Error("Incorrect length");return new Sn(r,s,i,t)},Ap=(e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Ep(e.bytes,r.bytes)}};class Sn{constructor(t,r,n,s){this.code=t,this.size=r,this.digest=n,this.bytes=s}}function Sp(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var o=e.charAt(s),i=o.charCodeAt(0);if(r[i]!==255)throw new TypeError(o+" is ambiguous");r[i]=s}var a=e.length,u=e.charAt(0),f=Math.log(a)/Math.log(256),p=Math.log(256)/Math.log(a);function y(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var C=0,V=0,$=0,O=D.length;$!==O&&D[$]===0;)$++,C++;for(var _=(O-$)*p+1>>>0,T=new Uint8Array(_);$!==O;){for(var z=D[$],Z=0,N=_-1;(z!==0||Z<V)&&N!==-1;N--,Z++)z+=256*T[N]>>>0,T[N]=z%a>>>0,z=z/a>>>0;if(z!==0)throw new Error("Non-zero carry");V=Z,$++}for(var M=_-V;M!==_&&T[M]===0;)M++;for(var Te=u.repeat(C);M<_;++M)Te+=e.charAt(T[M]);return Te}function v(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var C=0;if(D[C]!==" "){for(var V=0,$=0;D[C]===u;)V++,C++;for(var O=(D.length-C)*f+1>>>0,_=new Uint8Array(O);D[C];){var T=r[D.charCodeAt(C)];if(T===255)return;for(var z=0,Z=O-1;(T!==0||z<$)&&Z!==-1;Z--,z++)T+=a*_[Z]>>>0,_[Z]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");$=z,C++}if(D[C]!==" "){for(var N=O-$;N!==O&&_[N]===0;)N++;for(var M=new Uint8Array(V+(O-N)),Te=V;N!==O;)M[Te++]=_[N++];return M}}}function R(D){var C=v(D);if(C)return C;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:v,decode:R}}var xp=Sp,Pp=xp;class kp{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Tp{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ui(this,t)}}class jp{constructor(t){this.decoders=t}or(t){return ui(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ui=(e,t)=>new jp({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Bp{constructor(t,r,n,s){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new kp(t,r,n),this.decoder=new Tp(t,r,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const dr=({name:e,prefix:t,encode:r,decode:n})=>new Bp(e,t,r,n),kt=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=Pp(r,t);return dr({prefix:e,name:t,encode:n,decode:o=>hr(s(o))})},$p=(e,t,r,n)=>{const s={};for(let p=0;p<t.length;++p)s[t[p]]=p;let o=e.length;for(;e[o-1]==="=";)--o;const i=new Uint8Array(o*r/8|0);let a=0,u=0,f=0;for(let p=0;p<o;++p){const y=s[e[p]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|y,a+=r,a>=8&&(a-=8,i[f++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return i},Np=(e,t,r)=>{const n=t[t.length-1]==="=",s=(1<<r)-1;let o="",i=0,a=0;for(let u=0;u<e.length;++u)for(a=a<<8|e[u],i+=8;i>r;)i-=r,o+=t[s&a>>i];if(i&&(o+=t[s&a<<r-i]),n)for(;o.length*r&7;)o+="=";return o},X=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>dr({prefix:t,name:e,encode(s){return Np(s,n,r)},decode(s){return $p(s,n,r,e)}}),De=kt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ip=kt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Up=Object.freeze(Object.defineProperty({__proto__:null,base58btc:De,base58flickr:Ip},Symbol.toStringTag,{value:"Module"})),Tt=X({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Op=X({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_p=X({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zp=X({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Lp=X({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Rp=X({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mp=X({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Fp=X({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Hp=X({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Vp=Object.freeze(Object.defineProperty({__proto__:null,base32:Tt,base32hex:Lp,base32hexpad:Mp,base32hexpadupper:Fp,base32hexupper:Rp,base32pad:_p,base32padupper:zp,base32upper:Op,base32z:Hp},Symbol.toStringTag,{value:"Module"})),qp=(e,t)=>{const{bytes:r,version:n}=e;switch(n){case 0:return Gp(r,xn(e),t||De.encoder);default:return Jp(r,xn(e),t||Tt.encoder)}},ci=new WeakMap,xn=e=>{const t=ci.get(e);if(t==null){const r=new Map;return ci.set(e,r),r}return t};class F{constructor(t,r,n,s){this.code=r,this.version=t,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:r}=this;if(t!==jt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Kp)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return F.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:r}=this.multihash,n=fr(t,r);return F.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return F.equals(this,t)}static equals(t,r){const n=r;return n&&t.code===n.code&&t.version===n.version&&Ap(t.multihash,n.multihash)}toString(t){return qp(this,t)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;const r=t;if(r instanceof F)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:s,multihash:o,bytes:i}=r;return new F(n,s,o,i||li(n,s,o.bytes))}else if(r[Xp]===!0){const{version:n,multihash:s,code:o}=r,i=An(s);return F.create(n,o,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==jt)throw new Error(`Version 0 CID must use dag-pb (code: ${jt}) block encoding`);return new F(t,r,n,n.bytes)}case 1:{const s=li(t,r,n.bytes);return new F(t,r,n,s)}default:throw new Error("Invalid version")}}static createV0(t){return F.create(0,jt,t)}static createV1(t,r){return F.create(1,t,r)}static decode(t){const[r,n]=F.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){const r=F.inspectBytes(t),n=r.size-r.multihashSize,s=hr(t.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");const o=s.subarray(r.multihashSize-r.digestSize),i=new Sn(r.multihashCode,r.digestSize,o,s);return[r.version===0?F.createV0(i):F.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0;const n=()=>{const[y,v]=Cn(t.subarray(r));return r+=v,y};let s=n(),o=jt;if(s===18?(s=0,r=0):o=n(),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);const i=r,a=n(),u=n(),f=r+u,p=f-i;return{version:s,codec:o,multihashCode:a,digestSize:u,multihashSize:p,size:f}}static parse(t,r){const[n,s]=Wp(t,r),o=F.decode(s);return xn(o).set(n,t),o}}const Wp=(e,t)=>{switch(e[0]){case"Q":{const r=t||De;return[De.prefix,r.decode(`${De.prefix}${e}`)]}case De.prefix:{const r=t||De;return[De.prefix,r.decode(e)]}case Tt.prefix:{const r=t||Tt;return[Tt.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},Gp=(e,t,r)=>{const{prefix:n}=r;if(n!==De.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(s==null){const o=r.encode(e).slice(1);return t.set(n,o),o}else return s},Jp=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(s==null){const o=r.encode(e);return t.set(n,o),o}else return s},jt=112,Kp=18,li=(e,t,r)=>{const n=lr(e),s=n+lr(t),o=new Uint8Array(s+r.byteLength);return cr(e,o,0),cr(t,o,n),o.set(r,s),o},Xp=Symbol.for("@ipld/js-cid/CID"),Qp=dr({prefix:"\0",name:"identity",encode:e=>Cp(e),decode:e=>vp(e)}),Zp=Object.freeze(Object.defineProperty({__proto__:null,identity:Qp},Symbol.toStringTag,{value:"Module"})),Yp=X({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),eg=Object.freeze(Object.defineProperty({__proto__:null,base2:Yp},Symbol.toStringTag,{value:"Module"})),tg=X({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),rg=Object.freeze(Object.defineProperty({__proto__:null,base8:tg},Symbol.toStringTag,{value:"Module"})),ng=kt({prefix:"9",name:"base10",alphabet:"0123456789"}),sg=Object.freeze(Object.defineProperty({__proto__:null,base10:ng},Symbol.toStringTag,{value:"Module"})),og=X({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ig=X({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ag=Object.freeze(Object.defineProperty({__proto__:null,base16:og,base16upper:ig},Symbol.toStringTag,{value:"Module"})),ug=kt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cg=kt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),lg=Object.freeze(Object.defineProperty({__proto__:null,base36:ug,base36upper:cg},Symbol.toStringTag,{value:"Module"})),hg=X({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),fg=X({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),dg=X({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),pg=X({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),gg=Object.freeze(Object.defineProperty({__proto__:null,base64:hg,base64pad:fg,base64url:dg,base64urlpad:pg},Symbol.toStringTag,{value:"Module"})),hi=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),yg=hi.reduce((e,t,r)=>(e[r]=t,e),[]),Dg=hi.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function wg(e){return e.reduce((t,r)=>(t+=yg[r],t),"")}function mg(e){const t=[];for(const r of e){const n=Dg[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const bg=dr({prefix:"\u{1F680}",name:"base256emoji",encode:wg,decode:mg}),Eg=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:bg},Symbol.toStringTag,{value:"Module"})),vg=({name:e,code:t,encode:r})=>new Cg(e,t,r);class Cg{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?fr(this.code,r):r.then(n=>fr(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Ag=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),fi=vg({name:"sha2-256",code:18,encode:Ag("SHA-256")}),di=0,Sg="identity",pi=hr,xg=e=>fr(di,pi(e)),gi={code:di,name:Sg,encode:pi,digest:xg};new TextEncoder,new TextDecoder;const yi={...Zp,...eg,...rg,...sg,...ag,...Vp,...lg,...Up,...gg,...Eg};function Di(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const Pg=Symbol.for("@libp2p/peer-id"),kg=Symbol.for("nodejs.util.inspect.custom"),Tg=Object.values(yi).map(e=>e.decoder).reduce((e,t)=>e.or(t),yi.identity.decoder),wi=114,mi=36,bi=37;class Pn{constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Pg](){return!0}toString(){return this.string==null&&(this.string=De.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return F.createV1(wi,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){var r;if(t instanceof Uint8Array)return Di(this.multihash.bytes,t);if(typeof t=="string")return se(t).equals(this);if(((r=t==null?void 0:t.multihash)==null?void 0:r.bytes)!=null)return Di(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[kg](){return`PeerId(${this.toString()})`}}class kn extends Pn{constructor(t){super({...t,type:"RSA"}),this.type="RSA",this.publicKey=t.publicKey}}class Tn extends Pn{constructor(t){super({...t,type:"Ed25519"}),this.type="Ed25519",this.publicKey=t.multihash.digest}}class jn extends Pn{constructor(t){super({...t,type:"secp256k1"}),this.type="secp256k1",this.publicKey=t.multihash.digest}}function se(e,t){if(e.charAt(0)==="1"||e.charAt(0)==="Q"){const r=An(De.decode(`z${e}`));return e.startsWith("12D")?new Tn({multihash:r}):e.startsWith("16U")?new jn({multihash:r}):new kn({multihash:r})}return jg(Tg.decode(e))}function jg(e){try{const t=An(e);if(t.code===gi.code){if(t.digest.length===mi)return new Tn({multihash:t});if(t.digest.length===bi)return new jn({multihash:t})}if(t.code===fi.code)return new kn({multihash:t})}catch{return Bg(F.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function Bg(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==wi)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===fi.code)return new kn({multihash:e.multihash});if(t.code===gi.code){if(t.digest.length===mi)return new Tn({multihash:e.multihash});if(t.digest.length===bi)return new jn({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}const Ei=l(e=>{async function t(r={}){const n=await e.post("bitswap/stat",{searchParams:h(r),signal:r.signal,headers:r.headers});return $g(await n.json())}return t});function $g(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map(t=>w.parse(t["/"])),peers:(e.Peers||[]).map(t=>se(t)),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}const Ng=l(e=>{async function t(r,n={}){return(await e.post("bitswap/unwant",{signal:n.signal,searchParams:h({arg:r.toString(),...n}),headers:n.headers})).json()}return t});function Ig(e){return{wantlist:rp(e),wantlistForPeer:np(e),unwant:Ng(e),stat:Ei(e)}}const vi=l(e=>{async function t(r,n={}){const s=await e.post("block/get",{signal:n.signal,searchParams:h({arg:r.toString(),...n}),headers:n.headers});return new Uint8Array(await s.arrayBuffer())}return t});function Ug(e){const[t,r]=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>t.next(),push:s=>{n.push(s)},next:()=>n.length?{done:!1,value:n.shift()}:t.next(),[r](){return this}}}var Og=Ug;const pr=ue(Og);function _e(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function Bt(e){return e.constructor&&(e.constructor.name==="Blob"||e.constructor.name==="File")&&typeof e.stream=="function"}function Bn(e){return typeof e=="object"&&(e.path||e.content)}const $t=e=>e&&typeof e.getReader=="function";async function _g(e){if(_e(e))return new Blob([e]);if(typeof e=="string"||e instanceof String)return new Blob([e.toString()]);if(Bt(e))return e;if($t(e)&&(e=tr(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=pr(e),{value:r,done:n}=await t.peek();if(n)return Ci(t);if(t.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await go(t))]);if(_e(r)||typeof r=="string"||r instanceof String)return Ci(t)}throw B(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function Ci(e){const t=[];for await(const r of e)t.push(r);return new Blob(t)}var zg=async function*(e,t){for await(const r of e)yield t(r)};const $n=ue(zg);var Ai={},Si={},Nn,xi;function Lg(){if(xi)return Nn;xi=1,Nn=t;var e=Ze();function t(o,i){this.lo=o>>>0,this.hi=i>>>0}var r=t.zero=new t(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var n=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(o){if(o===0)return r;var i=o<0;i&&(o=-o);var a=o>>>0,u=(o-a)/4294967296>>>0;return i&&(u=~u>>>0,a=~a>>>0,++a>4294967295&&(a=0,++u>4294967295&&(u=0))),new t(a,u)},t.from=function(o){if(typeof o=="number")return t.fromNumber(o);if(e.isString(o))if(e.Long)o=e.Long.fromString(o);else return t.fromNumber(parseInt(o,10));return o.low||o.high?new t(o.low>>>0,o.high>>>0):r},t.prototype.toNumber=function(o){if(!o&&this.hi>>>31){var i=~this.lo+1>>>0,a=~this.hi>>>0;return i||(a=a+1>>>0),-(i+a*4294967296)}return this.lo+this.hi*4294967296},t.prototype.toLong=function(o){return e.Long?new e.Long(this.lo|0,this.hi|0,!!o):{low:this.lo|0,high:this.hi|0,unsigned:!!o}};var s=String.prototype.charCodeAt;return t.fromHash=function(o){return o===n?r:new t((s.call(o,0)|s.call(o,1)<<8|s.call(o,2)<<16|s.call(o,3)<<24)>>>0,(s.call(o,4)|s.call(o,5)<<8|s.call(o,6)<<16|s.call(o,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var o=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^o)>>>0,this.lo=(this.lo<<1^o)>>>0,this},t.prototype.zzDecode=function(){var o=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^o)>>>0,this.hi=(this.hi>>>1^o)>>>0,this},t.prototype.length=function(){var o=this.lo,i=(this.lo>>>28|this.hi<<4)>>>0,a=this.hi>>>24;return a===0?i===0?o<16384?o<128?1:2:o<2097152?3:4:i<16384?i<128?5:6:i<2097152?7:8:a<128?9:10},Nn}var Pi;function Ze(){return Pi||(Pi=1,function(e){var t=e;t.asPromise=im,t.base64=am,t.EventEmitter=um,t.float=cm,t.inquire=lm,t.utf8=hm,t.pool=fm,t.LongBits=Lg(),t.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node),t.global=t.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||xe,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(s){return typeof s=="number"&&isFinite(s)&&Math.floor(s)===s},t.isString=function(s){return typeof s=="string"||s instanceof String},t.isObject=function(s){return s&&typeof s=="object"},t.isset=t.isSet=function(s,o){var i=s[o];return i!=null&&s.hasOwnProperty(o)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1},t.Buffer=function(){try{var s=t.inquire("buffer").Buffer;return s.prototype.utf8Write?s:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(s){return typeof s=="number"?t.Buffer?t._Buffer_allocUnsafe(s):new t.Array(s):t.Buffer?t._Buffer_from(s):typeof Uint8Array>"u"?s:new Uint8Array(s)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(s){return s?t.LongBits.from(s).toHash():t.LongBits.zeroHash},t.longFromHash=function(s,o){var i=t.LongBits.fromHash(s);return t.Long?t.Long.fromBits(i.lo,i.hi,o):i.toNumber(!!o)};function r(s,o,i){for(var a=Object.keys(o),u=0;u<a.length;++u)(s[a[u]]===void 0||!i)&&(s[a[u]]=o[a[u]]);return s}t.merge=r,t.lcFirst=function(s){return s.charAt(0).toLowerCase()+s.substring(1)};function n(s){function o(i,a){if(!(this instanceof o))return new o(i,a);Object.defineProperty(this,"message",{get:function(){return i}}),Error.captureStackTrace?Error.captureStackTrace(this,o):Object.defineProperty(this,"stack",{value:new Error().stack||""}),a&&r(this,a)}return(o.prototype=Object.create(Error.prototype)).constructor=o,Object.defineProperty(o.prototype,"name",{get:function(){return s}}),o.prototype.toString=function(){return this.name+": "+this.message},o}t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(s){for(var o={},i=0;i<s.length;++i)o[s[i]]=1;return function(){for(var a=Object.keys(this),u=a.length-1;u>-1;--u)if(o[a[u]]===1&&this[a[u]]!==void 0&&this[a[u]]!==null)return a[u]}},t.oneOfSetter=function(s){return function(o){for(var i=0;i<s.length;++i)s[i]!==o&&delete this[s[i]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var s=t.Buffer;if(!s){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=s.from!==Uint8Array.from&&s.from||function(o,i){return new s(o,i)},t._Buffer_allocUnsafe=s.allocUnsafe||function(o){return new s(o)}}}(Si)),Si}var ki=A,fe=Ze(),In,gr=fe.LongBits,Ti=fe.base64,ji=fe.utf8;function Nt(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function Un(){}function Rg(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function A(){this.len=0,this.head=new Nt(Un,0,0),this.tail=this.head,this.states=null}var Bi=function(){return fe.Buffer?function(){return(A.create=function(){return new In})()}:function(){return new A}};A.create=Bi(),A.alloc=function(e){return new fe.Array(e)},fe.Array!==Array&&(A.alloc=fe.pool(A.alloc,fe.Array.prototype.subarray)),A.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Nt(e,t,r),this.len+=t,this};function On(e,t,r){t[r]=e&255}function Mg(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function _n(e,t){this.len=e,this.next=void 0,this.val=t}_n.prototype=Object.create(Nt.prototype),_n.prototype.fn=Mg,A.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new _n((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},A.prototype.int32=function(e){return e<0?this._push(zn,10,gr.fromNumber(e)):this.uint32(e)},A.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function zn(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}A.prototype.uint64=function(e){var t=gr.from(e);return this._push(zn,t.length(),t)},A.prototype.int64=A.prototype.uint64,A.prototype.sint64=function(e){var t=gr.from(e).zzEncode();return this._push(zn,t.length(),t)},A.prototype.bool=function(e){return this._push(On,1,e?1:0)};function Ln(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}A.prototype.fixed32=function(e){return this._push(Ln,4,e>>>0)},A.prototype.sfixed32=A.prototype.fixed32,A.prototype.fixed64=function(e){var t=gr.from(e);return this._push(Ln,4,t.lo)._push(Ln,4,t.hi)},A.prototype.sfixed64=A.prototype.fixed64,A.prototype.float=function(e){return this._push(fe.float.writeFloatLE,4,e)},A.prototype.double=function(e){return this._push(fe.float.writeDoubleLE,8,e)};var Fg=fe.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};A.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(On,1,0);if(fe.isString(e)){var r=A.alloc(t=Ti.length(e));Ti.decode(e,r,0),e=r}return this.uint32(t)._push(Fg,t,e)},A.prototype.string=function(e){var t=ji.length(e);return t?this.uint32(t)._push(ji.write,t,e):this._push(On,1,0)},A.prototype.fork=function(){return this.states=new Rg(this),this.head=this.tail=new Nt(Un,0,0),this.len=0,this},A.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Nt(Un,0,0),this.len=0),this},A.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},A.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},A._configure=function(e){In=e,A.create=Bi(),In._configure()};var Hg=ve,$i=ki;(ve.prototype=Object.create($i.prototype)).constructor=ve;var ze=Ze();function ve(){$i.call(this)}ve._configure=function(){ve.alloc=ze._Buffer_allocUnsafe,ve.writeBytesBuffer=ze.Buffer&&ze.Buffer.prototype instanceof Uint8Array&&ze.Buffer.prototype.set.name==="set"?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},ve.prototype.bytes=function(e){ze.isString(e)&&(e=ze._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(ve.writeBytesBuffer,t,e),this};function Vg(e,t,r){e.length<40?ze.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}ve.prototype.string=function(e){var t=ze.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Vg,t,e),this},ve._configure();var Ni=U,Ce=Ze(),Rn,Ii=Ce.LongBits,qg=Ce.utf8;function we(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function U(e){this.buf=e,this.pos=0,this.len=e.length}var Ui=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new U(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new U(e);throw Error("illegal buffer")},Oi=function(){return Ce.Buffer?function(e){return(U.create=function(t){return Ce.Buffer.isBuffer(t)?new Rn(t):Ui(t)})(e)}:Ui};U.create=Oi(),U.prototype._slice=Ce.Array.prototype.subarray||Ce.Array.prototype.slice,U.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,we(this,10);return e}}(),U.prototype.int32=function(){return this.uint32()|0},U.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Mn(){var e=new Ii(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw we(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw we(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}U.prototype.bool=function(){return this.uint32()!==0};function yr(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}U.prototype.fixed32=function(){if(this.pos+4>this.len)throw we(this,4);return yr(this.buf,this.pos+=4)},U.prototype.sfixed32=function(){if(this.pos+4>this.len)throw we(this,4);return yr(this.buf,this.pos+=4)|0};function _i(){if(this.pos+8>this.len)throw we(this,8);return new Ii(yr(this.buf,this.pos+=4),yr(this.buf,this.pos+=4))}U.prototype.float=function(){if(this.pos+4>this.len)throw we(this,4);var e=Ce.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},U.prototype.double=function(){if(this.pos+8>this.len)throw we(this,4);var e=Ce.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},U.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw we(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},U.prototype.string=function(){var e=this.bytes();return qg.read(e,0,e.length)},U.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw we(this,e);this.pos+=e}else do if(this.pos>=this.len)throw we(this);while(this.buf[this.pos++]&128);return this},U.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},U._configure=function(e){Rn=e,U.create=Oi(),Rn._configure();var t=Ce.Long?"toLong":"toNumber";Ce.merge(U.prototype,{int64:function(){return Mn.call(this)[t](!1)},uint64:function(){return Mn.call(this)[t](!0)},sint64:function(){return Mn.call(this).zzDecode()[t](!1)},fixed64:function(){return _i.call(this)[t](!0)},sfixed64:function(){return _i.call(this)[t](!1)}})};var Wg=Ye,zi=Ni;(Ye.prototype=Object.create(zi.prototype)).constructor=Ye;var Li=Ze();function Ye(e){zi.call(this,e)}Ye._configure=function(){Li.Buffer&&(Ye.prototype._slice=Li.Buffer.prototype.slice)},Ye.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},Ye._configure();var Ri={},Gg=It,Fn=Ze();(It.prototype=Object.create(Fn.EventEmitter.prototype)).constructor=It;function It(e,t,r){if(typeof e!="function")throw TypeError("rpcImpl must be a function");Fn.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!r}It.prototype.rpcCall=function e(t,r,n,s,o){if(!s)throw TypeError("request must be specified");var i=this;if(!o)return Fn.asPromise(e,i,t,r,n,s);if(!i.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return}try{return i.rpcImpl(t,r[i.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(a,u){if(a)return i.emit("error",a,t),o(a);if(u===null){i.end(!0);return}if(!(u instanceof n))try{u=n[i.responseDelimited?"decodeDelimited":"decode"](u)}catch(f){return i.emit("error",f,t),o(f)}return i.emit("data",u,t),o(null,u)})}catch(a){i.emit("error",a,t),setTimeout(function(){o(a)},0);return}},It.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},function(e){var t=e;t.Service=Gg}(Ri);var Jg={};(function(e){var t=e;t.build="minimal",t.Writer=ki,t.BufferWriter=Hg,t.Reader=Ni,t.BufferReader=Wg,t.util=Ze(),t.rpc=Ri,t.roots=Jg,t.configure=r;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}r()})(Ai);var Kg=Ai;const Le=ue(Kg),ht=Le.Reader,Hn=Le.Writer,b=Le.util,Q=Le.roots["ipfs-unixfs"]||(Le.roots["ipfs-unixfs"]={});Q.Data=(()=>{function e(t){if(this.blocksizes=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Type=0,e.prototype.Data=b.newBuffer([]),e.prototype.filesize=b.Long?b.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=b.emptyArray,e.prototype.hashType=b.Long?b.Long.fromBits(0,0,!0):0,e.prototype.fanout=b.Long?b.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(t,r){if(r||(r=Hn.create()),r.uint32(8).int32(t.Type),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&r.uint32(18).bytes(t.Data),t.filesize!=null&&Object.hasOwnProperty.call(t,"filesize")&&r.uint32(24).uint64(t.filesize),t.blocksizes!=null&&t.blocksizes.length)for(var n=0;n<t.blocksizes.length;++n)r.uint32(32).uint64(t.blocksizes[n]);return t.hashType!=null&&Object.hasOwnProperty.call(t,"hashType")&&r.uint32(40).uint64(t.hashType),t.fanout!=null&&Object.hasOwnProperty.call(t,"fanout")&&r.uint32(48).uint64(t.fanout),t.mode!=null&&Object.hasOwnProperty.call(t,"mode")&&r.uint32(56).uint32(t.mode),t.mtime!=null&&Object.hasOwnProperty.call(t,"mtime")&&Q.UnixTime.encode(t.mtime,r.uint32(66).fork()).ldelim(),r},e.decode=function(t,r){t instanceof ht||(t=ht.create(t));for(var n=r===void 0?t.len:t.pos+r,s=new Q.Data;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;case 3:s.filesize=t.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)===2)for(var i=t.uint32()+t.pos;t.pos<i;)s.blocksizes.push(t.uint64());else s.blocksizes.push(t.uint64());break;case 5:s.hashType=t.uint64();break;case 6:s.fanout=t.uint64();break;case 7:s.mode=t.uint32();break;case 8:s.mtime=Q.UnixTime.decode(t,t.uint32());break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw b.ProtocolError("missing required 'Type'",{instance:s});return s},e.fromObject=function(t){if(t instanceof Q.Data)return t;var r=new Q.Data;switch(t.Type){case"Raw":case 0:r.Type=0;break;case"Directory":case 1:r.Type=1;break;case"File":case 2:r.Type=2;break;case"Metadata":case 3:r.Type=3;break;case"Symlink":case 4:r.Type=4;break;case"HAMTShard":case 5:r.Type=5;break}if(t.Data!=null&&(typeof t.Data=="string"?b.base64.decode(t.Data,r.Data=b.newBuffer(b.base64.length(t.Data)),0):t.Data.length&&(r.Data=t.Data)),t.filesize!=null&&(b.Long?(r.filesize=b.Long.fromValue(t.filesize)).unsigned=!0:typeof t.filesize=="string"?r.filesize=parseInt(t.filesize,10):typeof t.filesize=="number"?r.filesize=t.filesize:typeof t.filesize=="object"&&(r.filesize=new b.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");r.blocksizes=[];for(var n=0;n<t.blocksizes.length;++n)b.Long?(r.blocksizes[n]=b.Long.fromValue(t.blocksizes[n])).unsigned=!0:typeof t.blocksizes[n]=="string"?r.blocksizes[n]=parseInt(t.blocksizes[n],10):typeof t.blocksizes[n]=="number"?r.blocksizes[n]=t.blocksizes[n]:typeof t.blocksizes[n]=="object"&&(r.blocksizes[n]=new b.LongBits(t.blocksizes[n].low>>>0,t.blocksizes[n].high>>>0).toNumber(!0))}if(t.hashType!=null&&(b.Long?(r.hashType=b.Long.fromValue(t.hashType)).unsigned=!0:typeof t.hashType=="string"?r.hashType=parseInt(t.hashType,10):typeof t.hashType=="number"?r.hashType=t.hashType:typeof t.hashType=="object"&&(r.hashType=new b.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),t.fanout!=null&&(b.Long?(r.fanout=b.Long.fromValue(t.fanout)).unsigned=!0:typeof t.fanout=="string"?r.fanout=parseInt(t.fanout,10):typeof t.fanout=="number"?r.fanout=t.fanout:typeof t.fanout=="object"&&(r.fanout=new b.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),t.mode!=null&&(r.mode=t.mode>>>0),t.mtime!=null){if(typeof t.mtime!="object")throw TypeError(".Data.mtime: object expected");r.mtime=Q.UnixTime.fromObject(t.mtime)}return r},e.toObject=function(t,r){r||(r={});var n={};if((r.arrays||r.defaults)&&(n.blocksizes=[]),r.defaults){if(n.Type=r.enums===String?"Raw":0,r.bytes===String?n.Data="":(n.Data=[],r.bytes!==Array&&(n.Data=b.newBuffer(n.Data))),b.Long){var s=new b.Long(0,0,!0);n.filesize=r.longs===String?s.toString():r.longs===Number?s.toNumber():s}else n.filesize=r.longs===String?"0":0;if(b.Long){var s=new b.Long(0,0,!0);n.hashType=r.longs===String?s.toString():r.longs===Number?s.toNumber():s}else n.hashType=r.longs===String?"0":0;if(b.Long){var s=new b.Long(0,0,!0);n.fanout=r.longs===String?s.toString():r.longs===Number?s.toNumber():s}else n.fanout=r.longs===String?"0":0;n.mode=0,n.mtime=null}if(t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=r.enums===String?Q.Data.DataType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=r.bytes===String?b.base64.encode(t.Data,0,t.Data.length):r.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.filesize!=null&&t.hasOwnProperty("filesize")&&(typeof t.filesize=="number"?n.filesize=r.longs===String?String(t.filesize):t.filesize:n.filesize=r.longs===String?b.Long.prototype.toString.call(t.filesize):r.longs===Number?new b.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){n.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)typeof t.blocksizes[o]=="number"?n.blocksizes[o]=r.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:n.blocksizes[o]=r.longs===String?b.Long.prototype.toString.call(t.blocksizes[o]):r.longs===Number?new b.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return t.hashType!=null&&t.hasOwnProperty("hashType")&&(typeof t.hashType=="number"?n.hashType=r.longs===String?String(t.hashType):t.hashType:n.hashType=r.longs===String?b.Long.prototype.toString.call(t.hashType):r.longs===Number?new b.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),t.fanout!=null&&t.hasOwnProperty("fanout")&&(typeof t.fanout=="number"?n.fanout=r.longs===String?String(t.fanout):t.fanout:n.fanout=r.longs===String?b.Long.prototype.toString.call(t.fanout):r.longs===Number?new b.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),t.mode!=null&&t.hasOwnProperty("mode")&&(n.mode=t.mode),t.mtime!=null&&t.hasOwnProperty("mtime")&&(n.mtime=Q.UnixTime.toObject(t.mtime,r)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Le.util.toJSONOptions)},e.DataType=function(){const t={},r=Object.create(t);return r[t[0]="Raw"]=0,r[t[1]="Directory"]=1,r[t[2]="File"]=2,r[t[3]="Metadata"]=3,r[t[4]="Symlink"]=4,r[t[5]="HAMTShard"]=5,r}(),e})(),Q.UnixTime=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Seconds=b.Long?b.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(t,r){return r||(r=Hn.create()),r.uint32(8).int64(t.Seconds),t.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&r.uint32(21).fixed32(t.FractionalNanoseconds),r},e.decode=function(t,r){t instanceof ht||(t=ht.create(t));for(var n=r===void 0?t.len:t.pos+r,s=new Q.UnixTime;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Seconds=t.int64();break;case 2:s.FractionalNanoseconds=t.fixed32();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw b.ProtocolError("missing required 'Seconds'",{instance:s});return s},e.fromObject=function(t){if(t instanceof Q.UnixTime)return t;var r=new Q.UnixTime;return t.Seconds!=null&&(b.Long?(r.Seconds=b.Long.fromValue(t.Seconds)).unsigned=!1:typeof t.Seconds=="string"?r.Seconds=parseInt(t.Seconds,10):typeof t.Seconds=="number"?r.Seconds=t.Seconds:typeof t.Seconds=="object"&&(r.Seconds=new b.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),t.FractionalNanoseconds!=null&&(r.FractionalNanoseconds=t.FractionalNanoseconds>>>0),r},e.toObject=function(t,r){r||(r={});var n={};if(r.defaults){if(b.Long){var s=new b.Long(0,0,!1);n.Seconds=r.longs===String?s.toString():r.longs===Number?s.toNumber():s}else n.Seconds=r.longs===String?"0":0;n.FractionalNanoseconds=0}return t.Seconds!=null&&t.hasOwnProperty("Seconds")&&(typeof t.Seconds=="number"?n.Seconds=r.longs===String?String(t.Seconds):t.Seconds:n.Seconds=r.longs===String?b.Long.prototype.toString.call(t.Seconds):r.longs===Number?new b.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),t.FractionalNanoseconds!=null&&t.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=t.FractionalNanoseconds),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Le.util.toJSONOptions)},e})(),Q.Metadata=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.MimeType="",e.encode=function(t,r){return r||(r=Hn.create()),t.MimeType!=null&&Object.hasOwnProperty.call(t,"MimeType")&&r.uint32(10).string(t.MimeType),r},e.decode=function(t,r){t instanceof ht||(t=ht.create(t));for(var n=r===void 0?t.len:t.pos+r,s=new Q.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.MimeType=t.string();break;default:t.skipType(o&7);break}}return s},e.fromObject=function(t){if(t instanceof Q.Metadata)return t;var r=new Q.Metadata;return t.MimeType!=null&&(r.MimeType=String(t.MimeType)),r},e.toObject=function(t,r){r||(r={});var n={};return r.defaults&&(n.MimeType=""),t.MimeType!=null&&t.hasOwnProperty("MimeType")&&(n.MimeType=t.MimeType),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Le.util.toJSONOptions)},e})();function Mi(e){if(e!=null)return typeof e=="number"?e&4095:(e=e.toString(),e.substring(0,1)==="0"?parseInt(e,8)&4095:parseInt(e,10)&4095)}function Fi(e){if(e==null)return;let t;if(e.secs!=null&&(t={secs:e.secs,nsecs:e.nsecs}),e.Seconds!=null&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:(r-n*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(t!=null&&t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw B(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}async function*Xg(e,t){if(typeof e=="string"||e instanceof String||_e(e)||Bt(e)||e._readableState)throw B(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if($t(e)&&(e=tr(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=pr(e),{value:n,done:s}=await r.peek();if(s){yield*[];return}if(r.push(n),Number.isInteger(n))throw B(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState){yield*$n(r,o=>Vn({content:o},t));return}if(_e(n)){yield Vn({content:r},t);return}if(Bn(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||$t(n)||Bt(n)){yield*$n(r,o=>Vn(o,t));return}}throw Bn(e)?B(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):B(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function Vn(e,t){const{path:r,mode:n,mtime:s,content:o}=e,i={path:r||"",mode:Mi(n),mtime:Fi(s)};return o?i.content=await t(o):r||(i.content=await t(e)),i}function Qg(e){return Xg(e,_g)}function Zg(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}async function Ae(e,t,r={}){const n=[],s=new FormData;let o=0,i=0;for await(const{content:a,path:u,mode:f,mtime:p}of Qg(e)){let y="";const v=a?"file":"dir";o>0&&(y=`-${o}`);let R=v+y;const D=[];if(f!=null&&D.push(`mode=${Zg(f)}`),p!=null){const{secs:C,nsecs:V}=p;D.push(`mtime=${C}`),V!=null&&D.push(`mtime-nsecs=${V}`)}if(D.length&&(R=`${R}?${D.join("&")}`),a){s.set(R,a,u!=null?encodeURIComponent(u):void 0);const C=i+a.size;n.push({name:u,start:i,end:C}),i=C}else if(u!=null)s.set(R,new File([""],encodeURIComponent(u),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");o++}return{total:i,parts:n,headers:r,body:s}}function Yg(e){return e.filter(Boolean)}function Se(...e){return jh(Yg(e))}const ey=l(e=>{async function t(r,n={}){const s=new AbortController,o=Se(s.signal,n.signal);let i;try{i=await(await e.post("block/put",{signal:o,searchParams:h(n),...await Ae([r],s,n.headers)})).json()}catch(a){if(n.format==="dag-pb")return t(r,{...n,format:"protobuf"});if(n.format==="dag-cbor")return t(r,{...n,format:"cbor"});throw a}return w.parse(i.Key)}return t}),ty=l(e=>{async function*t(r,n={}){Array.isArray(r)||(r=[r]);const s=await e.post("block/rm",{signal:n.signal,searchParams:h({arg:r.map(o=>o.toString()),"stream-channels":!0,...n}),headers:n.headers});for await(const o of s.ndjson())yield ry(o)}return t});function ry(e){const t={cid:w.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const ny=l(e=>{async function t(r,n={}){const s=await(await e.post("block/stat",{signal:n.signal,searchParams:h({arg:r.toString(),...n}),headers:n.headers})).json();return{cid:w.parse(s.Key),size:s.Size}}return t});function sy(e){return{get:vi(e),put:ey(e),rm:ty(e),stat:ny(e)}}const oy=l(e=>{async function t(r,n={}){const s=await e.post("bootstrap/add",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers}),{Peers:o}=await s.json();return{Peers:o.map(i=>new J(i))}}return t}),iy=l(e=>{async function t(r={}){const n=await e.post("bootstrap/rm",{signal:r.signal,searchParams:h({...r,all:!0}),headers:r.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new J(o))}}return t}),ay=l(e=>{async function t(r={}){const n=await e.post("bootstrap/list",{signal:r.signal,searchParams:h(r),headers:r.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new J(o))}}return t}),uy=l(e=>{async function t(r={}){const n=await e.post("bootstrap/add",{signal:r.signal,searchParams:h({...r,default:!0}),headers:r.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new J(o))}}return t}),cy=l(e=>{async function t(r,n={}){const s=await e.post("bootstrap/rm",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers}),{Peers:o}=await s.json();return{Peers:o.map(i=>new J(i))}}return t});function ly(e){return{add:oy(e),clear:iy(e),list:ay(e),reset:uy(e),rm:cy(e)}}const hy=l(e=>{async function t(r,n={}){const s=await(await e.post("config/profile/apply",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return t});function H(e){if(e==null)return e;const t=/^[A-Z]+$/,r={};return Object.keys(e).reduce((n,s)=>(t.test(s)?n[s.toLowerCase()]=e[s]:t.test(s[0])?n[s[0].toLowerCase()+s.slice(1)]=e[s]:n[s]=e[s],n),r)}const fy=l(e=>{async function t(r={}){return(await(await e.post("config/profile/list",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()).map(n=>H(n))}return t});function dy(e){return{apply:hy(e),list:fy(e)}}const py=l(e=>async(t,r={})=>{if(!t)throw new Error("key argument is required");return(await(await e.post("config",{signal:r.signal,searchParams:h({arg:t,...r}),headers:r.headers})).json()).Value}),gy=l(e=>async(t={})=>await(await e.post("config/show",{signal:t.signal,searchParams:h({...t}),headers:t.headers})).json()),yy=l(e=>async(t,r={})=>{const n=new AbortController,s=Se(n.signal,r.signal);await(await e.post("config/replace",{signal:s,searchParams:h(r),...await Ae([et(JSON.stringify(t))],n,r.headers)})).text()}),Dy=l(e=>async(t,r,n={})=>{if(typeof t!="string")throw new Error("Invalid key type");const s={...n,...wy(t,r)};await(await e.post("config",{signal:n.signal,searchParams:h(s),headers:n.headers})).text()}),wy=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function my(e){return{getAll:gy(e),get:py(e),set:Dy(e),replace:yy(e),profiles:dy(e)}}const by=l(e=>{async function*t(r,n={}){yield*(await e.post("dag/export",{signal:n.signal,searchParams:h({arg:r.toString()}),headers:n.headers})).iterator()}return t});async function*Hi(e,t,r,n,s){const o=async f=>{const p=await r.getCodec(f.code),y=await n(f,s);return p.decode(y)},i=t.split("/").filter(Boolean);let a=await o(e),u=e;for(;i.length;){const f=i.shift();if(!f)throw B(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,f))a=a[f],yield{value:a,remainderPath:i.join("/")};else throw B(new Error(`no link named "${f}" under ${u}`),"ERR_NO_LINK");const p=w.asCID(a);p&&(u=p,a=await o(a))}yield{value:a,remainderPath:""}}var Ey=async e=>{for await(const t of e)return t};const vy=ue(Ey);var Cy=async e=>{let t;for await(const r of e)t=r;return t};const Dr=ue(Cy),Ay=(e,t)=>l((r,n)=>{const s=vi(n);return async(o,i={})=>{if(i.path){const f=i.localResolve?await vy(Hi(o,i.path,e,s,i)):await Dr(Hi(o,i.path,e,s,i));if(!f)throw B(new Error("Not found"),"ERR_NOT_FOUND");return f}const a=await e.getCodec(o.code),u=await s(o,i);return{value:a.decode(u),remainderPath:""}}})(t),Sy=l(e=>{async function*t(r,n={}){const s=new AbortController,o=Se(s.signal,n.signal),{headers:i,body:a}=await Ae(r,s,n.headers),u=await e.post("dag/import",{signal:o,headers:i,body:a,searchParams:h({"pin-roots":n.pinRoots})});for await(const{Root:f}of u.ndjson())if(f!==void 0){const{Cid:{"/":p},PinErrorMsg:y}=f;yield{root:{cid:w.parse(p),pinErrorMsg:y}}}}return t}),Vi=(e,t)=>l(r=>async(n,s={})=>{const o={storeCodec:"dag-cbor",hashAlg:"sha2-256",...s};let i;if(o.inputCodec){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");i=n}else i=(await e.getCodec(o.storeCodec)).encode(n),o.inputCodec=o.storeCodec;const a=new AbortController,u=Se(a.signal,o.signal),f=await(await r.post("dag/put",{timeout:o.timeout,signal:u,searchParams:h(o),...await Ae([i],a,o.headers)})).json();return w.parse(f.Cid["/"])})(t),xy=l(e=>async(t,r={})=>{const n=await(await e.post("dag/resolve",{signal:r.signal,searchParams:h({arg:`${t}${r.path?`/${r.path}`.replace(/\/[/]+/g,"/"):""}`,...r}),headers:r.headers})).json();return{cid:w.parse(n.Cid["/"]),remainderPath:n.RemPath}});function Py(e,t){return{export:by(t),get:Ay(e,t),import:Sy(t),put:Vi(e,t),resolve:xy(t)}}const ky=0,Ty=1,jy=2,By=3,$y=4,Ny=5,Iy=6,Uy=7,ft=e=>{if(e.Type===ky)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===Ty)return{from:se(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map(({ID:t,Addrs:r})=>({id:se(t),multiaddrs:r.map(n=>new J(n)),protocols:[]})),providers:(e.Responses||[]).map(({ID:t,Addrs:r})=>({id:se(t),multiaddrs:r.map(n=>new J(n)),protocols:[]}))};if(e.Type===jy){let t={id:e.ID??se(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:se(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map(r=>new J(r)),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(e.Type===By)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===$y)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map(({ID:t,Addrs:r})=>({id:se(t),multiaddrs:r.map(n=>new J(n)),protocols:[]}))};if(e.Type===Ny)return{name:"VALUE",type:e.Type,value:et(e.Extra,"base64pad")};if(e.Type===Iy){const t=e.Responses.map(({ID:r})=>se(r));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:t[0]}}if(e.Type===Uy)return{name:"DIALING_PEER",type:e.Type,peer:se(e.ID)};throw new Error("Unknown DHT event type")},Oy=l(e=>{async function*t(r,n={}){const s=await e.post("dht/findpeer",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers});for await(const o of s.ndjson())yield ft(o)}return t}),_y=l(e=>{async function*t(r,n={}){const s=await e.post("dht/findprovs",{signal:n.signal,searchParams:h({arg:r.toString(),...n}),headers:n.headers});for await(const o of s.ndjson())yield ft(o)}return t}),zy=l(e=>{async function*t(r,n={}){const s=await e.post("dht/get",{signal:n.signal,searchParams:h({arg:r instanceof Uint8Array?ee(r):r.toString(),...n}),headers:n.headers});for await(const o of s.ndjson())yield ft(o)}return t}),Ly=l(e=>{async function*t(r,n={recursive:!1}){const s=Array.isArray(r)?r:[r],o=await e.post("dht/provide",{signal:n.signal,searchParams:h({arg:s.map(i=>i.toString()),...n}),headers:n.headers});for await(const i of o.ndjson())yield ft(i)}return t}),Ry=l(e=>{async function*t(r,n,s={}){const o=new AbortController,i=Se(o.signal,s.signal),a=await e.post("dht/put",{signal:i,searchParams:h({arg:r instanceof Uint8Array?ee(r):r.toString(),...s}),...await Ae([n],o,s.headers)});for await(const u of a.ndjson())yield ft(u)}return t}),My=l(e=>{async function*t(r,n={}){const s=await e.post("dht/query",{signal:n.signal,searchParams:h({arg:r.toString(),...n}),headers:n.headers});for await(const o of s.ndjson())yield ft(o)}return t});function Fy(e){return{findPeer:Oy(e),findProvs:_y(e),get:zy(e),provide:Ly(e),put:Ry(e),query:My(e)}}const Hy=l(e=>{async function t(r={}){return(await e.post("diag/cmds",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()}return t}),Vy=l(e=>{async function t(r={}){return(await e.post("diag/net",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()}return t}),qy=l(e=>{async function t(r={}){return(await e.post("diag/sys",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()}return t});function Wy(e){return{cmds:Hy(e),net:Vy(e),sys:qy(e)}}const Gy=l(e=>{async function t(r,n,s={}){await(await e.post("files/chmod",{signal:s.signal,searchParams:h({arg:r,mode:n,...s}),headers:s.headers})).text()}return t}),Jy=l(e=>{async function t(r,n,s={}){const o=Array.isArray(r)?r:[r];await(await e.post("files/cp",{signal:s.signal,searchParams:h({arg:o.concat(n).map(i=>w.asCID(i)?`/ipfs/${i}`:i),...s}),headers:s.headers})).text()}return t}),Ky=l(e=>{async function t(r,n={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");const s=await(await e.post("files/flush",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers})).json();return w.parse(s.Cid)}return t});function qn(e){const t=H(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const Xy=l(e=>{async function*t(r,n={}){if(!r)throw new Error("ipfs.files.ls requires a path");const s=await e.post("files/ls",{signal:n.signal,searchParams:h({arg:w.asCID(r)?`/ipfs/${r}`:r,long:!0,...n,stream:!0}),headers:n.headers});for await(const o of s.ndjson())if("Entries"in o)for(const i of o.Entries||[])yield qi(qn(i));else yield qi(qn(o))}return t});function qi(e){return e.hash&&(e.cid=w.parse(e.hash)),delete e.hash,e.type=e.type===1?"directory":"file",e}const Qy=l(e=>{async function t(r,n={}){await(await e.post("files/mkdir",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers})).text()}return t}),Zy=l(e=>{async function t(r,n,s={}){Array.isArray(r)||(r=[r]),await(await e.post("files/mv",{signal:s.signal,searchParams:h({arg:r.concat(n),...s}),headers:s.headers})).text()}return t});var Yy=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)return;yield n}}finally{t.releaseLock()}}();throw new Error("unknown stream")};const eD=ue(Yy),tD=l(e=>{async function*t(r,n={}){const s=await e.post("files/read",{signal:n.signal,searchParams:h({arg:r,count:n.length,...n}),headers:n.headers});yield*eD(s.body)}return t}),rD=l(e=>{async function t(r,n={}){const s=await e.post("files/rm",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers}),o=await s.text();if(o!==""){const i=new Ke.HTTPError(s);throw i.message=o,i}}return t}),Wi=l(e=>{async function t(r,n={}){const s=await(await e.post("files/stat",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers})).json();return s.WithLocality=s.WithLocality||!1,nD(qn(s))}return t});function nD(e){return e.cid=w.parse(e.hash),delete e.hash,e}const sD=l(e=>{async function t(r,n={}){await(await e.post("files/touch",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers})).text()}return t}),oD=l(e=>{async function t(r,n,s={}){const o=new AbortController,i=Se(o.signal,s.signal);await(await e.post("files/write",{signal:i,searchParams:h({arg:r,streamChannels:!0,count:s.length,...s}),...await Ae([{content:n,path:"arg",mode:ni(s.mode),mtime:si(s.mtime)}],o,s.headers)})).text()}return t});function iD(e){return{chmod:Gy(e),cp:Jy(e),flush:Ky(e),ls:Xy(e),mkdir:Qy(e),mv:Zy(e),read:tD(e),rm:rD(e),stat:Wi(e),touch:sD(e),write:oD(e)}}const aD=l(e=>async(t,r,n={})=>{throw B(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),uD=l(e=>{async function t(r,n={type:"Ed25519"}){const s=await(await e.post("key/gen",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers})).json();return H(s)}return t}),cD=l(e=>{async function t(r,n,s,o={}){const i=await(await e.post("key/import",{signal:o.signal,searchParams:h({arg:r,pem:n,password:s,...o}),headers:o.headers})).json();return H(i)}return t}),lD=l(e=>async(t,r={})=>{throw B(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),hD=l(e=>{async function t(r={}){return((await(await e.post("key/list",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()).Keys||[]).map(n=>H(n))}return t}),fD=l(e=>{async function t(r,n,s={}){const o=await e.post("key/rename",{signal:s.signal,searchParams:h({arg:[r,n],...s}),headers:s.headers});return H(await o.json())}return t}),dD=l(e=>{async function t(r,n={}){const s=await(await e.post("key/rm",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers})).json();return H(s.Keys[0])}return t});function pD(e){return{export:aD(e),gen:uD(e),import:cD(e),info:lD(e),list:hD(e),rename:fD(e),rm:dD(e)}}const gD=l(e=>{async function t(r,n,s={}){const o=await e.post("log/level",{signal:s.signal,searchParams:h({arg:[r,n],...s}),headers:s.headers});return H(await o.json())}return t}),yD=l(e=>{async function t(r={}){return(await(await e.post("log/ls",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()).Strings}return t}),DD=l(e=>{async function*t(r={}){yield*(await e.post("log/tail",{signal:r.signal,searchParams:h(r),headers:r.headers})).ndjson()}return t});function wD(e){return{level:gD(e),ls:yD(e),tail:DD(e)}}const mD=l(e=>{async function t(r,n={}){const s=await e.post("name/publish",{signal:n.signal,searchParams:h({arg:`${r}`,...n}),headers:n.headers});return H(await s.json())}return t}),bD=l(e=>{async function*t(r,n={}){const s=await e.post("name/resolve",{signal:n.signal,searchParams:h({arg:r,stream:!0,...n}),headers:n.headers});for await(const o of s.ndjson())yield o.Path}return t}),ED=l(e=>{async function t(r,n={}){const s=await e.post("name/pubsub/cancel",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers});return H(await s.json())}return t}),vD=l(e=>{async function t(r={}){const n=await e.post("name/pubsub/state",{signal:r.signal,searchParams:h(r),headers:r.headers});return H(await n.json())}return t}),CD=l(e=>{async function t(r={}){return(await(await e.post("name/pubsub/subs",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()).Strings||[]}return t});function AD(e){return{cancel:ED(e),state:vD(e),subs:CD(e)}}function SD(e){return{publish:mD(e),resolve:bD(e),pubsub:AD(e)}}const xD=l(e=>{async function t(r,n={}){const s=await(await e.post("object/data",{signal:n.signal,searchParams:h({arg:`${r instanceof Uint8Array?w.decode(r):r}`,...n}),headers:n.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return t}),PD=l(e=>{async function t(r,n={}){const s=await(await e.post("object/get",{signal:n.signal,searchParams:h({arg:`${r instanceof Uint8Array?w.decode(r):r}`,dataEncoding:"base64",...n}),headers:n.headers})).json();return{Data:et(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:w.parse(o.Hash),Tsize:o.Size}))}}return t}),kD=l(e=>{async function t(r,n={}){return((await(await e.post("object/links",{signal:n.signal,searchParams:h({arg:`${r instanceof Uint8Array?w.decode(r):r}`,...n}),headers:n.headers})).json()).Links||[]).map(s=>({Name:s.Name,Tsize:s.Size,Hash:w.parse(s.Hash)}))}return t}),TD=l(e=>{async function t(r={}){const n=await e.post("object/new",{signal:r.signal,searchParams:h({arg:r.template,...r}),headers:r.headers}),{Hash:s}=await n.json();return w.parse(s)}return t}),jD=(e,t)=>l(r=>{const n=Vi(e,t);async function s(o,i={}){return n(o,{...i,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return s})(t),BD=l(e=>{async function t(r,n={}){const s=await(await e.post("object/stat",{signal:n.signal,searchParams:h({arg:`${r}`,...n}),headers:n.headers})).json();return{...s,Hash:w.parse(s.Hash)}}return t}),$D=l(e=>{async function t(r,n,s={}){const o=await e.post("object/patch/add-link",{signal:s.signal,searchParams:h({arg:[`${r}`,n.Name||n.name||"",(n.Hash||n.cid||"").toString()||null],...s}),headers:s.headers}),{Hash:i}=await o.json();return w.parse(i)}return t}),ND=l(e=>{async function t(r,n,s={}){const o=new AbortController,i=Se(o.signal,s.signal),a=await e.post("object/patch/append-data",{signal:i,searchParams:h({arg:`${r}`,...s}),...await Ae([n],o,s.headers)}),{Hash:u}=await a.json();return w.parse(u)}return t}),ID=l(e=>{async function t(r,n,s={}){const o=await e.post("object/patch/rm-link",{signal:s.signal,searchParams:h({arg:[`${r}`,n.Name||n.name||null],...s}),headers:s.headers}),{Hash:i}=await o.json();return w.parse(i)}return t}),UD=l(e=>{async function t(r,n,s={}){const o=new AbortController,i=Se(o.signal,s.signal),a=await e.post("object/patch/set-data",{signal:i,searchParams:h({arg:[`${r}`],...s}),...await Ae([n],o,s.headers)}),{Hash:u}=await a.json();return w.parse(u)}return t});function OD(e){return{addLink:$D(e),appendData:ND(e),rmLink:ID(e),setData:UD(e)}}function _D(e,t){return{data:xD(t),get:PD(t),links:kD(t),new:TD(t),put:jD(e,t),stat:BD(t),patch:OD(t)}}async function*Gi(e){if(e==null)throw B(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const t=w.asCID(e);if(t){yield me({cid:t});return}if(e instanceof String||typeof e=="string"){yield me({path:e});return}if(e.cid!=null||e.path!=null)return yield me(e);if(Symbol.iterator in e){const r=e[Symbol.iterator](),n=r.next();if(n.done)return r;if(w.asCID(n.value)||n.value instanceof String||typeof n.value=="string"){yield me({cid:n.value});for(const s of r)yield me({cid:s});return}if(n.value.cid!=null||n.value.path!=null){yield me(n.value);for(const s of r)yield me(s);return}throw B(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){const r=e[Symbol.asyncIterator](),n=await r.next();if(n.done)return r;if(w.asCID(n.value)||n.value instanceof String||typeof n.value=="string"){yield me({cid:n.value});for await(const s of r)yield me({cid:s});return}if(n.value.cid!=null||n.value.path!=null){yield me(n.value);for await(const s of r)yield me(s);return}throw B(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw B(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}function me(e){const t=e.cid||`${e.path}`;if(!t)throw B(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const r={path:t,recursive:e.recursive!==!1};return e.metadata!=null&&(r.metadata=e.metadata),r}const Ji=l(e=>{async function*t(r,n={}){for await(const{path:s,recursive:o,metadata:i}of Gi(r)){const a=await e.post("pin/add",{signal:n.signal,searchParams:h({...n,arg:s,recursive:o,metadata:i?JSON.stringify(i):void 0,stream:!0}),headers:n.headers});for await(const u of a.ndjson()){if(u.Pins){for(const f of u.Pins)yield w.parse(f);continue}yield w.parse(u)}}}return t});function zD(e){const t=Ji(e);return l(()=>{async function r(n,s={}){return Dr(t([{path:n,...s}],s))}return r})(e)}function Ki(e,t,r){const n={type:e,cid:w.parse(t)};return r&&(n.metadata=r),n}const LD=l(e=>{async function*t(r={}){let n=[];r.paths&&(n=Array.isArray(r.paths)?r.paths:[r.paths]);const s=await e.post("pin/ls",{signal:r.signal,searchParams:h({...r,arg:n.map(o=>`${o}`),stream:!0}),headers:r.headers});for await(const o of s.ndjson()){if(o.Keys){for(const i of Object.keys(o.Keys))yield Ki(o.Keys[i].Type,i,o.Keys[i].Metadata);return}yield Ki(o.Type,o.Cid,o.Metadata)}}return t}),Xi=l(e=>{async function*t(r,n={}){for await(const{path:s,recursive:o}of Gi(r)){const i=new URLSearchParams(n.searchParams);i.append("arg",`${s}`),o!=null&&i.set("recursive",String(o));const a=await e.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:h({...n,arg:`${s}`,recursive:o})});for await(const u of a.ndjson()){if(u.Pins){yield*u.Pins.map(f=>w.parse(f));continue}yield w.parse(u)}}}return t}),RD=e=>{const t=Xi(e);return l(()=>{async function r(n,s={}){return Dr(t([{path:n,...s}],s))}return r})(e)},Qi=({Name:e,Status:t,Cid:r})=>({cid:w.parse(r),name:e,status:t}),Zi=e=>{if(typeof e=="string"&&e!=="")return e;throw new TypeError("service name must be passed")},Yi=e=>{if(w.asCID(e))return e.toString();throw new TypeError(`CID instance expected instead of ${typeof e}`)},Wn=({service:e,cid:t,name:r,status:n,all:s})=>{const o=h({service:Zi(e),name:r,force:s?!0:void 0});if(t)for(const i of t)o.append("cid",Yi(i));if(n)for(const i of n)o.append("status",i);return o},MD=({cid:e,service:t,background:r,name:n,origins:s})=>{const o=h({arg:Yi(e),service:Zi(t),name:n,background:r?!0:void 0});if(s)for(const i of s)o.append("origin",i.toString());return o};function FD(e){async function t(r,{timeout:n,signal:s,headers:o,...i}){const a=await e.post("pin/remote/add",{timeout:n,signal:s,headers:o,searchParams:MD({cid:r,...i})});return Qi(await a.json())}return t}function HD(e){async function*t({timeout:r,signal:n,headers:s,...o}){const i=await e.post("pin/remote/ls",{timeout:r,signal:n,headers:s,searchParams:Wn(o)});for await(const a of i.ndjson())yield Qi(a)}return t}function VD(e){async function t({timeout:r,signal:n,headers:s,...o}){await e.post("pin/remote/rm",{timeout:r,signal:n,headers:s,searchParams:Wn({...o,all:!1})})}return t}function qD(e){async function t({timeout:r,signal:n,headers:s,...o}){await e.post("pin/remote/rm",{timeout:r,signal:n,headers:s,searchParams:Wn({...o,all:!0})})}return t}function WD(e){const t=String(e);if(t==="undefined")throw Error("endpoint is required");return t[t.length-1]==="/"?t.slice(0,-1):t}function GD(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:JD(e.Stat)}}}function JD(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:r,Queued:n,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:t,pinned:r,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function KD(e){async function t(r,n){const{endpoint:s,key:o,headers:i,timeout:a,signal:u}=n;await e.post("pin/remote/service/add",{timeout:a,signal:u,searchParams:h({arg:[r,WD(s),o]}),headers:i})}return t}function XD(e){async function t(r={}){const{stat:n,headers:s,timeout:o,signal:i}=r,a=await e.post("pin/remote/service/ls",{timeout:o,signal:i,headers:s,searchParams:n===!0?h({stat:n}):void 0}),{RemoteServices:u}=await a.json();return u.map(GD)}return t}function QD(e){async function t(r,n={}){await e.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:h({arg:r})})}return t}function ZD(e){const t=new En(e);return{add:KD(t),ls:XD(t),rm:QD(t)}}function YD(e){const t=new En(e);return{add:FD(t),ls:HD(t),rm:VD(t),rmAll:qD(t),service:ZD(e)}}function ew(e){return{addAll:Ji(e),add:zD(e),ls:LD(e),rmAll:Xi(e),rm:RD(e),remote:YD(e)}}const tw=e=>Array.isArray(e)?e.map(ea):e,ea=e=>ee(ta(e)),ta=e=>Yn.decode(e),rw=e=>BigInt(`0x${ee(Yn.decode(e),"base16")}`),Gn=e=>Yn.encode(et(e)),nw=l(e=>{async function t(r={}){const{Strings:n}=await(await e.post("pubsub/ls",{signal:r.signal,searchParams:h(r),headers:r.headers})).json();return tw(n)||[]}return t}),sw=l(e=>{async function t(r,n={}){const s=await e.post("pubsub/peers",{signal:n.signal,searchParams:h({arg:Gn(r),...n}),headers:n.headers}),{Strings:o}=await s.json();return o||[]}return t}),ow=l(e=>{async function t(r,n,s={}){const o=h({arg:Gn(r),...s}),i=new AbortController,a=Se(i.signal,s.signal);await(await e.post("pubsub/pub",{signal:a,searchParams:o,...await Ae([n],i,s.headers)})).text()}return t}),iw=no("ipfs-http-client:pubsub:subscribe"),aw=(e,t)=>l(r=>{async function n(s,o,i={}){i.signal=t.subscribe(s,o,i.signal);let a,u;const f=new Promise((y,v)=>{a=y,u=v}),p=setTimeout(()=>a(),1e3);return r.post("pubsub/sub",{signal:i.signal,searchParams:h({arg:Gn(s),...i}),headers:i.headers}).catch(y=>{t.unsubscribe(s,o),u(y)}).then(y=>{clearTimeout(p),y&&(uw(y,{onMessage:v=>{if(o){if(typeof o=="function"){o(v);return}typeof o.handleEvent=="function"&&o.handleEvent(v)}},onEnd:()=>t.unsubscribe(s,o),onError:i.onError}),a())}),f}return n})(e);async function uw(e,{onMessage:t,onEnd:r,onError:n}){n=n||iw;try{for await(const s of e.ndjson())try{if(!s.from)continue;t({from:se(s.from),data:ta(s.data),sequenceNumber:rw(s.seqno),topic:ea(s.topicIDs[0])})}catch(o){o.message=`Failed to parse pubsub message: ${o.message}`,n(o,!1,s)}}catch(s){cw(s)||n(s,!0)}finally{r()}}const cw=e=>{switch(e.type){case"aborted":return!0;case"abort":return!0;default:return e.name==="AbortError"}},lw=(e,t)=>{async function r(n,s){t.unsubscribe(n,s)}return r};class hw{constructor(){this._subs=new Map}subscribe(t,r,n){const s=this._subs.get(t)||[];if(s.find(i=>i.handler===r))throw new Error(`Already subscribed to ${t} with this handler`);const o=new AbortController;return this._subs.set(t,[{handler:r,controller:o}].concat(s)),n&&n.addEventListener("abort",()=>this.unsubscribe(t,r)),o.signal}unsubscribe(t,r){const n=this._subs.get(t)||[];let s;r?(this._subs.set(t,n.filter(o=>o.handler!==r)),s=n.filter(o=>o.handler===r)):(this._subs.set(t,[]),s=n),(this._subs.get(t)||[]).length||this._subs.delete(t),s.forEach(o=>o.controller.abort())}}function fw(e){const t=new hw;return{ls:nw(e),peers:sw(e),publish:ow(e),subscribe:aw(e,t),unsubscribe:lw(e,t)}}const dw=l(e=>{async function*t(r={}){yield*(await e.post("refs/local",{signal:r.signal,transform:H,searchParams:h(r),headers:r.headers})).ndjson()}return t}),pw=l((e,t)=>Object.assign(async function*(r,n={}){const s=Array.isArray(r)?r:[r];yield*(await e.post("refs",{signal:n.signal,searchParams:h({arg:s.map(o=>`${o instanceof Uint8Array?w.decode(o):o}`),...n}),headers:n.headers,transform:H})).ndjson()},{local:dw(t)})),gw=l(e=>{async function*t(r={}){yield*(await e.post("repo/gc",{signal:r.signal,searchParams:h(r),headers:r.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?w.parse(n.Key["/"]):null})})).ndjson()}return t}),ra=l(e=>{async function t(r={}){const n=await(await e.post("repo/stat",{signal:r.signal,searchParams:h(r),headers:r.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return t}),yw=l(e=>{async function t(r={}){return(await(await e.post("repo/version",{signal:r.signal,searchParams:h(r),headers:r.headers})).json()).Version}return t});function Dw(e){return{gc:gw(e),stat:ra(e),version:yw(e)}}const ww=l(e=>{async function*t(r={}){yield*(await e.post("stats/bw",{signal:r.signal,searchParams:h(r),headers:r.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return t});function mw(e){return{bitswap:Ei(e),repo:ra(e),bw:ww(e)}}const bw=l(e=>{async function t(r={}){const n=await e.post("swarm/addrs",{signal:r.signal,searchParams:h(r),headers:r.headers}),{Addrs:s}=await n.json();return Object.keys(s).map(o=>({id:se(o),addrs:(s[o]||[]).map(i=>new J(i))}))}return t}),Ew=l(e=>{async function t(r,n={}){const s=await e.post("swarm/connect",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers}),{Strings:o}=await s.json();return o||[]}return t}),vw=l(e=>{async function t(r,n={}){const s=await e.post("swarm/disconnect",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers}),{Strings:o}=await s.json();return o||[]}return t}),Cw=l(e=>{async function t(r={}){const n=await e.post("swarm/addrs/local",{signal:r.signal,searchParams:h(r),headers:r.headers}),{Strings:s}=await n.json();return(s||[]).map(o=>new J(o))}return t}),Aw=l(e=>{async function t(r={}){const n=await e.post("swarm/peers",{signal:r.signal,searchParams:h(r),headers:r.headers}),{Peers:s}=await n.json();return(s||[]).map(o=>({addr:new J(o.Addr),peer:se(o.Peer),muxer:o.Muxer,latency:o.Latency,streams:o.Streams,direction:o.Direction==null?void 0:o.Direction===0?"inbound":"outbound"}))}return t});function Sw(e){return{addrs:bw(e),connect:Ew(e),disconnect:vw(e),localAddrs:Cw(e),peers:Aw(e)}}const na=l(e=>{async function*t(r,n={}){const s=new AbortController,o=Se(s.signal,n.signal),{headers:i,body:a,total:u,parts:f}=await Ae(r,s,n.headers),[p,y]=typeof n.progress=="function"?xw(u,f,n.progress):[void 0,void 0],v=await e.post("add",{searchParams:h({"stream-channels":!0,...n,progress:!!p}),onUploadProgress:y,signal:o,headers:i,body:a});for await(let R of v.ndjson())R=H(R),R.hash!==void 0?yield kw(R):p&&p(R.bytes||0,R.name)}return t}),xw=(e,t,r)=>t?[void 0,Pw(e,t,r)]:[r,void 0],Pw=(e,t,r)=>{let n=0;const s=t.length;return({loaded:o,total:i})=>{const a=Math.floor(o/i*e);for(;n<s;){const{start:u,end:f,name:p}=t[n];if(a<f){r(a-u,p);break}else r(f-u,p),n+=1}}};function kw({name:e,hash:t,size:r,mode:n,mtime:s,mtimeNsecs:o}){const i={path:e,cid:w.parse(t),size:parseInt(r)};return n!=null&&(i.mode=parseInt(n,8)),s!=null&&(i.mtime={secs:s,nsecs:o||0}),i}const sa=en;function Tw(e){return typeof e.stream=="function"?sa(e.stream()):sa(new Response(e).body)}var jw=Tw;const Bw=ue(jw);async function*wr(e){yield e}async function $w(e){if(_e(e))return wr(Jn(e));if(typeof e=="string"||e instanceof String)return wr(Jn(e.toString()));if(Bt(e))return Bw(e);if($t(e)&&(e=tr(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=pr(e),{value:r,done:n}=await t.peek();if(n)return wr(new Uint8Array(0));if(t.push(r),Number.isInteger(r))return wr(Uint8Array.from(await go(t)));if(_e(r)||typeof r=="string"||r instanceof String)return $n(t,Jn)}throw B(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function Jn(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):et(e.toString())}async function*Nw(e,t){if(e==null)throw B(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield mr(e.toString(),t);return}if(_e(e)||Bt(e)){yield mr(e,t);return}if($t(e)&&(e=tr(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=pr(e),{value:n,done:s}=await r.peek();if(s){yield{content:[]};return}if(r.push(n),Number.isInteger(n)||_e(n)||typeof n=="string"||n instanceof String){yield mr(r,t);return}throw B(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(Bn(e)){yield mr(e,t);return}throw B(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function mr(e,t){const{path:r,mode:n,mtime:s,content:o}=e,i={path:r||"",mode:Mi(n),mtime:Fi(s)};return o?i.content=await t(o):r||(i.content=await t(e)),i}function Iw(e){return Nw(e,$w)}function Uw(e){const t=na(e);return l(()=>{async function r(n,s={}){return await Dr(t(Iw(n),s))}return r})(e)}const Ow=l(e=>{async function*t(r,n={}){yield*(await e.post("cat",{signal:n.signal,searchParams:h({arg:r.toString(),...n}),headers:n.headers})).iterator()}return t}),_w=l(e=>async(t={})=>(await e.post("commands",{signal:t.signal,searchParams:h(t),headers:t.headers})).json()),zw=l(e=>async(t,r={})=>(await(await e.post("dns",{signal:r.signal,searchParams:h({arg:t,...r}),headers:r.headers})).json()).Path),Lw=l(e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}}),Rw=l(e=>{async function*t(r,n={}){const s={arg:`${r instanceof Uint8Array?w.decode(r):r}`,...n};s.compressionLevel&&(s["compression-level"]=s.compressionLevel,delete s.compressionLevel),yield*(await e.post("get",{signal:n.signal,searchParams:h(s),headers:n.headers})).iterator()}return t}),oa=l(e=>{async function t(r={}){const n=await(await e.post("id",{signal:r.signal,searchParams:h({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),s={...H(n)};return s.id=se(s.id),s.addresses&&(s.addresses=s.addresses.map(o=>new J(o))),s}return t}),Mw=e=>{const t=oa(e);async function r(n={}){const s=await t(n);return!!(s&&s.addresses&&s.addresses.length)}return r},Fw=l((e,t)=>{async function*r(n,s={}){const o=`${n instanceof Uint8Array?w.decode(n):n}`;async function i(u){let f=u.Hash;if(f.includes("/")){const y=f.startsWith("/ipfs/")?f:`/ipfs/${f}`;f=(await Wi(t)(y)).cid}else f=w.parse(f);const p={name:u.Name,path:o+(u.Name?`/${u.Name}`:""),size:u.Size,cid:f,type:Hw(u)};return u.Mode&&(p.mode=parseInt(u.Mode,8)),u.Mtime!==void 0&&u.Mtime!==null&&(p.mtime={secs:u.Mtime},u.MtimeNsecs!==void 0&&u.MtimeNsecs!==null&&(p.mtime.nsecs=u.MtimeNsecs)),p}const a=await e.post("ls",{signal:s.signal,searchParams:h({arg:o,...s}),headers:s.headers});for await(let u of a.ndjson()){if(u=u.Objects,!u)throw new Error("expected .Objects in results");if(u=u[0],!u)throw new Error("expected one array in results.Objects");const f=u.Links;if(!Array.isArray(f))throw new Error("expected one array in results.Objects[0].Links");if(!f.length){yield i(u);return}yield*f.map(i)}}return r});function Hw(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const Vw=l(e=>{async function t(r={}){const n=await e.post("dns",{signal:r.signal,searchParams:h(r),headers:r.headers});return H(await n.json())}return t}),qw=l(e=>{async function*t(r,n={}){yield*(await e.post("ping",{signal:n.signal,searchParams:h({arg:`${r}`,...n}),headers:n.headers,transform:H})).ndjson()}return t}),Ww=l(e=>{async function t(r,n={}){const s=await e.post("resolve",{signal:n.signal,searchParams:h({arg:r,...n}),headers:n.headers}),{Path:o}=await s.json();return o}return t}),Gw=l(e=>async(t={})=>{throw B(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),Jw=l(e=>{async function t(r={}){await(await e.post("shutdown",{signal:r.signal,searchParams:h(r),headers:r.headers})).text()}return t}),Kw=l(e=>{async function t(r={}){const n=await e.post("version",{signal:r.signal,searchParams:h(r),headers:r.headers});return{...H(await n.json()),"ipfs-http-client":"1.0.0"}}return t});function Xw(e={}){const t={name:da.name,code:da.code,encode:u=>u,decode:u=>u},r=Object.values(fa);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach(u=>r.push(u));const n=new q({bases:r,loadBase:e.ipld&&e.ipld.loadBase}),s=Object.values(dm);[La,cc,Ac,nl,t].concat(e.ipld&&e.ipld.codecs||[]).forEach(u=>s.push(u));const o=new wa({codecs:s,loadCodec:e.ipld&&e.ipld.loadCodec}),i=Object.values(pm);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach(u=>i.push(u));const a=new ba({hashers:i,loadHasher:e.ipld&&e.ipld.loadHasher});return{add:Uw(e),addAll:na(e),bitswap:Ig(e),block:sy(e),bootstrap:ly(e),cat:Ow(e),commands:_w(e),config:my(e),dag:Py(o,e),dht:Fy(e),diag:Wy(e),dns:zw(e),files:iD(e),get:Rw(e),getEndpointConfig:Lw(e),id:oa(e),isOnline:Mw(e),key:pD(e),log:wD(e),ls:Fw(e),mount:Vw(e),name:SD(e),object:_D(o,e),pin:ew(e),ping:qw(e),pubsub:fw(e),refs:pw(e),repo:Dw(e),resolve:Ww(e),start:Gw(e),stats:mw(e),stop:Jw(e),swarm:Sw(e),version:Kw(e),bases:n,codecs:o,hashers:a}}let ia,aa;ia="https://push.infura-ipfs.io/ipfs/",aa="https://epns-testing.infura-ipfs.io/ipfs/",ya=gm.isProduction()?ia:aa,Da=async e=>{var i;const t=pa.from(e),r=ga.ipfsInfuraAPIKey,n=ga.ipfsInfuraAPISecret,s="Basic "+pa.from(r+":"+n).toString("base64"),o=Xw({host:"ipfs.infura.io",port:5001,protocol:"https",apiPath:"/api/v0",headers:{authorization:s}});try{return(i=await o.add(t,{pin:!0}))==null?void 0:i.path}catch(a){throw Error(a)}}});export{ya as I,Dm as __tla,Da as a};
