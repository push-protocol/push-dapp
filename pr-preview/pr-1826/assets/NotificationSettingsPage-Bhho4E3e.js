import{b1 as t,br as Z,a_ as p,ez as ie,b2 as l,bq as m,bY as y,d7 as ne,eA as $,eB as le,eC as ae,eD as J,eE as re,aZ as se,aY as W,b$ as oe,eF as de,a$ as ue,ef as ce,b0 as ge,bk as pe,bn as me,dW as S,cE as he,cF as xe,dV as Y,eG as fe,dv as be,__tla as je}from"./index-C8zcvIb_.js";import{C as Ce,__tla as Se}from"./ContentLayout-VdAFxfn0.js";import{A as ye,O as we,__tla as ve}from"./OptOut-CcoiYEqn.js";import{C as Ne,__tla as _e}from"./ChannelDashboardNullState-DjnI0x4M.js";import{u as Ve,S as ke,__tla as Ee}from"./StakingVariant-DTRg4AsT.js";import{u as De,__tla as Me}from"./useMutation-DTNvpBJ1.js";import{a as Re,__tla as Te}from"./PushTokenContractHelper-ITveOoUx.js";import{C as Le,__tla as Pe}from"./Checkbox-4MVhV1q9.js";import{u as Ie,F as Ae,a as Fe,__tla as ze}from"./formik.esm-DHT6dKlJ.js";let q,Oe=Promise.all([(()=>{try{return je}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return ve}catch{}})(),(()=>{try{return _e}catch{}})(),(()=>{try{return Ee}catch{}})(),(()=>{try{return Me}catch{}})(),(()=>{try{return Te}catch{}})(),(()=>{try{return Pe}catch{}})(),(()=>{try{return ze}catch{}})()]).then(async()=>{let k,E,D,M,R,w,T,L,P,v,I,A,F,N,z,O,U,B,H;k=e=>{const{svgProps:i,...a}=e;return t.jsx(Z,{componentName:"KebabMenuVertical",icon:t.jsxs("svg",{width:"inherit",height:"inherit",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i,children:[t.jsxs("g",{"clip-path":"url(#clip0_372_37265)",children:[t.jsx("path",{d:"M16 9.00001C17.3807 9.00001 18.5 7.88072 18.5 6.5C18.5 5.11929 17.3807 4 16 4C14.6193 4 13.5 5.11929 13.5 6.5C13.5 7.88072 14.6193 9.00001 16 9.00001Z",fill:"currentColor"}),t.jsx("path",{d:"M16 18.5C17.3807 18.5 18.5 17.3807 18.5 16C18.5 14.6193 17.3807 13.5 16 13.5C14.6193 13.5 13.5 14.6193 13.5 16C13.5 17.3807 14.6193 18.5 16 18.5Z",fill:"currentColor"}),t.jsx("path",{d:"M16 28C17.3807 28 18.5 26.8807 18.5 25.5C18.5 24.1193 17.3807 23 16 23C14.6193 23 13.5 24.1193 13.5 25.5C13.5 26.8807 14.6193 28 16 28Z",fill:"currentColor"})]}),t.jsx("defs",{children:t.jsx("clipPath",{id:"clip0_372_37265",children:t.jsx("rect",{width:"32",height:"32",fill:"white"})})})]}),...a})},E=e=>{const{svgProps:i,...a}=e;return t.jsx(Z,{componentName:"Pencil",icon:t.jsxs("svg",{width:"inherit",height:"inherit",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i,children:[t.jsx("path",{d:"M8.47489 20.25H4.46739C4.27712 20.25 4.09465 20.1744 3.96012 20.0399C3.82558 19.9053 3.75 19.7229 3.75 19.5326V15.5251C3.75009 15.3351 3.82555 15.1529 3.95984 15.0185L15.0183 3.95995C15.1529 3.82552 15.3353 3.75 15.5254 3.75C15.7156 3.75 15.898 3.82552 16.0325 3.95995L20.04 7.96476C20.1745 8.09928 20.25 8.28168 20.25 8.47186C20.25 8.66204 20.1745 8.84444 20.04 8.97896L8.98154 20.0402C8.84711 20.1744 8.66489 20.2499 8.47489 20.25Z",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),t.jsx("path",{d:"M12.3589 6.61963L17.3806 11.6413",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})]}),...a})},D=()=>{const[e,i]=p.useState(!1),a=p.useCallback(()=>i(!0),[]),s=p.useCallback(()=>i(!1),[]);return{isOpen:e,onClose:s,open:a}},M=async({userPushSDKInstance:e,settings:i})=>await e.channel.setting(i),R=()=>De({mutationKey:[ie],mutationFn:M}),w={type:1,default:0,description:"",index:0},T=({modalControl:e,setSettingsToEdit:i})=>{const{open:a}=e;return t.jsxs(l,{display:"flex",alignItems:"flex-start",justifyContent:"space-between",width:"100%",children:[t.jsxs(l,{children:[t.jsx(m,{variant:"h4-semibold",color:"text-primary",children:"Notification Settings"}),t.jsx(m,{variant:"bs-regular",color:"text-tertiary",children:"Add, Edit or Remove Notification Settings"})]}),t.jsx(y,{size:"extraSmall",variant:"tertiary",leadingIcon:t.jsx(ye,{}),onClick:()=>{i(w),a()},children:"Add Setting"})]})},L=({setting:e,modalControl:i,loadingSettings:a,setSettingsToEdit:s,handleDeleteSetting:u})=>{const{open:d}=i;return t.jsxs(l,{display:"flex",width:"100%",padding:"spacing-sm spacing-none",justifyContent:"space-between",children:[t.jsx(ne,{isLoading:a,height:"20px",width:"100px",children:t.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%",gap:"spacing-xxs",children:[t.jsx(m,{variant:"bs-regular",color:"text-primary",children:e.description}),e.type==2&&t.jsx($,{children:"Range"}),e.type==3&&t.jsx($,{children:"Multi-Range"})]})}),t.jsx(le,{overlay:t.jsxs(ae,{children:[t.jsx(J,{label:"Edit",icon:t.jsx(E,{size:24}),onClick:()=>{s(e),d()}}),t.jsx(J,{label:"Remove",icon:t.jsx(we,{size:24}),onClick:()=>{u(e)}})]}),children:t.jsx(l,{cursor:"pointer",children:t.jsx(k,{})})})]})},P=({newSettings:e,loadingSettings:i,modalControl:a,setSettingsToEdit:s,handleDeleteSetting:u,handleSettingsChange:d})=>t.jsx(l,{width:"100%",display:"flex",flexDirection:"column",children:e.map((n,c)=>t.jsxs(l,{children:[t.jsx(L,{loadingSettings:i,setting:n,modalControl:a,setSettingsToEdit:s,handleDeleteSetting:u,handleSettingsChange:d}),t.jsx(re,{})]},c))}),v=50,I=({newSettings:e,channelSettings:i})=>{const a=se(),{account:s,provider:u,wallet:d}=W(),{userPushSDKInstance:n}=oe(g=>g.user),{handleConnectWalletAndEnableProfile:c}=de(),{refetchChannelDetails:h}=ue(),[j,o]=p.useState(0),[b,x]=p.useState(""),K=async()=>{const g=await Re({address:s,provider:u,contractAddress:pe.epnscore});o(parseInt(g))};p.useEffect(()=>{!s||!u||K()},[s,u]);const{mutate:G,isPending:_}=Ve(),Q=async()=>{if(!u)return;const g=u.getSigner(s),C=me((v-j).toString(),18);G({noOfTokenToApprove:C,signer:g},{onSuccess:()=>{K()},onError:r=>{console.log("Error in Approving PUSH",r),r.code=="ACTION_REJECTED"?x("User rejected signature. Please try again."):x("Error in approving PUSH Tokens")}})},{mutate:X,isPending:V}=R(),ee=async()=>{let g=n;if(!(!g.signer&&(g=await c({wallet:d}),!g))&&e.length>0){const C=e.map(r=>r.type===1?{type:r.type,description:r.description,default:r.default?1:0}:{type:r.type,description:r.description,default:r.default,data:{lower:r.lowerLimit,upper:r.upperLimit,ticker:r.ticker,enabled:r.enabled}});X({userPushSDKInstance:g,settings:C},{onSuccess:r=>{console.log("onSuccess >>>",r),r.transactionHash&&(console.log("Call channel details refetch and navigate to dashboard page"),h())},onError:r=>{console.log("Error in adding setting",r),x(r.message)}})}},te=p.useMemo(()=>{if(!i)return!1;if(e.length!==i.length)return!0;let g=!0;for(let C=0;C<e.length;C++){const r=e[C],f=i[C];r.type===1?g=g&&r.type===f.type&&r.description===f.description&&r.default===f.default:r.type===2&&(g=g&&r.type===f.type&&r.description===f.description&&r.default===f.default&&r.enabled===f.enabled&&r.lowerLimit===f.lowerLimit&&r.upperLimit===f.upperLimit&&r.ticker===f.ticker)}return g===!1},[e,i]);return t.jsxs(l,{width:"100%",gap:"spacing-md",display:"flex",flexDirection:"column",children:[b&&t.jsx(ce,{actionText:b,variant:"error"}),t.jsx(ke,{title:"Modify Setting Fee",description:"Make sure all settings are ready before proceeding to the next step",fees:50,balance:100}),t.jsxs(l,{display:"flex",justifyContent:{initial:"end",ml:"center"},gap:"spacing-xs",children:[t.jsx(y,{variant:"outline",onClick:()=>a(`${ge.ChannelDashboard}/${s}`),children:"Cancel"}),j>=v?t.jsx(y,{onClick:ee,disabled:V||!te,loading:V,children:V?"Saving":"Save Settings"}):t.jsx(y,{onClick:Q,disabled:_,loading:_,children:_?"Approving":"Approve PUSH"})]})]})},A=e=>({settingName:e.description,isDefault:e.type===1?typeof e.default=="boolean":e.enabled,enableRange:e.type!==1,rangelowerlimit:e.lowerLimit?e.lowerLimit:0,rangeupperlimit:e.upperLimit?e.upperLimit:0,enableMultiRange:e.type===3,defaultValue:typeof e.default=="number"?e.default:0,multirangelowerlimit:typeof e.default=="object"?e.default.lower:0,multirangeupperlimit:typeof e.default=="object"?e.default.upper:0,sliderStepValue:e.ticker?e.ticker:0}),F=({children:e,initialValue:i,onSubmit:a})=>{const s=Ie({initialValues:A(i),onSubmit:a});return t.jsx(Ae,{value:s,children:e})},N=()=>{const e=Fe();if(!e)throw new Error("useEditNotificationSettingsForm must be used within a EditNotificationSettingsFormProvider");return e},z=()=>{const{values:e,handleChange:i,setFieldValue:a}=N(),s=p.useMemo(()=>e.rangelowerlimit>0&&e.rangeupperlimit>0&&(e.enableMultiRange?e.multirangelowerlimit>0&&e.multirangeupperlimit>0:e.defaultValue>0)&&e.sliderStepValue>0&&Number(e.rangelowerlimit)<=Number(e.rangeupperlimit)&&Number(e.sliderStepValue)>0&&Number(e.sliderStepValue)<=Number(e.rangeupperlimit)-Number(e.rangelowerlimit)&&(e.enableMultiRange?Number(e.multirangelowerlimit)>=Number(e.rangelowerlimit)&&Number(e.multirangeupperlimit)<=Number(e.rangeupperlimit)&&Number(e.multirangeupperlimit)>Number(e.multirangelowerlimit):Number(e.defaultValue)>=Number(e.rangelowerlimit)&&Number(e.defaultValue)<=Number(e.rangeupperlimit)),[e.rangelowerlimit,e.rangeupperlimit,e.defaultValue,e.sliderStepValue,e.multirangelowerlimit,e.multirangeupperlimit,e.enableMultiRange]),[u,d]=p.useState(e.defaultValue),[n,c]=p.useState(e.multirangelowerlimit),[h,j]=p.useState(e.multirangeupperlimit);return t.jsxs(t.Fragment,{children:[t.jsxs(l,{display:"flex",flexDirection:"column",gap:"spacing-xxs",children:[t.jsx(m,{variant:"h6-bold",children:"Range Values"}),t.jsxs(l,{display:"flex",gap:"spacing-xxs",width:"100%",alignItems:"center",children:[t.jsx(S,{placeholder:"e.g.0",type:"number",value:e.rangelowerlimit,onChange:i("rangelowerlimit")}),t.jsx(m,{variant:"bm-regular",children:"to"}),t.jsx(S,{placeholder:"e.g.10",type:"number",value:e.rangeupperlimit,onChange:o=>{a("rangeupperlimit",o.target.value)}})]})]}),t.jsxs(l,{display:"flex",gap:"spacing-xxs",children:[t.jsx(Le,{checked:e.enableMultiRange,onChange:()=>a("enableMultiRange",!e.enableMultiRange)}),t.jsxs(l,{children:[t.jsx(m,{ellipsis:!0,variant:"h6-bold",children:"Enable Multi Range"}),t.jsx(m,{variant:"bes-regular",children:"User can select a range of values in the slider"})]})]}),!e.enableMultiRange&&t.jsx(S,{placeholder:"e.g.0",type:"number",value:e.defaultValue,onChange:o=>{d(Number(o.target.value)),a("defaultValue",o.target.value)},label:"Default Value"}),e.enableMultiRange&&t.jsxs(l,{display:"flex",flexDirection:"column",gap:"spacing-xxs",children:[t.jsx(m,{variant:"h6-bold",children:"Range Values"}),t.jsxs(l,{display:"flex",gap:"spacing-xxs",width:"100%",alignItems:"center",children:[t.jsx(S,{placeholder:"e.g.0",type:"number",value:e.multirangelowerlimit,onChange:o=>{a("multirangelowerlimit",o.target.value),c(Number(o.target.value))}}),t.jsx(m,{variant:"bm-regular",children:"to"}),t.jsx(S,{placeholder:"e.g.10",type:"number",value:e.multirangeupperlimit,onChange:o=>{a("multirangeupperlimit",o.target.value),j(Number(o.target.value))}})]})]}),t.jsx(l,{children:t.jsx(S,{placeholder:"e.g.0",type:"number",value:e.sliderStepValue,onChange:o=>{i("sliderStepValue"),a("sliderStepValue",o.target.value)},label:"Slider Step Value"})}),s&&t.jsxs(l,{display:"flex",flexDirection:"column",gap:"spacing-xxs",children:[t.jsx(l,{children:"Preview"}),!e.enableMultiRange&&t.jsxs(l,{display:"flex",gap:"spacing-xxs",alignItems:"center",children:[t.jsx(l,{children:e.rangelowerlimit}),t.jsx(l,{width:"100%",children:t.jsx(he,{val:u,min:Number(e.rangelowerlimit),max:Number(e.rangeupperlimit),step:Number(e.sliderStepValue),defaultVal:Number(e.defaultValue),onChange:({x:o})=>{d(o)},preview:!0})}),t.jsx(l,{children:e.rangeupperlimit})]}),e.enableMultiRange&&t.jsxs(l,{display:"flex",gap:"spacing-xxs",alignItems:"center",backgroundColor:"surface-secondary",padding:"spacing-xs",borderRadius:"radius-xxs",children:[t.jsx(l,{children:e.rangelowerlimit}),t.jsx(l,{width:"100%",children:t.jsx(xe,{startVal:n,endVal:h,min:Number(e.rangelowerlimit),max:Number(e.rangeupperlimit),step:Number(e.sliderStepValue),defaultStartVal:Number(e.multirangelowerlimit),defaultEndVal:Number(e.multirangeupperlimit),onChange:({startVal:o,endVal:b})=>{c(o),j(b)},preview:!0})}),t.jsx(l,{children:e.rangeupperlimit})]})]})]})},O=({modalControl:e})=>{const{values:i,handleSubmit:a,handleChange:s,touched:u,errors:d,setFieldValue:n}=N(),{onClose:c}=e;return t.jsx(l,{width:"100%",children:t.jsx("form",{onSubmit:a,children:t.jsxs(l,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",gap:"spacing-md",children:[t.jsx(m,{textAlign:"center",variant:"h4-semibold",children:"Add a Setting"}),t.jsxs(l,{display:"flex",flexDirection:"column",gap:"spacing-md",padding:"spacing-none spacing-xs",width:"-webkit-fill-available",children:[t.jsx(S,{placeholder:"e.g. Announcements",label:"Setting Name",totalCount:50,value:i.settingName,onChange:s("settingName"),error:u.settingName&&!!d.settingName,errorMessage:u.settingName?d.settingName:""}),t.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[t.jsxs(l,{children:[t.jsx(m,{ellipsis:!0,variant:"h6-bold",children:"Set as Default"}),t.jsx(m,{variant:"bes-regular",children:"Setting on for users by default"})]}),t.jsx(Y,{leadingToggle:!1,checked:i.isDefault,onCheckedChange:h=>n("isDefault",h)})]}),t.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[t.jsxs(l,{children:[t.jsx(m,{ellipsis:!0,variant:"h6-bold",children:"Range"}),t.jsx(m,{variant:"bes-regular",children:"Set a range for this setting e.g. 1-10"})]}),t.jsx(Y,{leadingToggle:!1,checked:i.enableRange,onCheckedChange:h=>n("enableRange",h)})]}),i.enableRange&&t.jsx(z,{})]}),t.jsxs(l,{display:"flex",justifyContent:"center",alignItems:"center",padding:"spacing-xxs",gap:"spacing-xs",alignSelf:"center",children:[t.jsx(y,{size:"small",variant:"outline",onClick:c,children:"Cancel"}),t.jsx(y,{size:"small",variant:"primary",children:"Save settings"})]})]})})})},U=({modalControl:e,settingsToEdit:i,handleSettingsChange:a})=>{const{isOpen:s,onClose:u}=e,d=n=>{const c=i.index!==0?i.index:Math.floor(Math.random()*1e6),h=n.enableRange?n.enableMultiRange?{type:3,default:{lower:Number(n.multirangelowerlimit),upper:Number(n.multirangeupperlimit)},enabled:n.isDefault,description:n.settingName,lowerLimit:Number(n.rangelowerlimit),upperLimit:Number(n.rangeupperlimit),ticker:Number(n.sliderStepValue),index:c}:{type:2,default:Number(n.defaultValue),enabled:n.isDefault,description:n.settingName,lowerLimit:Number(n.rangelowerlimit),upperLimit:Number(n.rangeupperlimit),ticker:Number(n.sliderStepValue),index:c}:{type:1,default:n.isDefault,description:n.settingName,index:c};a(h),u()};return t.jsx(fe,{isOpen:s,onClose:u,acceptButtonProps:null,cancelButtonProps:null,children:t.jsx(F,{initialValue:i,onSubmit:n=>{d(n)},children:t.jsx(O,{modalControl:e})})})},B=({modalControl:e,channelSettings:i,loadingSettings:a,settingsToEdit:s,setSettingsToEdit:u})=>{const[d,n]=p.useState([]),{open:c}=e;p.useEffect(()=>{i&&!a&&n(i)},[a]);const h=o=>{n(b=>b.filter(x=>x.index!==o.index))},j=o=>{const b=d.findIndex(x=>x.index===o.index);if(b===-1)n([...d,o]);else{const x=[...d];x[b]=o,n(x)}};return t.jsxs(l,{width:"100%",display:"flex",flexDirection:"column",gap:"spacing-md",children:[d.length>0?t.jsx(P,{newSettings:d,modalControl:e,setSettingsToEdit:u,loadingSettings:a,handleDeleteSetting:h,handleSettingsChange:j}):t.jsx(Ne,{state:"notificationSettings",title:"No settings yet",subTitle:"Add options for users to customize notifications.",onClick:c}),t.jsx(U,{modalControl:e,settingsToEdit:s,setNewSettings:n,handleSettingsChange:j}),t.jsx(I,{newSettings:d,channelSettings:i})]})},H=()=>{const{account:e}=W(),{data:i,isLoading:a}=be(e),s=i!=null&&i.channel_settings?i==null?void 0:i.channel_settings:"",u=a?Array(3).fill(0):s?JSON.parse(s):[],d=D(),[n,c]=p.useState(w);return t.jsxs(l,{display:"flex",padding:{initial:"spacing-lg",ml:"spacing-md"},flexDirection:"column",gap:"spacing-md",width:{ml:"357px",initial:"800px"},alignItems:"center",borderRadius:"radius-md",backgroundColor:"surface-primary",children:[t.jsx(T,{modalControl:d,setSettingsToEdit:c}),t.jsx(B,{modalControl:d,settingsToEdit:n,setSettingsToEdit:c,channelSettings:u,loadingSettings:a})]})},q=()=>t.jsx(Ce,{children:t.jsx(H,{})})});export{Oe as __tla,q as default};
