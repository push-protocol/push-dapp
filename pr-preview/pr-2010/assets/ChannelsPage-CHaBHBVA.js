import{d_ as i,ei as G,eO as Fe,hz as Ie,hA as Te,ex as Be,dX as f,hB as Re,hC as $e,hD as qe,hE as J,ev as Ke,d$ as d,go as We,gp as Ue,gK as X,ed as A,e3 as S,em as H,hF as Q,ej as Ge,gz as Je,fK as Y,gy as Xe,gx as Z,hG as He,gd as ee,e2 as Qe,__tla as Ye}from"./index-CZLrk271.js";import{S as ae,__tla as Ze}from"./Search-MhY0kUEQ.js";import{u as ea,__tla as aa}from"./useGetChannelsList-D246h9dT.js";import{u as ia,I as ta,__tla as ra}from"./InfiniteScroll-CdrO6RTI.js";import{u as na,__tla as sa}from"./useGetChannelCategories-CxaG-PNM.js";import{C as la,__tla as oa}from"./ChannelDetailsCard-Cv-hdIud.js";import{u as ca,__tla as ha}from"./VerifiedChannelTooltipContent-CwEhL_lO.js";import{U as da,b as ua,__tla as ga}from"./UnlockProfileWrapper-BUY4xw2B.js";import{C as pa,__tla as fa}from"./ContentLayout-Dw07Vrq9.js";import{__tla as ma}from"./PushLogo-BIjqtvst.js";let ie,xa=Promise.all([(()=>{try{return Ye}catch{}})(),(()=>{try{return Ze}catch{}})(),(()=>{try{return aa}catch{}})(),(()=>{try{return ra}catch{}})(),(()=>{try{return sa}catch{}})(),(()=>{try{return oa}catch{}})(),(()=>{try{return ha}catch{}})(),(()=>{try{return ga}catch{}})(),(()=>{try{return fa}catch{}})(),(()=>{try{return ma}catch{}})()]).then(async()=>{const te=e=>{const{svgProps:a,...r}=e;return i.jsx(G,{componentName:"CaretLeft",icon:i.jsx("svg",{width:"inherit",height:"inherit",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:i.jsx("path",{d:"M14.8389 17.5875L9.25137 12L14.8389 6.41248",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})}),...r})},re=e=>{const{svgProps:a,...r}=e;return i.jsx(G,{componentName:"CaretRight",icon:i.jsxs("svg",{width:"inherit",height:"inherit",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:[i.jsx("g",{"clip-path":"url(#clip0_4239_16009)",children:i.jsx("path",{d:"M9.25146 6.41254L14.8389 12L9.25146 17.5875",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})}),i.jsx("defs",{children:i.jsx("clipPath",{id:"clip0_4239_16009",children:i.jsx("rect",{width:"15.9553",height:"8.72765",fill:"white",transform:"translate(16.4089 4.02235) rotate(90)"})})})]}),...r})},ne=({userPushSDKInstance:e,page:a,pageSize:r,query:n,chain:t,tag:o})=>e.channel.search(n,{limit:r,page:a,...t?{filter:Number(t)}:{},...o?{tag:o}:{}}),se=({pageSize:e,query:a,chain:r,tag:n})=>{const{userPushSDKInstance:t}=Fe(o=>o.user);return ia({queryKey:[Ie,a,r,n],initialPageParam:1,enabled:!!a,queryFn:({pageParam:o})=>ne({userPushSDKInstance:t,pageSize:e,page:o,query:a,chain:r,tag:n}),getNextPageParam:({itemCount:o},s,l)=>(console.log(o,l,e,e*(l+1)>=o),e*(l+1)>=o?null:l+1)})},le=({initialChain:e,initialCategory:a})=>{const[,r]=Te(),{search:n}=Be(),t=f.useMemo(()=>Object.fromEntries(new URLSearchParams(n).entries()),[n]),o=s=>{const l=Object.entries({...t,...s}).reduce((c,[u,g])=>g?{...c,[u]:g}:c,{});r(l)};return f.useEffect(()=>{const s={};(!t.chain||!t.category)&&(s.chain=t.chain||e,s.category=t.category||a),(t.chain!==e||t.search)&&t.category!==a&&(s.category=a),Object.keys(s).length&&o(s)},[]),{filters:{chain:(t==null?void 0:t.chain)||e,category:(t==null?void 0:t.category)||"",search:(t==null?void 0:t.search)||""},setFilter:o}};var oe=Re,ce=function(){return oe.Date.now()},he=ce,de=/\s/;function ue(e){for(var a=e.length;a--&&de.test(e.charAt(a)););return a}var ge=ue,pe=ge,fe=/^\s+/;function me(e){return e&&e.slice(0,pe(e)+1).replace(fe,"")}var xe=me,ye=$e,ve=qe,je="[object Symbol]";function _e(e){return typeof e=="symbol"||ve(e)&&ye(e)==je}var be=_e,we=xe,V=J,Ce=be,O=NaN,Se=/^[-+]0x[0-9a-f]+$/i,Le=/^0b[01]+$/i,Pe=/^0o[0-7]+$/i,ke=parseInt;function Me(e){if(typeof e=="number")return e;if(Ce(e))return O;if(V(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=V(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=we(e);var r=Le.test(e);return r||Pe.test(e)?ke(e.slice(2),r?2:8):Se.test(e)?O:+e}var Ne=Me,De=J,M=he,z=Ne,Ee="Expected a function",Ae=Math.max,Ve=Math.min;function Oe(e,a,r){var n,t,o,s,l,c,u=0,g=!1,x=!1,j=!0;if(typeof e!="function")throw new TypeError(Ee);a=z(a)||0,De(r)&&(g=!!r.leading,x="maxWait"in r,o=x?Ae(z(r.maxWait)||0,a):o,j="trailing"in r?!!r.trailing:j);function _(h){var m=n,C=t;return n=t=void 0,u=h,s=e.apply(C,m),s}function b(h){return u=h,l=setTimeout(y,a),g?_(h):s}function L(h){var m=h-c,C=h-u,U=a-m;return x?Ve(U,o-C):U}function P(h){var m=h-c,C=h-u;return c===void 0||m>=a||m<0||x&&C>=o}function y(){var h=M();if(P(h))return w(h);l=setTimeout(y,L(h))}function w(h){return l=void 0,j&&n?_(h):(n=t=void 0,s)}function k(){l!==void 0&&clearTimeout(l),u=0,n=c=t=l=void 0}function v(){return l===void 0?s:w(M())}function E(){var h=M(),m=P(h);if(n=arguments,t=this,c=h,m){if(l===void 0)return b(c);if(x)return clearTimeout(l),l=setTimeout(y,a),_(c)}return l===void 0&&(l=setTimeout(y,a)),s}return E.cancel=k,E.flush=v,E}var ze=Oe;let F,p,N,I,T,B,D,R,$,q,K,W;F=Ke(ze),p="All",N=["0x8AAAa9c3a06a4A9FE7C5cCe17d8B5db1E225Eadf"],I=({filters:e,setFilter:a})=>{const[r,n]=f.useState(e.search),[t,o]=f.useState(!0),s=f.useCallback(F(l=>{l!==""&&a({search:l,category:p})},800),[a]);return f.useEffect(()=>{e.search||n("")},[e.search]),f.useEffect(()=>{!t&&s(r)},[r]),f.useEffect(()=>{o(!1)},[]),i.jsxs(d,{display:"flex",gap:"spacing-xs",flexDirection:{initial:"row",ml:"column"},width:"100%",children:[i.jsx(d,{width:"100%",children:i.jsx(We,{icon:i.jsx(ae,{}),onChange:l=>n(l.target.value),placeholder:"Search Web3 domain or 0x123",value:r})}),i.jsx(d,{width:{initial:"300px",ml:"100%"},children:i.jsx(Ue,{options:X(A.allowedNetworks),value:e.chain,onSelect:l=>a({chain:l,category:p})})})]})},T=150,B=({filters:e,setFilter:a})=>{const r=f.useRef(null),{data:n,isLoading:t}=na(),o=t?Array(15).fill(0):(n==null?void 0:n.tags)||[];return i.jsxs(d,{display:"flex",alignItems:"center",css:S`
        flex-shrink: 0;
      `,gap:"spacing-xs",maxWidth:{mm:"346px",ml:"392px"},position:"relative",children:[i.jsx(d,{backgroundColor:"surface-primary",css:S`
          position: absolute;
        `,borderRadius:"radius-round",children:i.jsx(H,{iconOnly:i.jsx(te,{}),circular:!0,variant:"outline",size:"small",onClick:()=>{var s;(s=r==null?void 0:r.current)==null||s.scrollBy({left:-150,behavior:"smooth"})}})}),i.jsxs(d,{display:"flex",overflow:"hidden",gap:"spacing-xs",width:"100%",ref:r,padding:"spacing-none spacing-xxl",children:[!t&&i.jsx(Q,{isActive:e.category===p,onClick:()=>a({category:p}),children:p}),o.map((s,l)=>i.jsx(Ge,{isLoading:t,width:"200px",borderRadius:"radius-round",children:i.jsx(Q,{isActive:s===e.category,onClick:()=>a({category:s,search:"",chain:A.coreContractChain.toString()}),children:s},`${l}`)}))]}),i.jsx(d,{backgroundColor:"surface-primary",css:S`
          position: absolute;
          right: 0;
        `,borderRadius:"radius-round",children:i.jsx(H,{iconOnly:i.jsx(re,{}),circular:!0,variant:"outline",size:"small",onClick:()=>{var s;(s=r==null?void 0:r.current)==null||s.scrollBy({left:T,behavior:"smooth"})}})})]})},D=({channelDetails:e,isLoading:a,onChangeProfileModalVisibility:r,profileModalVisibility:n})=>{const{data:t,refetch:o,isLoading:s}=ca(void 0,{refetchOnWindowFocus:!1,staleTime:1/0,refetchInterval:9e5}),l=()=>{o()},c=t==null?void 0:t.find(g=>g.channel===(e==null?void 0:e.channel)),u=JSON.parse((c==null?void 0:c.user_settings)||"[]")||[];return i.jsx(la,{onChangeProfileModalVisibility:r,profileModalVisibility:n,channelDetails:e,isLoading:a,isSubscribed:!!c,isSubscriptionLoading:s,handleRefetch:l,subscribeButtonVariant:"outline",userSettings:u,width:{initial:"inherit",tb:"auto",lp:"auto",mm:"auto"}})},R=({channelAddress:e,onChangeProfileModalVisibility:a,profileModalVisibility:r})=>{const{data:n,isLoading:t}=Je(e);return i.jsx(D,{channelDetails:n,isLoading:t,onChangeProfileModalVisibility:a,profileModalVisibility:r})},$=({channels:e,hasMoreData:a,isLoading:r,isLoadingNextPage:n,loadMore:t,suggestedChannels:o})=>{const[s,l]=f.useState({isVisible:!1,channel_id:null});return i.jsxs(d,{height:"100%",overflow:"auto",customScrollbar:!0,padding:"spacing-none spacing-xxs",margin:{initial:"spacing-none spacing-sm",ml:"spacing-none spacing-xxs"},css:S`
        .channel-scroll {
          display: grid;
          gap: var(--spacing-md);
          grid-template-columns: repeat(3, minmax(0px, 1fr));

          @media${Y.tablet} {
            grid-template-columns: repeat(2, minmax(0px, 1fr));
          }
          @media${Y.mobileL} {
            grid-template-columns: repeat(1, minmax(0px, 1fr));
          }
        }
      `,children:[i.jsxs(ta,{pageStart:1,loadMore:t,hasMore:a,useWindow:!1,threshold:150,className:"channel-scroll",children:[o.map(c=>i.jsx(R,{channelAddress:c},`${c}`)),e.map((c,u)=>i.jsx(D,{onChangeProfileModalVisibility:g=>l(g),profileModalVisibility:s,channelDetails:c,isLoading:r},`${u}`))]}),n&&i.jsx(d,{justifyContent:"center",display:"flex",padding:"spacing-sm",children:i.jsx(Xe,{size:"medium",variant:"primary"})}),(s==null?void 0:s.isVisible)&&i.jsx(d,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:S`
            z-index: 99999;
          `,children:i.jsx(da,{type:ua.MODAL,showConnectModal:!0,onClose:()=>l({isVisible:!1,channel_id:null}),description:"Unlock your profile to proceed."})})]})},q=e=>He()==="prod"&&(e==null?void 0:e.category)&&(e==null?void 0:e.category)!=p,K=(e,a)=>{if(q(a)){const r=e.map(n=>n.channel);return Object.keys(Z).filter(n=>!r.includes(n)&&!N.includes(n)&&Z[n]===a.category)}return[]},W=()=>{var w,k;const e=X(A.allowedNetworks),{filters:a,setFilter:r}=le({initialChain:e[0].value,initialCategory:p}),n=(w=e.find(v=>v.value===a.chain))==null?void 0:w.label.includes("Ethereum"),{data:t,isLoading:o,fetchNextPage:s,isFetchingNextPage:l,hasNextPage:c}=ea({pageSize:21,order:ee.ChannelListOrderType.DESCENDING,sort:ee.ChannelListSortType.SUBSCRIBER,chain:n?"":a.chain,tag:a.category===p?"":a.category}),{data:u,isLoading:g,fetchNextPage:x,isFetchingNextPage:j,hasNextPage:_}=se({pageSize:21,query:a.search,chain:n?"":a.chain,tag:a.category===p?"":a.category}),b=o||g?Array(9).fill(0):((k=a.search?u:t)==null?void 0:k.pages.flatMap(v=>v.channels).filter(v=>!N.includes(v.channel)))||[],L=K(b,a),P=a.search?!j&&_:!l&&c,y=o||g;return i.jsx(d,{display:"flex",width:"-webkit-fill-available",overflow:"scroll",height:"100%",children:i.jsxs(d,{display:"flex",flexDirection:"column",width:"100%",gap:{initial:"spacing-md",ml:"spacing-lg"},children:[i.jsxs(d,{display:"flex",flexDirection:"column",gap:"spacing-sm",padding:{initial:"spacing-md spacing-md spacing-none spacing-md",ml:"spacing-sm spacing-sm spacing-none spacing-sm"},children:[i.jsx(I,{filters:a,setFilter:r}),i.jsx(B,{filters:a,setFilter:r})]}),!b.length&&!L.length&&!y?i.jsxs(d,{display:"flex",gap:"spacing-xs",alignItems:"center",flexDirection:"column",justifyContent:"center",height:"100%",children:[i.jsx(ae,{size:48,color:"icon-tertiary"}),i.jsx(Qe,{variant:"h5-bold",children:"No channels to display"})]}):i.jsx($,{channels:b,hasMoreData:P,suggestedChannels:L,isLoading:y,isLoadingNextPage:l||j,loadMore:a.search?x:s})]})})},ie=()=>i.jsx(pa,{variant:"verticalStretch",children:i.jsx(W,{})})});export{xa as __tla,ie as default};
