import{e1 as e,el as O,gr as B,fh as Y,fk as ce,h8 as de,h9 as ue,ha as he,hb as ge,hc as xe,d_ as q,e2 as r,ej as J,ek as g,h0 as W,hd as G,he as Q,hf as X,eo as $,dY as ee,hg as se,gk as ne,hh as I,hi as pe,ee as M,hj as fe,hk as Ce,gp as k,g_ as V,gm as _,hl as me,hm as ye,hn as je,ho as Le,hp as be,__tla as we}from"./index-RvXnFo4y.js";import{u as D,__tla as Se}from"./useMutation-lrvmR_cd.js";import{P as ve,__tla as Me}from"./PushLogo-Kjc6mXOf.js";let te,ae,ie,re,le,oe,ke=Promise.all([(()=>{try{return we}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return Me}catch{}})()]).then(async()=>{let E,A,H,z,P,N,R,U,K,F;te=i=>{const{svgProps:a,...t}=i;return e.jsx(O,{componentName:"NotificationMobile",icon:e.jsxs("svg",{width:"inherit",height:"inherit",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:[e.jsx("path",{d:"M13.0551 8.7841L13.3261 9.48341L13.6492 9.35821L13.7632 9.03109L13.0551 8.7841ZM18.949 8.79549L18.2397 9.03943L18.352 9.36576L18.6728 9.49281L18.949 8.79549ZM25.0106 22.1589L24.3706 22.5503L24.3774 22.5609L25.0106 22.1589ZM25.229 22.8955L24.479 22.9004V22.9004L25.229 22.8955ZM25.0203 23.6345L24.382 23.2406L24.3786 23.2462L25.0203 23.6345ZM24.4518 24.1735L24.0932 23.5148H24.0932L24.4518 24.1735ZM23.6735 24.3677L23.678 23.6177H23.6735V24.3677ZM8.3264 24.3677V23.6177L8.32189 23.6177L8.3264 24.3677ZM7.54814 24.1735L7.90676 23.5148H7.90676L7.54814 24.1735ZM6.97966 23.6345L7.62132 23.2462L7.6179 23.2406L6.97966 23.6345ZM6.7709 22.8955L7.52089 22.9004L6.7709 22.8955ZM6.98934 22.1589L7.62261 22.561L7.6292 22.5502L6.98934 22.1589ZM8.24889 15.5693H8.99889L8.99889 15.5683L8.24889 15.5693ZM8.83631 12.7621L8.1491 12.4617L8.1491 12.4617L8.83631 12.7621ZM10.5163 10.3821L11.0317 10.927L10.5163 10.3821ZM13.0323 8.79298L13.3054 9.49146L13.3055 9.49145L13.0323 8.79298ZM13.7632 9.03109C14.062 8.17457 14.9339 7.52087 16 7.52087V6.02087C14.3207 6.02087 12.8638 7.05503 12.3469 8.53711L13.7632 9.03109ZM16 7.52087C17.0697 7.52087 17.9437 8.17883 18.2397 9.03943L19.6582 8.55155C19.1458 7.06174 17.6848 6.02087 16 6.02087V7.52087ZM24.501 15.6518C24.501 12.2347 22.2992 9.31545 19.2251 8.09817L18.6728 9.49281C21.2272 10.5043 23.001 12.9044 23.001 15.6518H24.501ZM24.501 16.3025V15.6518H23.001V16.3025H24.501ZM25.6504 21.7677C25.1636 20.9715 24.501 19.3348 24.501 16.3025H23.001C23.001 19.5574 23.7143 21.4767 24.3707 22.5502L25.6504 21.7677ZM25.979 22.8905C25.9764 22.488 25.8592 22.0963 25.6438 21.757L24.3774 22.5609C24.4445 22.6666 24.4783 22.7838 24.479 22.9004L25.979 22.8905ZM25.6585 24.0284C25.8697 23.6863 25.9817 23.2931 25.979 22.8905L24.479 22.9004C24.4798 23.017 24.4476 23.1344 24.382 23.2406L25.6585 24.0284ZM24.8104 24.8322C25.1602 24.6418 25.4555 24.3639 25.6619 24.0228L24.3786 23.2462C24.3137 23.3534 24.2167 23.4475 24.0932 23.5148L24.8104 24.8322ZM23.669 25.1177C24.0671 25.1201 24.4608 25.0225 24.8104 24.8322L24.0932 23.5148C23.9695 23.5821 23.826 23.6186 23.678 23.6177L23.669 25.1177ZM8.3264 25.1177H23.6735V23.6177H8.3264V25.1177ZM7.18953 24.8322C7.5391 25.0225 7.93285 25.1201 8.33092 25.1177L8.32189 23.6177C8.1739 23.6186 8.03047 23.5821 7.90676 23.5148L7.18953 24.8322ZM6.33802 24.0228C6.54443 24.3639 6.83974 24.6418 7.18953 24.8322L7.90676 23.5148C7.78326 23.4475 7.68619 23.3534 7.62129 23.2462L6.33802 24.0228ZM6.02092 22.8905C6.01828 23.2931 6.13027 23.6863 6.34141 24.0284L7.6179 23.2406C7.55232 23.1344 7.52012 23.017 7.52089 22.9004L6.02092 22.8905ZM6.35617 21.757C6.1407 22.0963 6.02356 22.488 6.02092 22.8905L7.52089 22.9004C7.52165 22.7838 7.5554 22.6666 7.62252 22.5609L6.35617 21.757ZM7.49889 16.3025C7.49889 19.3348 6.83633 20.9715 6.34949 21.7677L7.6292 22.5502C8.28564 21.4767 8.99889 19.5574 8.99889 16.3025H7.49889ZM7.49889 15.5693V16.3025H8.99889V15.5693H7.49889ZM8.1491 12.4617C7.71884 13.446 7.49748 14.5025 7.49889 15.5703L8.99889 15.5683C8.99776 14.7098 9.17563 13.8583 9.52353 13.0624L8.1491 12.4617ZM10.0009 9.83727C9.20931 10.5861 8.5793 11.4775 8.1491 12.4617L9.52353 13.0624C9.87148 12.2664 10.3832 11.5404 11.0317 10.927L10.0009 9.83727ZM12.7591 8.09451C11.73 8.497 10.7924 9.08857 10.0009 9.83727L11.0317 10.927C11.6802 10.3135 12.4525 9.82505 13.3054 9.49146L12.7591 8.09451ZM12.784 8.08478C12.7757 8.08802 12.7674 8.09126 12.759 8.09451L13.3055 9.49145C13.3123 9.48876 13.3192 9.48608 13.3261 9.48341L12.784 8.08478Z",fill:"currentColor"}),e.jsx("path",{d:"M19.356 24.3901C19.356 26.2436 17.8535 27.7462 16 27.7462C14.1465 27.7462 12.644 26.2436 12.644 24.3901",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"}),e.jsx("path",{d:"M21.873 4.25385C23.4932 5.28763 24.8073 6.73605 25.679 8.44889",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M6.32111 8.44889C7.1928 6.73605 8.50689 5.28763 10.1271 4.25385",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})]}),...t})},ie=i=>{const{svgProps:a,...t}=i;return e.jsx(O,{componentName:"TickDecoratedCircleFilled",icon:e.jsx("svg",{width:"inherit",height:"inherit",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:e.jsx("path",{id:"Vector",d:"M14.9929 6.2C14.7214 5.92143 14.4429 5.62857 14.3357 5.37857C14.2286 5.12857 14.2357 4.75714 14.2286 4.37857C14.2214 3.68571 14.2071 2.89286 13.6571 2.34286C13.1071 1.79286 12.3143 1.77857 11.6214 1.77143C11.2429 1.76429 10.8571 1.75714 10.6214 1.66429C10.3857 1.57143 10.0786 1.27857 9.8 1.00714C9.30714 0.535714 8.74286 0 8 0C7.25714 0 6.69286 0.535714 6.2 1.00714C5.92143 1.27857 5.62857 1.55714 5.37857 1.66429C5.12857 1.77143 4.75714 1.76429 4.37857 1.77143C3.68571 1.77857 2.89286 1.79286 2.34286 2.34286C1.79286 2.89286 1.77857 3.68571 1.77143 4.37857C1.76429 4.75714 1.75714 5.14286 1.66429 5.37857C1.57143 5.61429 1.27857 5.92143 1.00714 6.2C0.535714 6.69286 0 7.25714 0 8C0 8.74286 0.535714 9.30714 1.00714 9.8C1.27857 10.0786 1.55714 10.3714 1.66429 10.6214C1.77143 10.8714 1.76429 11.2429 1.77143 11.6214C1.77857 12.3143 1.79286 13.1071 2.34286 13.6571C2.89286 14.2071 3.68571 14.2214 4.37857 14.2286C4.75714 14.2357 5.14286 14.2429 5.37857 14.3357C5.61429 14.4286 5.92143 14.7214 6.2 14.9929C6.69286 15.4643 7.25714 16 8 16C8.74286 16 9.30714 15.4643 9.8 14.9929C10.0786 14.7214 10.3714 14.4429 10.6214 14.3357C10.8714 14.2286 11.2429 14.2357 11.6214 14.2286C12.3143 14.2214 13.1071 14.2071 13.6571 13.6571C14.2071 13.1071 14.2214 12.3143 14.2286 11.6214C14.2357 11.2429 14.2429 10.8571 14.3357 10.6214C14.4286 10.3857 14.7214 10.0786 14.9929 9.8C15.4643 9.30714 16 8.74286 16 8C16 7.25714 15.4643 6.69286 14.9929 6.2ZM11.5357 6.7L7.35 10.7C7.24179 10.8018 7.09856 10.8581 6.95 10.8571C6.80362 10.8577 6.66276 10.8014 6.55714 10.7L4.46429 8.7C4.40624 8.64936 4.35903 8.5875 4.3255 8.51814C4.29197 8.44879 4.2728 8.37337 4.26916 8.29642C4.26552 8.21947 4.27748 8.14258 4.30431 8.07037C4.33115 7.99816 4.3723 7.93212 4.42531 7.87622C4.47832 7.82032 4.54208 7.77572 4.61277 7.74509C4.68345 7.71446 4.7596 7.69844 4.83663 7.69799C4.91367 7.69755 4.99 7.71268 5.06103 7.74249C5.13207 7.77229 5.19635 7.81615 5.25 7.87143L6.95 9.49286L10.75 5.87143C10.8611 5.77449 11.0054 5.72426 11.1527 5.73123C11.3 5.73819 11.4389 5.80183 11.5403 5.90882C11.6418 6.01581 11.6979 6.15789 11.6971 6.30533C11.6962 6.45278 11.6384 6.59419 11.5357 6.7Z",fill:"currentColor"})}),...t})},E=i=>i,A=(i,a)=>i.notification.subscriptions({channel:a}).then(E),H=async({signer:i,channelAddress:a,userAddress:t,settings:u,env:h})=>await B.channels.subscribeV2({signer:i,channelAddress:a,userAddress:t,settings:u,env:h}),z=async({signer:i,channelAddress:a,userAddress:t,env:u})=>await B.channels.unsubscribe({signer:i,channelAddress:a,userAddress:t,env:u}),P=async({userPushSDKInstance:i,channelAddress:a,settings:t})=>await i.notification.subscribe(a,{settings:t}),oe=(i,a)=>{const{userPushSDKInstance:t}=Y(u=>u.user);return ce({queryKey:[i?de:ue,t==null?void 0:t.account,i||null],queryFn:()=>A(t,i),...a})},N=()=>D({mutationKey:[he],mutationFn:H}),R=()=>D({mutationKey:[ge],mutationFn:z}),U=()=>D({mutationKey:[xe],mutationFn:P}),K=({optInHandler:i,channelSettings:a,loading:t,onClose:u})=>{const[h,d]=q.useState([...a]),x=(n,c)=>{const s=[...h];s[n].default=c,d(s)},p=n=>{const c=[...h];if(c[n].type===1){const s=c[n];s.default=!s.default}else{const s=c[n];s.enabled=!s.enabled}d(c)},j=async()=>{await i(h)};return e.jsx(r,{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"spacing-xs",border:"border-sm solid stroke-secondary",backgroundColor:"surface-primary",borderRadius:"radius-sm",children:e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-xxs",alignItems:"center",alignSelf:"stretch",children:[e.jsx(r,{display:"flex",flexDirection:"column",width:"-webkit-fill-available",maxHeight:"30vh",padding:"spacing-none spacing-xs",overflow:"scroll",customScrollbar:!0,css:J`
            overflow-x: none;
          `,children:h.map((n,c)=>e.jsxs(r,{children:[e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-xxs",padding:"spacing-xs spacing-none",alignSelf:"stretch",alignItems:"flex-start",children:[e.jsxs(r,{display:"flex",flexDirection:"row",justifyContent:"space-between",alignSelf:"stretch",children:[e.jsx(g,{variant:"h6-bold",color:"text-primary",textTransform:"capitalize",children:n.description}),e.jsx(W,{checked:n.type===1?n.default:n.enabled,onCheckedChange:()=>p(c)})]}),n.type===2&&n.enabled===!0&&e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-xxs",alignItems:"flex-start",alignSelf:"stretch",children:[e.jsx(g,{variant:"h6-bold",color:"text-primary",textTransform:"capitalize",children:n.default}),e.jsx(G,{val:n.default,max:n.upperLimit,min:n.lowerLimit,step:n.ticker||1,defaultVal:n.default,onChange:({x:s})=>x(c,s)})]}),n.type===3&&n.enabled===!0&&e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-xxs",alignItems:"flex-start",alignSelf:"stretch",children:[e.jsxs(g,{variant:"h6-bold",color:"text-primary",textTransform:"capitalize",children:[n.default.lower," - ",n.default.upper]}),e.jsx(Q,{startVal:n.default.lower,endVal:n.default.upper,max:n.upperLimit,min:n.lowerLimit,step:n.ticker||1,defaultStartVal:n.default.lower,defaultEndVal:n.default.upper,onChange:({startVal:s,endVal:l})=>x(c,{lower:s,upper:l})})]})]}),e.jsx(X,{})]},c))}),e.jsxs(r,{display:"flex",gap:"spacing-xxs",alignSelf:"stretch",alignItems:"center",justifyContent:"flex-end",flexDirection:"column",padding:"spacing-none spacing-xs",children:[e.jsx(g,{color:"text-tertiary",variant:"bes-regular",children:"You will receive all important updates from this channel."}),e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-md",alignItems:"center",width:"100%",children:[e.jsx($,{size:"small",variant:"primary",onClick:j,block:!0,loading:t,children:t?"Subscribing":"Subscribe"}),e.jsx(r,{width:"100%",cursor:"pointer",onClick:u,children:e.jsx(g,{textAlign:"center",variant:"bs-semibold",children:"Cancel"})})]})]})]})})},ae=i=>{const{children:a,channelDetails:t,onSuccess:u}=i,{account:h,provider:d,wallet:x,chainId:p}=ee(),{connectWallet:j}=se(),n=t&&(t!=null&&t.channel_settings)?JSON.parse(t==null?void 0:t.channel_settings):null,{mutate:c,isPending:s}=N(),l=ne(),o=async m=>{var b;const y=((b=x==null?void 0:x.accounts)==null?void 0:b.length)>0,Z=y?null:await j(),w=y?h:Z.accounts[0].address,C=y?d:new pe(Z.provider,"any"),S=p===M.coreContractChain?t.channel:t.alias_address,L=await(C==null?void 0:C.getSigner(w)),f=m?fe(Ce({settings:m})):null;c({signer:L,channelAddress:k(S,p),userAddress:k(w,p),settings:f,env:M.pushNodesEnv},{onSuccess:v=>{console.log("Response on the channels  apge",v),v.status=="204"?(u(),l.showMessageToast({toastTitle:"Success",toastMessage:"Successfully opted into channel !",toastType:"SUCCESS",getToastIcon:T=>e.jsx(V,{size:T,color:"green"})})):(console.log("Error in the response >>",v),l.showMessageToast({toastTitle:"Error",toastMessage:"There was an error opting into channel",toastType:"ERROR",getToastIcon:T=>e.jsx(_,{size:T,color:"red"})}))},onError:v=>{console.log("Error in the schnnale",v)}})};return e.jsx(e.Fragment,{children:n&&n.length?e.jsx(I,{overlay:m=>e.jsx(K,{optInHandler:o,channelSettings:n,loading:s,onClose:()=>m(!1)}),children:a}):e.jsx(r,{onClick:()=>{o()},children:a})})},F=({userSetting:i,updateNotificationSettings:a,updatingNotificationSettings:t,unsubscribing:u,unsubscribe:h})=>{const[d,x]=q.useState([...i]),p=(s,l)=>{const o=[...d];o[s].user=l,x(o)},j=s=>{const l=[...d];if(l[s].type===1){const o=l[s];o.user=!o.user}else if(l[s].type===2){const o=l[s];o.enabled=!o.enabled}else{const o=l[s];o.enabled=!o.enabled}x(l)},n=()=>{a(d)},c=async()=>{h()};return e.jsx(r,{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"spacing-xs",border:"border-sm solid stroke-secondary",backgroundColor:"surface-primary",borderRadius:"radius-sm",children:e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-xxs",alignItems:"center",children:[e.jsx(r,{display:"flex",flexDirection:"column",width:"-webkit-fill-available",maxHeight:"30vh",padding:"spacing-none spacing-xs",overflow:"scroll",customScrollbar:!0,css:J`
            overflow-x: none;
          `,children:d.map((s,l)=>e.jsxs(r,{children:[e.jsxs(r,{display:"flex",flexDirection:"column",padding:"spacing-xs spacing-none",gap:"spacing-xxs",alignSelf:"stretch",alignItems:"flex-start",children:[e.jsxs(r,{display:"flex",flexDirection:"row",justifyContent:"space-between",alignSelf:"stretch",children:[e.jsx(g,{variant:"h6-bold",color:"text-primary",textTransform:"capitalize",children:s.description}),e.jsx(W,{checked:s.type===1?s.user:s.enabled,onCheckedChange:()=>j(l)})]}),s.type===2&&s.enabled===!0&&e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-xxs",alignItems:"flex-start",alignSelf:"stretch",children:[e.jsx(g,{variant:"h6-bold",color:"text-primary",textTransform:"capitalize",children:s.user||s.default}),e.jsx(G,{val:s.user,max:s.upperLimit,min:s.lowerLimit,step:s.ticker||1,defaultVal:s.default,onChange:({x:o})=>p(l,o)})]}),s.type===3&&s.enabled===!0&&e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-xxs",alignItems:"flex-start",alignSelf:"stretch",children:[e.jsxs(g,{variant:"h6-bold",color:"text-primary",textTransform:"capitalize",children:[s.user.lower||s.default.lower," - ",s.user.upper||s.default.upper]}),e.jsx(Q,{startVal:s.user.lower||s.default.lower,endVal:s.user.upper||s.default.upper,max:s.upperLimit,min:s.lowerLimit,step:s.ticker||1,defaultStartVal:s.default.lower,defaultEndVal:s.default.upper,onChange:({startVal:o,endVal:m})=>p(l,{lower:o,upper:m})})]})]}),e.jsx(X,{})]},l))}),e.jsxs(r,{display:"flex",gap:"spacing-xxs",alignSelf:"stretch",alignItems:"center",justifyContent:"flex-end",flexDirection:"column",padding:"spacing-none spacing-xs",children:[e.jsx(g,{color:"text-tertiary",variant:"bes-regular",children:"You will receive all important updates from this channel."}),e.jsxs(r,{display:"flex",flexDirection:"column",gap:"spacing-md",alignItems:"center",width:"100%",children:[e.jsx($,{size:"small",variant:"primary",onClick:n,block:!0,loading:t,children:t?"Updating":"Update Preferences"}),e.jsx(r,{width:"100%",cursor:"pointer",onClick:c,children:e.jsx(g,{textAlign:"center",variant:"bs-semibold",children:u?"Unsubscribing":"Unsubscribe"})})]})]})]})})},re=({children:i,channelDetail:a,onSuccess:t,userSetting:u})=>{const{account:h,chainId:d,provider:x,wallet:p}=ee(),{handleConnectWalletAndEnableProfile:j}=se(),{userPushSDKInstance:n}=Y(C=>C.user),c=a&&(a!=null&&a.channel_settings)?JSON.parse(a==null?void 0:a.channel_settings):null,{mutate:s,isPending:l}=U(),{mutate:o,isPending:m}=R(),y=ne(),Z=async C=>{const S=d===M.coreContractChain?a.channel:a.alias_address,L=n.signer?n:await j({wallet:p})??void 0;s({userPushSDKInstance:L,channelAddress:k(S,d),settings:be({settings:C})},{onSuccess:f=>{f.status===204?(t(),y.showMessageToast({toastTitle:"Success",toastMessage:"Successfully saved the user settings!",toastType:"SUCCESS",getToastIcon:b=>e.jsx(V,{size:b,color:"green"})})):(console.log("Error in Saving notification settings",f),y.showMessageToast({toastTitle:"Error",toastMessage:"There was an error in saving the settings",toastType:"ERROR",getToastIcon:b=>e.jsx(_,{size:b,color:"red"})}))},onError:f=>{console.log("Error in saving notification settings",f)}})},w=async()=>{const C=d===M.coreContractChain?a.channel:a.alias_address,S=await x.getSigner(h);o({signer:S,channelAddress:k(C,d),userAddress:k(h,d),env:M.pushNodesEnv},{onSuccess:L=>{t(),L.status==="success"?y.showMessageToast({toastTitle:"Success",toastMessage:"Successfully opted out of channel !",toastType:"SUCCESS",getToastIcon:f=>e.jsx(V,{size:f,color:"green"})}):y.showMessageToast({toastTitle:"Error",toastMessage:"There was an error opting out of channel",toastType:"ERROR",getToastIcon:f=>e.jsx(_,{size:f,color:"red"})})},onError:L=>{console.log("Error in the unsubcribe channel",L)}})};return e.jsx(e.Fragment,{children:u&&c?e.jsx(I,{overlay:e.jsx(F,{userSetting:u??me({channelSetting:c}),updateNotificationSettings:Z,updatingNotificationSettings:l,unsubscribing:m,unsubscribe:w}),children:i}):e.jsx(I,{overlay:e.jsx(ye,{children:e.jsx(je,{label:"Unsubscribe",icon:e.jsx(Le,{}),onClick:w})}),children:i})})},le=()=>e.jsxs(r,{display:"flex",gap:"spacing-xxs",padding:"spacing-xxxs",children:[e.jsxs(g,{color:"text-primary-inverse",variant:"bs-semibold",children:["Verified By:"," "]}),e.jsxs(r,{display:"flex",gap:"spacing-xxs",alignItems:"center",children:[e.jsx(ve,{width:16,height:16}),e.jsx(g,{color:"text-primary-inverse",children:"Push Admin"})]})]})});export{te as N,ae as S,ie as T,re as U,le as V,ke as __tla,oe as u};
