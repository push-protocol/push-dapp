import{d_ as t,ei as H,eO as Ie,hy as Te,hz as $e,hA as Be,hB as Re,hC as Q,ev as We,dX as p,d$ as u,go as qe,gp as Ke,gJ as Y,ed as O,e3 as k,em as Z,hD as F,ej as Ue,gz as Ge,fK as ee,gy as Je,hE as Xe,ex as He,gx as ae,hF as Qe,hG as Ye,dV as Ze,gd as ie,e2 as ea,__tla as aa}from"./index-R5rj5rOD.js";import{S as te,__tla as ia}from"./Search-DXwjqNVV.js";import{u as ta,__tla as ra}from"./useGetChannelsList-BUtkRDd_.js";import{u as sa,I as na,__tla as la}from"./InfiniteScroll-a3YV7pLF.js";import{u as oa,__tla as ca}from"./useGetChannelCategories-CWMT8cFu.js";import{C as da,__tla as ha}from"./ChannelDetailsCard-Ct1RtHRS.js";import{u as ua,__tla as ga}from"./VerifiedChannelTooltipContent-BPcxaIRi.js";import{U as pa,b as fa,__tla as ma}from"./UnlockProfileWrapper-BuZOo3Cb.js";import{C as xa,__tla as ya}from"./ContentLayout-Dl8rAx07.js";import{__tla as ba}from"./PushLogo-DHfkYa1z.js";let re,ja=Promise.all([(()=>{try{return aa}catch{}})(),(()=>{try{return ia}catch{}})(),(()=>{try{return ra}catch{}})(),(()=>{try{return la}catch{}})(),(()=>{try{return ca}catch{}})(),(()=>{try{return ha}catch{}})(),(()=>{try{return ga}catch{}})(),(()=>{try{return ma}catch{}})(),(()=>{try{return ya}catch{}})(),(()=>{try{return ba}catch{}})()]).then(async()=>{const se=e=>{const{svgProps:i,...n}=e;return t.jsx(H,{componentName:"CaretLeft",icon:t.jsx("svg",{width:"inherit",height:"inherit",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i,children:t.jsx("path",{d:"M14.8389 17.5875L9.25137 12L14.8389 6.41248",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})}),...n})},ne=e=>{const{svgProps:i,...n}=e;return t.jsx(H,{componentName:"CaretRight",icon:t.jsxs("svg",{width:"inherit",height:"inherit",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i,children:[t.jsx("g",{"clip-path":"url(#clip0_4239_16009)",children:t.jsx("path",{d:"M9.25146 6.41254L14.8389 12L9.25146 17.5875",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})}),t.jsx("defs",{children:t.jsx("clipPath",{id:"clip0_4239_16009",children:t.jsx("rect",{width:"15.9553",height:"8.72765",fill:"white",transform:"translate(16.4089 4.02235) rotate(90)"})})})]}),...n})},le=({userPushSDKInstance:e,page:i,pageSize:n,query:s,chain:a,tag:o,subscribed:l})=>e.channel.search(s,{limit:n,page:i,...l?{user_subscribed:l}:{},...a?{filter:Number(a)}:{},...o?{tag:o}:{}}),oe=({pageSize:e,query:i,chain:n,tag:s,subscribed:a})=>{const{userPushSDKInstance:o}=Ie(l=>l.user);return sa({queryKey:[Te,o==null?void 0:o.account,i,n,s,a],initialPageParam:1,enabled:!!i,queryFn:({pageParam:l})=>le({userPushSDKInstance:o,pageSize:e,page:l,query:i,chain:n,tag:s,subscribed:a}),getNextPageParam:({},l,r)=>l[r-1].length<e?null:r+1})};var ce=$e,de=function(){return ce.Date.now()},he=de,ue=/\s/;function ge(e){for(var i=e.length;i--&&ue.test(e.charAt(i)););return i}var pe=ge,fe=pe,me=/^\s+/;function xe(e){return e&&e.slice(0,fe(e)+1).replace(me,"")}var ye=xe,be=Be,je=Re,ve="[object Symbol]";function _e(e){return typeof e=="symbol"||je(e)&&be(e)==ve}var we=_e,Ce=ye,z=Q,Se=we,I=NaN,Pe=/^[-+]0x[0-9a-f]+$/i,ke=/^0b[01]+$/i,Le=/^0o[0-7]+$/i,Me=parseInt;function Ne(e){if(typeof e=="number")return e;if(Se(e))return I;if(z(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=z(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Ce(e);var n=ke.test(e);return n||Le.test(e)?Me(e.slice(2),n?2:8):Pe.test(e)?I:+e}var De=Ne,Ae=Q,A=he,T=De,Ee="Expected a function",Ve=Math.max,Oe=Math.min;function Fe(e,i,n){var s,a,o,l,r,c,h=0,g=!1,j=!1,_=!0;if(typeof e!="function")throw new TypeError(Ee);i=T(i)||0,Ae(n)&&(g=!!n.leading,j="maxWait"in n,o=j?Ve(T(n.maxWait)||0,i):o,_="trailing"in n?!!n.trailing:_);function w(d){var f=s,b=a;return s=a=void 0,h=d,l=e.apply(b,f),l}function C(d){return h=d,r=setTimeout(v,i),g?w(d):l}function L(d){var f=d-c,b=d-h,x=i-f;return j?Oe(x,o-b):x}function M(d){var f=d-c,b=d-h;return c===void 0||f>=i||f<0||j&&b>=o}function v(){var d=A();if(M(d))return N(d);r=setTimeout(v,L(d))}function N(d){return r=void 0,_&&s?w(d):(s=a=void 0,l)}function S(){r!==void 0&&clearTimeout(r),h=0,s=c=a=r=void 0}function D(){return r===void 0?l:N(A())}function P(){var d=A(),f=M(d);if(s=arguments,a=this,c=d,f){if(r===void 0)return C(c);if(j)return clearTimeout(r),r=setTimeout(v,i),w(c)}return r===void 0&&(r=setTimeout(v,i)),l}return P.cancel=S,P.flush=D,P}var ze=Fe;let $,m,y,E,B,R,W,V,q,K,U,G,J,X;$=We(ze),m="All",y="Subscribed",E=["0x8AAAa9c3a06a4A9FE7C5cCe17d8B5db1E225Eadf"],B=({filters:e,setFilter:i})=>{const[n,s]=p.useState(e.search),[a,o]=p.useState(!0),l=p.useCallback($(r=>{r!==""&&i({search:r,category:e.category===y?e.category:m})},800),[i]);return p.useEffect(()=>{e.search||s("")},[e.search]),p.useEffect(()=>{!a&&l(n)},[n]),p.useEffect(()=>{o(!1)},[]),t.jsxs(u,{display:"flex",gap:"spacing-xs",flexDirection:{initial:"row",ml:"column"},width:"100%",children:[t.jsx(u,{width:"100%",children:t.jsx(qe,{icon:t.jsx(te,{}),onChange:r=>s(r.target.value),placeholder:"Search Web3 domain or 0x123",value:n})}),t.jsx(u,{width:{initial:"300px",ml:"100%"},children:t.jsx(Ke,{options:Y(O.allowedNetworks),value:e.chain,onSelect:r=>i({chain:r,category:e.category===y?e.category:m})})})]})},R=150,W=({filters:e,setFilter:i,walletAddress:n})=>{const s=p.useRef(null),{data:a,isLoading:o}=oa(),l=o?Array(15).fill(0):(a==null?void 0:a.tags)||[];return t.jsxs(u,{display:"flex",alignItems:"center",css:k`
        flex-shrink: 0;
      `,gap:"spacing-xs",maxWidth:{mm:"346px",ml:"392px"},position:"relative",children:[t.jsx(u,{backgroundColor:"surface-primary",css:k`
          position: absolute;
        `,borderRadius:"radius-round",children:t.jsx(Z,{iconOnly:t.jsx(se,{}),circular:!0,variant:"outline",size:"small",onClick:()=>{var r;(r=s==null?void 0:s.current)==null||r.scrollBy({left:-150,behavior:"smooth"})}})}),t.jsxs(u,{display:"flex",overflow:"hidden",gap:"spacing-xs",width:"100%",ref:s,padding:"spacing-none spacing-xxl",children:[!o&&t.jsxs(t.Fragment,{children:[t.jsx(F,{isActive:e.category===m,onClick:()=>i({category:m}),children:m}),n&&t.jsx(F,{isActive:e.category===y,onClick:()=>i({category:y}),children:y})]}),l.map((r,c)=>t.jsx(Ue,{isLoading:o,width:"200px",borderRadius:"radius-round",children:t.jsx(F,{isActive:r===e.category,onClick:()=>i({category:r,search:"",chain:O.coreContractChain.toString()}),children:r},`${c}`)}))]}),t.jsx(u,{backgroundColor:"surface-primary",css:k`
          position: absolute;
          right: 0;
        `,borderRadius:"radius-round",children:t.jsx(Z,{iconOnly:t.jsx(ne,{}),circular:!0,variant:"outline",size:"small",onClick:()=>{var r;(r=s==null?void 0:s.current)==null||r.scrollBy({left:R,behavior:"smooth"})}})})]})},V=({channelDetails:e,isLoading:i,onChangeProfileModalVisibility:n,profileModalVisibility:s})=>{const{data:a,refetch:o,isLoading:l}=ua(void 0,{refetchOnWindowFocus:!1,staleTime:1/0,refetchInterval:9e5}),r=()=>{o()},c=a==null?void 0:a.find(g=>g.channel===(e==null?void 0:e.channel)),h=JSON.parse((c==null?void 0:c.user_settings)||"[]")||[];return t.jsx(da,{onChangeProfileModalVisibility:n,profileModalVisibility:s,channelDetails:e,isLoading:i,isSubscribed:!!c,isSubscriptionLoading:l,handleRefetch:r,subscribeButtonVariant:"outline",userSettings:h,width:{initial:"inherit",tb:"auto",lp:"auto",mm:"auto"}})},q=({channelAddress:e,onChangeProfileModalVisibility:i,profileModalVisibility:n})=>{const{data:s,isLoading:a}=Ge(e);return t.jsx(V,{channelDetails:s,isLoading:a,onChangeProfileModalVisibility:i,profileModalVisibility:n})},K=({channels:e,hasMoreData:i,isLoading:n,isLoadingNextPage:s,loadMore:a,suggestedChannels:o})=>{const[l,r]=p.useState({isVisible:!1,channel_id:null});return t.jsxs(u,{height:"100%",overflow:"auto",customScrollbar:!0,padding:"spacing-none spacing-xxs",margin:{initial:"spacing-none spacing-sm",ml:"spacing-none spacing-xxs"},css:k`
        .channel-scroll {
          display: grid;
          gap: var(--spacing-md);
          grid-template-columns: repeat(3, minmax(0px, 1fr));

          @media${ee.tablet} {
            grid-template-columns: repeat(2, minmax(0px, 1fr));
          }
          @media${ee.mobileL} {
            grid-template-columns: repeat(1, minmax(0px, 1fr));
          }
        }
      `,children:[t.jsxs(na,{pageStart:1,loadMore:a,hasMore:i,useWindow:!1,threshold:150,className:"channel-scroll",children:[o.map(c=>t.jsx(q,{channelAddress:c},`${c}`)),e.map((c,h)=>t.jsx(V,{onChangeProfileModalVisibility:g=>r(g),profileModalVisibility:l,channelDetails:c,isLoading:n},`${h}`))]}),s&&t.jsx(u,{justifyContent:"center",display:"flex",padding:"spacing-sm",children:t.jsx(Je,{size:"medium",variant:"primary"})}),(l==null?void 0:l.isVisible)&&t.jsx(u,{display:"flex",justifyContent:"center",width:"-webkit-fill-available",alignItems:"center",css:k`
            z-index: 99999;
          `,children:t.jsx(pa,{type:fa.MODAL,showConnectModal:!0,onClose:()=>r({isVisible:!1,channel_id:null}),description:"Unlock your profile to proceed."})})]})},U=({initialChain:e,initialCategory:i})=>{const[,n]=Xe(),{search:s}=He(),a=p.useMemo(()=>Object.fromEntries(new URLSearchParams(s).entries()),[s]),o=l=>{const r=Object.entries({...a,...l}).reduce((c,[h,g])=>g?{...c,[h]:g}:c,{});n(r)};return p.useEffect(()=>{const l={};(!a.chain||!a.category)&&(l.chain=a.chain||e,l.category=a.category||i),(a.chain!==e||a.search)&&a.category!==i&&(l.category=i),Object.keys(l).length&&o(l)},[]),{filters:{chain:(a==null?void 0:a.chain)||e,category:(a==null?void 0:a.category)||"",search:(a==null?void 0:a.search)||""},setFilter:o}},G=e=>Qe()==="prod"&&(e==null?void 0:e.category)&&(e==null?void 0:e.category)!=m,J=(e,i)=>{if(G(i)){const n=e.map(s=>s.channel);return Object.keys(ae).filter(s=>!n.includes(s)&&!E.includes(s)&&ae[s]===i.category)}return[]},X=()=>{var f,b;const{readOnlyWallet:e}=p.useContext(Ye),{account:i}=Ze(),n=i!==e?i:null,s=Y(O.allowedNetworks),{filters:a,setFilter:o}=U({initialChain:s[0].value,initialCategory:m}),l=(f=s.find(x=>x.value===a.chain))==null?void 0:f.label.includes("Ethereum"),r=a.category===m||a.category===y?"":a.category,c=a.category===y?`eip155:${n}`:"",{data:h,isLoading:g,fetchNextPage:j,isFetchingNextPage:_,hasNextPage:w}=ta({pageSize:21,order:ie.ChannelListOrderType.DESCENDING,sort:ie.ChannelListSortType.SUBSCRIBER,chain:l?"":a.chain,tag:r,subscribed:c}),{data:C,isLoading:L,fetchNextPage:M,isFetchingNextPage:v,hasNextPage:N}=oe({pageSize:21,query:a.search,chain:l?"":a.chain,tag:r,subscribed:c});p.useEffect(()=>{i===e&&a.category===y&&o({category:m})},[i,a]);const S=g||L?Array(9).fill(0):((b=a.search?C==null?void 0:C.pages.flatMap(x=>x):h==null?void 0:h.pages.flatMap(x=>x.channels))==null?void 0:b.filter(x=>!E.includes(x.channel)))||[],D=J(S,a),P=a.search?!v&&N:!_&&w,d=g||L;return t.jsx(u,{display:"flex",width:"-webkit-fill-available",overflow:"scroll",height:"100%",children:t.jsxs(u,{display:"flex",flexDirection:"column",width:"100%",gap:{initial:"spacing-md",ml:"spacing-lg"},children:[t.jsxs(u,{display:"flex",flexDirection:"column",gap:"spacing-sm",padding:{initial:"spacing-md spacing-md spacing-none spacing-md",ml:"spacing-sm spacing-sm spacing-none spacing-sm"},children:[t.jsx(B,{filters:a,setFilter:o}),t.jsx(W,{filters:a,setFilter:o,walletAddress:n})]}),!S.length&&!D.length&&!d?t.jsxs(u,{display:"flex",gap:"spacing-xs",alignItems:"center",flexDirection:"column",justifyContent:"center",height:"100%",children:[t.jsx(te,{size:48,color:"icon-tertiary"}),t.jsx(ea,{variant:"h5-bold",children:"No channels to display"})]}):t.jsx(K,{channels:S,hasMoreData:P,suggestedChannels:D,isLoading:d,isLoadingNextPage:_||v,loadMore:a.search?M:j})]})})},re=()=>t.jsx(xa,{variant:"verticalStretch",children:t.jsx(X,{})})});export{ja as __tla,re as default};
